{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/@3d-dice/dice-box/dist/dice-box.es.js","sources":["file:///home/irakli/Projects/RollKeeper/node_modules/%403d-dice/dice-box/src/components/world/canvas.js","file:///home/irakli/Projects/RollKeeper/node_modules/%403d-dice/dice-box/src/helpers/index.js","file:///home/irakli/Projects/RollKeeper/node_modules/%403d-dice/dice-box/src/WorldFacade.js"],"sourcesContent":["import './canvas.css'\n\nfunction createCanvas(options) {\n  const { selector, id } = options\n\n  let container = document.body\n  let canvas = document.createElement('canvas')\n  canvas.id = id\n  canvas.classList.add('dice-box-canvas')\n\n  if(selector) {\n    if (typeof selector !== 'string') {\n      throw(new Error(\"You must provide a DOM selector as the first argument in order to render the Dice Box\"))\n    }\n\n    container = document.querySelector(selector)\n\n    if(!container?.nodeName){\n      throw(new Error(`DiceBox target DOM node: '${selector}' not found or not available yet. Try invoking inside a DOMContentLoaded event`))\n    }\n  }\n\n  container.appendChild(canvas)\n\n  return canvas\n}\n\nexport { createCanvas }","export function lerp(a, b, alpha) {\n  return a * (1 - alpha) + b * alpha;\n}\n\n/**\n * Create UUIDs \n * @return {string} Unique UUID\n */\nexport const createUUID = () => {\n  return ([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g, c => {\n    const crypto = window.crypto || window.msCrypto\n    //eslint-disable-next-line\n    return (c ^ crypto.getRandomValues(new Uint8Array(1))[0] & 15 >> c / 4).toString(16)\n  })\n}\n\nexport const recursiveSearch = (obj, searchKey, results = []) => {\n\tconst r = results;\n\tObject.keys(obj).forEach(key => {\n\t\tconst value = obj[key];\n\t\t// if(key === searchKey && typeof value !== 'object'){\n\t\tif(key === searchKey){\n\t\t\tr.push(value);\n\t\t} else if(value && typeof value === 'object'){\n\t\t\trecursiveSearch(value, searchKey, r);\n\t\t}\n\t});\n\treturn r;\n};\n\n/**\n * Debounce functions for better performance\n * (c) 2021 Chris Ferdinandi, MIT License, https://gomakethings.com\n * @param  {Function} fn The function to debounce\n */\nexport const debounce = (fn) => {\n\n\t// Setup a timer\n\tlet timeout;\n\n\t// Return a function to run debounced\n\treturn function () {\n\n\t\t// Setup the arguments\n\t\tlet context = this;\n\t\tlet args = arguments;\n\n\t\t// If there's a timer, cancel it\n\t\tif (timeout) {\n\t\t\twindow.cancelAnimationFrame(timeout);\n\t\t}\n\n\t\t// Setup the new requestAnimationFrame()\n\t\ttimeout = window.requestAnimationFrame(function () {\n\t\t\tfn.apply(context, args);\n\t\t});\n\t};\n}\n\n/**\n * Function Queue - ensures async function calls are triggered in the order they are queued\n * By David Adler (david_adler) @ https://stackoverflow.com/questions/53540348/js-async-await-tasks-queue\n * @param  {object} opts Option to dedupe concurrent executions\n * @return {object} returns object with \"push\" function, \"queue\" array, and \"flush\" function\n */\nexport const createAsyncQueue = (opts = { dedupe: false }) => {\n  const { dedupe } = opts\n  let queue = []\n  let running\n  const push = task => {\n    if (dedupe) queue = []\n    queue.push(task)\n    if (!running) running = start()\n    return running.finally(() => {\n      running = undefined\n    })\n  }\n  const start = async () => {\n    const res = []\n    while (queue.length) {\n      const item = queue.shift()\n      res.push(await item())\n    }\n    return res\n  }\n  return { push, queue, flush: () => running || Promise.resolve([]) }\n}\n\n// deep copy objects and break references to original object\n// Note: does not work with the 'scene' object or objects with circular references\nexport const deepCopy = obj => JSON.parse(JSON.stringify(obj))\n\n// Sleeper function to delay execution for testing\nexport const sleeper = (ms) => {\n  return new Promise(resolve => setTimeout(() => resolve(), ms));\n}\n\nexport class Random {\n  /**\n   * Generate a random number between 0 (inclusive) and 1 (exclusive).\n   * A drop in replacement for Math.random()\n   * @return {number}\n   */\n  static value() {\n    const crypto = window.crypto || window.msCrypto;\n    const buffer = new Uint32Array(1);\n    const int = crypto.getRandomValues(buffer)[0];\n\n    return int / 2**32\n  }\n  /**\n   * Generate a very good random number between min (inclusive) and max (exclusive) by using crypto.getRandomValues() twice.\n   * @param  {number} min\n   * @param  {number} max\n   * @return {number}\n   */\n  static range(min, max) {\n    // return Math.floor(this.value() * (max - min) + min); // plain random\n    return (Math.floor(Math.pow(10,14)*this.value()*this.value())%(max-min+1))+min // super random!\n  }\n}\n\n// https://www.30secondsofcode.org/c/js-colors/p/1\nexport const hexToRGB = hex => {\n  let alpha = false,\n    h = hex.slice(hex.startsWith('#') ? 1 : 0);\n  if (h.length === 3) h = [...h].map(x => x + x).join('');\n  else if (h.length === 8) alpha = true;\n  h = parseInt(h, 16);\n  let val = {\n    r: h >>> 16,\n    g: (h & 0x00ff00) >>> 8,\n    b: (h & 0x0000ff)\n  }\n  if(alpha) {\n    val.r = h >>> 24\n    val.g = (h & 0x00ff0000) >>> 16\n    val.b = (h & 0x0000ff00) >>> 8\n    val.a = (h & 0x000000ff)\n  }\n  return val\n\n};\n\nexport const RGBToHSB = (r, g, b) => {\n  r /= 255;\n  g /= 255;\n  b /= 255;\n  const v = Math.max(r, g, b),\n    n = v - Math.min(r, g, b);\n  const h =\n    n === 0 ? 0 : n && v === r ? (g - b) / n : v === g ? 2 + (b - r) / n : 4 + (r - g) / n;\n  return [60 * (h < 0 ? h + 6 : h), v && (n / v) * 100, v * 100];\n};\n\nexport const hexToHSB = (hex) => {\n  const rgb = hexToRGB(hex)\n  return RGBToHSB(rgb.r,rgb.g,rgb.b)\n}\n\nexport function webgl_support () {\n  try {\n    const canvas = document.createElement('canvas'); \n    return !!window.WebGLRenderingContext && (canvas.getContext('webgl') || canvas.getContext('experimental-webgl'));\n  } catch(e) {\n    return false;\n  }\n}","import { createCanvas } from './components/world/canvas'\nimport physicsWorker from './components/physics.worker.js?worker&inline'\nimport { debounce, createAsyncQueue, Random, hexToRGB, webgl_support } from './helpers'\n\nconst defaultOptions = {\n\tid: `dice-canvas-${Date.now()}`, // set the canvas id\n\tcontainer: null,\n  enableShadows: true, // do dice cast shadows onto DiceBox mesh?\n\tshadowTransparency: .8,\n\tlightIntensity: 1,\n  delay: 10, // delay between dice being generated - 0 causes stuttering and physics popping\n\tscale: 5, // scale the dice\n\ttheme: 'default', // can be a hex color or a pre-defined theme such as 'purpleRock'\n\tpreloadThemes: [],\n\texternalThemes: {}, // point to CDN paths\n\tthemeColor: '#2e8555', // used for color values or named theme variants - not fully implemented yet // green: #2e8555 // yellow: #feea03\n\toffscreen: true, // use offscreen canvas browser feature for performance improvements - will fallback to false based on feature detection\n\tassetPath: '/assets/dice-box/', // path to 'ammo', 'themes' folders and web workers\n\t// origin: location.origin,\n\torigin: typeof window !== \"undefined\" ? window.location.origin : \"\",\n\tsuspendSimulation: false\n}\n\nclass WorldFacade {\n\trollCollectionData = {}\n\trollGroupData = {}\n\trollDiceData = {}\n\tthemeData = []\n\tthemesLoadedData = {}\n\t#collectionIndex = 0\n\t#groupIndex = 0\n\t#rollIndex = 0\n\t#idIndex = 0\n\t#DiceWorld = {}\n\t#diceWorldPromise\n\t#diceWorldResolve\n\t#DicePhysics\n\t#dicePhysicsPromise\n\t#dicePhysicsResolve\n\t#webgl_support = true\n\tnoop = () => {}\n\n  constructor(options = {}){\n\t\t// allow for depricated config with a warning\n\t\tif (arguments.length === 2 && typeof(arguments[0] === 'string') && typeof(arguments[1] === 'object')) {\n\t\t\tconsole.warn(`You are using the old API. Dicebox constructor accepts a config object as it's only argument. Please read the v1.1.0 docs at https://fantasticdice.games/docs/usage/config`)\n\t\t\toptions = arguments[1]\n\t\t\toptions.container = arguments[0]\n\t\t}\n\n\t\tif(typeof options !== 'object') {\n\t\t\tthrow new Error('Config options should be an object. Config reference: https://fantasticdice.games/docs/usage/config#configuration-options')\n\t\t}\n\t\t// pull out callback functions from options\n\t\tconst { onBeforeRoll, onDieComplete, onRollComplete, onRemoveComplete, onThemeConfigLoaded, onThemeLoaded, ...boxOptions } = options\n\n\t\t// extend defaults with options\n\t\tthis.config = {...defaultOptions, ...boxOptions}\n\n\t\t// assign callback functions\n\t\tthis.onBeforeRoll = options.onBeforeRoll || this.noop\n\t\tthis.onDieComplete = options.onDieComplete || this.noop\n\t\tthis.onRollComplete = options.onRollComplete || this.noop\n\t\tthis.onRemoveComplete = options.onRemoveComplete || this.noop\n\t\tthis.onThemeLoaded = options.onThemeLoaded || this.noop\n\t\tthis.onThemeConfigLoaded = options.onThemeConfigLoaded || this.noop\n\n\t\t// is webGL supported?\n\t\tif(webgl_support()){\n\t\t\t// if a canvas selector is provided then that will be used for the dicebox, otherwise a canvas will be created using the config.id\n\t\t\tthis.canvas = createCanvas({\n\t\t\t\tselector: this.config.container,\n\t\t\t\tid: this.config.id\n\t\t\t})\n\t\t\tthis.isVisible = true\n\t\t} else {\n\t\t\tthis.#webgl_support = false\n\t\t}\n\n\t\t// create a queue to prevent theme being loaded multiple times\n\t\tthis.loadThemeQueue = createAsyncQueue()\n  }\n\n\t// Load the BabylonJS World\n\tasync #loadWorld(){\n\n\t\t// set up a promise to be fulfilled when a message comes back from DiceWorld indicating init is complete\n\t\tthis.#diceWorldPromise = new Promise((resolve, reject) => {\n\t\t\tthis.#diceWorldResolve = resolve\n\t\t})\n\n\t\t// resolve the promise one onInitComplete callback is triggered\n\t\tconst onInitComplete = () => {\n\t\t\tthis.#diceWorldResolve()\n\t\t}\n\n    if(!this.#webgl_support){\n      console.warn('This browser does not support WebGL which is required for 3D rendering. Falling back to random number generator')\n      const WorldNone = await import('./components/world.none').then(module => module.default)\n      this.#DiceWorld = new WorldNone({\n\t\t\t\tcanvas: this.canvas,\n\t\t\t\toptions: this.config,\n\t\t\t\tonInitComplete\n\t\t\t})\n    }\n\t\telse if (\"OffscreenCanvas\" in window && \"transferControlToOffscreen\" in this.canvas && this.config.offscreen) {\n\t\t\t// Ok to use offscreen canvas - transfer control offscreen\n\t\t\tconst WorldOffscreen = await import('./components/world.offscreen').then(module => module.default)\n\t\t\t// WorldOffscreen is just a container class that passes all method calls to the Offscreen Canvas worker\n\t\t\tthis.#DiceWorld = new WorldOffscreen({\n\t\t\t\tcanvas: this.canvas,\n\t\t\t\toptions: this.config,\n\t\t\t\tonInitComplete\n\t\t\t})\n\t\t} else {\n\t\t\tif(this.config.offscreen){\n\t\t\t\tconsole.warn(\"This browser does not support OffscreenCanvas. Using standard canvas fallback.\")\n\t\t\t\tthis.config.offscreen = false\n\t\t\t}\n\t\t\t// code splitting out WorldOnscreen. It's essentially the same as offscreenCanvas.worker.js but communicates with the main thread differently\n\t\t\tconst WorldOnscreen = await import('./components/world.onscreen').then(module => module.default)\n\t\t\tthis.#DiceWorld = new WorldOnscreen({\n\t\t\t\tcanvas: this.canvas,\n\t\t\t\toptions: this.config,\n\t\t\t\tonInitComplete\n\t\t\t})\n\t\t}\n\t}\n\n\t// Load the AmmoJS physics world\n\t#loadPhysics(){\n\t\t// initialize physics world in which AmmoJS runs\n\t\tthis.#DicePhysics = new physicsWorker()\n\t\t// set up a promise to be fulfilled when a message comes back from physics.worker indicating init is complete\n\t\tthis.#dicePhysicsPromise = new Promise((resolve, reject) => {\n\t\t\tthis.#dicePhysicsResolve = resolve\n\t\t})\n\t\tthis.#DicePhysics.onmessage = (e) => {\n\t\t\tswitch( e.data.action ) {\n\t\t\t\tcase \"init-complete\":\n\t\t\t\t\tthis.#dicePhysicsResolve() // fulfill promise so other things can run\n\t\t\t}\n    }\n\t\t// initialize the AmmoJS physics worker\n\t\tthis.#DicePhysics.postMessage({\n\t\t\taction: \"init\",\n\t\t\twidth: this.canvas.clientWidth,\n\t\t\theight: this.canvas.clientHeight,\n\t\t\toptions: this.config\n\t\t})\n\t}\n\n\t#connectWorld(){\n\t\tconst channel = new MessageChannel()\n\t\t\n\t\t// create message channel for the visual world and the physics world to communicate through\n\t\tthis.#DiceWorld.connect(channel.port1)\n\n\t\t// create message channel for this WorldFacade class to communicate with physics world\n\t\tthis.#DicePhysics.postMessage({\n\t\t\taction: \"connect\"\n\t\t},[ channel.port2 ])\n\t}\n\n\tresizeWorld(){\n\t\t// send resize events to workers - debounced for performance\n\t\tconst resizeWorkers = () => {\n\t\t\tthis.#DiceWorld.resize({width: this.canvas.clientWidth, height: this.canvas.clientHeight})\n\t\t\tif(this.#DicePhysics){\n\t\t\t\tthis.#DicePhysics.postMessage({action: \"resize\", width: this.canvas.clientWidth, height: this.canvas.clientHeight});\n\t\t\t}\n\t\t}\n\t\tconst debounceResize = debounce(resizeWorkers)\n\t\twindow.addEventListener(\"resize\", debounceResize)\n\t}\n\n  async init() {\n\t\t// trigger physics first so it can load in parallel with world\n    if(this.#webgl_support){\n      this.#loadPhysics()\n    } else {\n      this.#dicePhysicsPromise = Promise.resolve()\n    }\n\t\tawait this.#loadWorld()\n\t\tthis.resizeWorld()\n\n\t\t// now that DiceWorld is ready we can attach our callbacks\n\t\tthis.#DiceWorld.onRollResult = (result) => {\n\t\t\tconst die = this.rollDiceData[result.rollId]\n\t\t\tconst group = this.rollGroupData[die.groupId]\n\t\t\tconst collection = this.rollCollectionData[die.collectionId]\n\n\t\t\t// map die results back to our rollData\n\t\t\t// since all rolls are references to this.rollDiceDate the values will be added to those objects\n\t\t\tgroup.rolls[die.rollId].value = result.value\n\n\t\t\t// increment the completed roll count for this group\n\t\t\tcollection.completedRolls++\n\t\t\t// if all rolls are completed then resolve the collection promise - returning dice that were in this collection\n\t\t\tif(collection.completedRolls == collection.rolls.length) {\n\t\t\t\t// pull out roll.collectionId and roll.id? They're meant to be internal values\n\t\t\t\tcollection.resolve(Object.values(collection.rolls).map(({collectionId, id, meshName, ...rest}) => rest))\n\t\t\t}\n\n\t\t\t// trigger callback passing individual die result\n\t\t\tconst {collectionId, id, ...returnDie} = die\n\t\t\tthis.onDieComplete(returnDie)\n\t\t}\n\t\tthis.#DiceWorld.onRollComplete = () => {\n\t\t\t// trigger callback passing the roll results\n\t\t\tthis.onRollComplete(this.getRollResults())\n\t\t}\n\n\t\tthis.#DiceWorld.onDieRemoved = (rollId) => {\n\t\t\t// get die information from cache\n\t\t\tlet die = this.rollDiceData[rollId]\n\t\t\tconst collection = this.rollCollectionData[die.removeCollectionId]\n\t\t\tcollection.completedRolls++\n\n\t\t\t// remove this die from cache\n\t\t\tdelete this.rollDiceData[die.rollId]\n\n\t\t\t// remove this die from it's group rolls\n\t\t\tconst group = this.rollGroupData[die.groupId]\n\t\t\tdelete group.rolls[die.rollId]\n\n\t\t\t// parse the group value now that the die has been removed from data\n\t\t\tconst groupData = this.#parseGroup(die.groupId)\n\t\t\t// update the value and quantity values\n\t\t\tgroup.value = groupData.value\n\t\t\tgroup.qty = groupData.rollsArray.length\n\n\t\t\t// if all rolls are completed then resolve the collection promise - returning dice that were removed\n\t\t\tif(collection.completedRolls == collection.rolls.length) {\n\t\t\t\tcollection.resolve(Object.values(collection.rolls).map(({id, ...rest}) => rest))\n\t\t\t}\n\t\t\tconst {collectionId, id, removeCollectionId, meshName, ...returnDie} = die\n\t\t\tthis.onRemoveComplete(returnDie)\n\t\t}\n\n    // wait for both DiceWorld and DicePhysics to initialize\n\t\tawait Promise.all([this.#diceWorldPromise, this.#dicePhysicsPromise])\n    \n    if(this.#DicePhysics){\n      // set up message channels between Dice World and Dice Physics\n      this.#connectWorld()\n    }\n\n\t\t// queue load of the theme defined in the config\n\t\tawait this.loadThemeQueue.push(() => this.loadTheme(this.config.theme))\n\t\t\n\t\t// queue load of other defined themes\n\n\t\tthis.config.preloadThemes.forEach(async function(theme) {\n\t\t\tawait this.loadThemeQueue.push(() => this.loadTheme(theme))\n\t\t}.bind(this))\n\n\n\t\t//TODO: this should probably return a promise\n\t\t// make this method chainable\n\t\treturn this\n  }\n\n\t// fetch the theme config and return a themeData object\n\tasync getThemeConfig(theme){\n\t\tlet basePath = `${this.config.origin}${this.config.assetPath}themes/${theme}`\n\n\t\tif(this.config.externalThemes[theme]){\n\t\t\tbasePath = this.config.externalThemes[theme]\n\t\t}\n\n\n\t\t// fetch the theme.config file\n\t\tlet themeData = await fetch(`${basePath}/theme.config.json`).then(resp => {\n\t\t\tif(resp.ok) {\n\t\t\t\tconst contentType = resp.headers.get(\"content-type\")\n\t\t\t\tif (contentType && contentType.indexOf(\"application/json\") !== -1) {\n\t\t\t\t\treturn resp.json()\n\t\t\t\t} \n\t\t\t\telse if (resp.type && resp.type === 'basic') {\n\t\t\t\t\treturn resp.json()\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t// return resp\n\t\t\t\t\tthrow new Error(`Incorrect contentType: ${contentType}. Expected \"application/json\" or \"basic\"`)\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthrow new Error(`Unable to fetch config file for theme: '${theme}'. Request rejected with status ${resp.status}: ${resp.statusText}`)\n\t\t\t}\n\t\t}).catch(error => console.error(error))\n\n\t\tif(!themeData){\n\t\t\tthrow new Error(\"No theme config data to work with.\")\n\t\t}\n\n\t\tlet meshName = 'default'\n\t\tlet meshFilePath = `${this.config.origin}${this.config.assetPath}themes/default/default.json`\n\n\t\tif(themeData.hasOwnProperty('meshFile')){\n\t\t\tmeshName = themeData.meshFile.replace(/(.*)\\..{2,4}$/,'$1')\n\t\t\tmeshFilePath = `${basePath}/${themeData.meshFile}`\n\t\t}\n\n\t\t// if diceAvailable is not specified then assume the default set of seven\n\t\tif(!themeData.hasOwnProperty('diceAvailable')){\n\t\t\tthrow new Error('A theme must indicate which dice are available by defining \"diceAvailable\".')\n\t\t}\n\n\t\t// extend themes\n\t\t// if a theme extends another theme then the diceAvailable will be added to the diceExtended value of the extended theme\n\t\t// the extended them can then roll those dice as if it were part of it's own theme\n\t\t// example: diceOfRolling-fate extends diceOfRolling. You can now roll 3dfate with the theme: 'diceOfRolling'\n\n\t\tif(themeData.hasOwnProperty(\"extends\")){\n\t\t\tconst target = await this.loadTheme(themeData.extends).catch(error => console.error(error))\n\n\t\t\t// can not extend a theme that extends another theme\n\t\t\tif(target.hasOwnProperty(\"extends\")){\n\t\t\t\tthrow new Error('Cannot extend a theme that extends another theme.')\n\t\t\t}\n\n\t\t\t// add target diceAvailable into theme.diceExtended\n\t\t\tconst newDice = {}\n\t\t\tthemeData.diceAvailable.forEach(die => {\n\t\t\t\tnewDice[die] = themeData.systemName\n\t\t\t})\n\t\t\ttarget.diceExtended = {...target.diceExtended, ...newDice}\n\t\t\t// set the theme to the parent theme\n\t\t\tthis.config.theme = themeData.extends\n\t\t}\n\n\n\t\tObject.assign(themeData,\n\t\t\t{\n\t\t\t\tbasePath,\n\t\t\t\tmeshFilePath,\n\t\t\t\tmeshName,\n\t\t\t\ttheme,\n\t\t\t}\n\t\t)\n\n\t\t// this.onThemeConfigLoaded(themeData)\n\n\t\treturn themeData\n\t}\n\n\tasync loadTheme(theme){\n\t\t// check the cache\n\t\tif(this.themesLoadedData[theme]) {\n\t\t\t// short circuit if theme has been previously loaded\n\t\t\t// console.log(`${theme} has already been loaded. Returning cache`)\n\t\t\treturn this.themesLoadedData[theme]\n\t\t}\n\t\t// console.log(`${theme} is loading ...`)\n\n\t\t// fetch and save the themeData for later\n\t\tconst themeConfig = this.themesLoadedData[theme] = await this.getThemeConfig(theme).catch(error => console.error(error))\n\t\tthis.onThemeConfigLoaded(themeConfig)\n\n\t\tif(!themeConfig) return\n\n\t\t// pass config onto DiceWorld to load - the theme loader needs 'scene' from DiceWorld\n\t\tawait this.#DiceWorld.loadTheme(themeConfig).catch(error => console.error(error))\n\n\t\tthis.onThemeLoaded(themeConfig)\n\n\t\treturn themeConfig\n\t}\n\n\t// TODO: use getter and setter\n\t// change config options\n\tasync updateConfig(options) {\n\t\tconst newConfig = {...this.config,...options}\n\t\t// console.log('newConfig', newConfig)\n\t\t// const config = await this.loadThemeQueue.push(() => this.loadTheme(newConfig.theme))\n\t\t// const themeData = config.at(-1) //get the last entry returned from the queue\n\n\t\tthis.config = newConfig\n\n\t\tif(newConfig.theme){\n\t\t\tconst config = await this.loadThemeQueue.push(() => this.loadTheme(newConfig.theme))\n\t\t\tconst themeData = config.at(-1) //get the last entry returned from the queue\n\t\t\tif(themeData.hasOwnProperty(\"extends\")){\n\t\t\t\t// set the theme to the parent theme\n\t\t\t\tthis.config.theme = themeData.extends\n\t\t\t}\n\t\t}\n\n\t\t// pass updates to DiceWorld\n\t\tthis.#DiceWorld.updateConfig(newConfig)\n\n\t\tif(this.#DicePhysics){\n\t\t// pass updates to PhysicsWorld\n\t\t\tthis.#DicePhysics.postMessage({\n\t\t\t\taction: 'updateConfig',\n\t\t\t\toptions: newConfig\n\t\t\t})\n\t\t}\n\n\t\t// make this method chainable\n\t\treturn this\n\t}\n\n\tclear() {\n\t\t// reset indexes\n\t\tthis.#collectionIndex = 0\n\t\tthis.#groupIndex = 0\n\t\tthis.#rollIndex = 0\n\t\tthis.#idIndex = 0\n\t\t// reset internal data objects\n\t\tthis.rollCollectionData = {}\n\t\tthis.rollGroupData = {}\n\t\tthis.rollDiceData = {}\n\t\t// clear all rendered die bodies\n\t\tthis.#DiceWorld.clear()\n\t\tif(this.#DicePhysics){\n\t\t\t// clear all physics die bodies\n\t\t\tthis.#DicePhysics.postMessage({action: \"clearDice\"})\n\t\t}\n\n\t\t// make this method chainable\n\t\treturn this\n  }\n\n\thide(className) {\n\t\tif(className){\n\t\t\tthis.canvas.dataset.hideClass = className\n\t\t\tthis.canvas.classList.add(className)\n\t\t} else {\n\t\t\tthis.canvas.style.display = 'none'\n\t\t}\n\n\t\tthis.isVisible = false;\n\n\t\t// make this method chainable\n\t\treturn this\n\t}\n\n\tshow() {\n\t\tconst hideClass = this.canvas.dataset?.hideClass\n\t\tif(hideClass){\n\t\t\tdelete this.canvas.dataset.hideClass\n\t\t\tthis.canvas.classList.remove(hideClass)\n\t\t} else {\n\t\t\tthis.canvas.style.display = 'block'\n\t\t}\n\t\tthis.isVisible = true;\n\t\tthis.resizeWorld();\n\n\t\t// make this method chainable\n\t\treturn this\n\t}\n\n\t// TODO: pass data with roll - such as roll name. Passed back at the end in the results\n\troll(notation, {theme = this.config.theme, themeColor = this.config.themeColor, newStartPoint = true} = {}) {\n\t\t// note: to add to a roll on screen use .add method\n\t\t// reset the offscreen worker and physics worker with each new roll\n\t\tthis.clear()\n\t\tconst collectionId = this.#collectionIndex++\n\t\t\n\t\tthis.rollCollectionData[collectionId] = new Collection({\n\t\t\tid: collectionId,\n\t\t\tnotation,\n\t\t\ttheme,\n\t\t\tthemeColor,\n\t\t\tnewStartPoint\n\t\t})\n\n\t\tconst parsedNotation = this.createNotationArray(notation, this.themesLoadedData[theme].diceAvailable)\n\t\tthis.#makeRoll(parsedNotation, collectionId)\n\n\t\t// returns a Promise that is resolved in onRollComplete\n\t\treturn this.rollCollectionData[collectionId].promise\n\t}\n\n  add(notation, {theme = this.config.theme, themeColor = this.config.themeColor, newStartPoint = true} = {}) {\n\n\t\tconst collectionId = this.#collectionIndex++\n\n\t\tthis.rollCollectionData[collectionId] = new Collection({\n\t\t\tid: collectionId,\n\t\t\tnotation,\n\t\t\ttheme,\n\t\t\tthemeColor,\n\t\t\tnewStartPoint\n\t\t})\n\t\t\n\t\tconst parsedNotation = this.createNotationArray(notation, this.themesLoadedData[theme].diceAvailable)\n\t\tthis.#makeRoll(parsedNotation, collectionId)\n\n\t\t// returns a Promise that is resolved in onRollComplete\n\t\treturn this.rollCollectionData[collectionId].promise\n  }\n\n\treroll(notation, {remove = false, hide = false, newStartPoint = true} = {}) {\n\t\t// TODO: add hide if you want to keep the die result for an external parser\n\n\t\t// ensure notation is an array\n\t\tconst rollArray = Array.isArray(notation) ? notation : [notation]\n\n\t\t// destructure out 'sides', 'theme', 'groupId', 'rollId' - basically just getting rid of value - could do ({value, ...rest}) => rest\n\t\tconst cleanNotation = rollArray.map(({value, ...rest}) => rest)\n\n\t\tif(remove === true){\n\t\t\tthis.remove(cleanNotation, {hide})\n\t\t}\n\n\t\t// .add will return a promise that will then be returned here\n\t\treturn this.add(cleanNotation, {newStartPoint})\n\t}\n\n\tremove(notation, {hide = false} = {}) {\n\t\t// ensure notation is an array\n\t\tconst rollArray = Array.isArray(notation) ? notation : [notation]\n\n\t\tconst collectionId = this.#collectionIndex++\n\n\t\tthis.rollCollectionData[collectionId] = new Collection({\n\t\t\tid: collectionId,\n\t\t\tnotation,\n\t\t\trolls: rollArray,\n\t\t})\n\n\t\t// loop through each die to be removed\n\t\trollArray.map(die => {\n\t\t\t// add the collectionId to the die so it can be looked up in the callback\n\t\t\tthis.rollDiceData[die.rollId].removeCollectionId = collectionId\n\t\t\t// assign the id for this die from our cache - required for removal\n\t\t\t// die.id = this.rollDiceData[die.rollId].id - note: can appear in async roll result data if attached to die object\n\t\t\tlet id = this.rollDiceData[die.rollId].id\n\t\t\t// remove the die from the render - don't like having to pass two ids. rollId is passed over just so it can be passed back for callback\n\t\t\tthis.#DiceWorld.remove({id,rollId: die.rollId})\n\t\t\tif(this.#DicePhysics){\n\t\t\t\t// remove the die from the physics bodies\n\t\t\t\tthis.#DicePhysics.postMessage({action: \"removeDie\", id })\n\t\t\t}\n\t\t})\n\n\t\treturn this.rollCollectionData[collectionId].promise\n\t}\n\n\t// used by both .add and .roll - .roll clears the box and .add does not\n\tasync #makeRoll(parsedNotation, collectionId){\n\n\t\tthis.onBeforeRoll(parsedNotation)\n\n\t\tconst collection = this.rollCollectionData[collectionId]\n\t\tlet newStartPoint = collection.newStartPoint\n\n\t\t// loop through the number of dice in the group and roll each one\n\t\tparsedNotation.forEach(async notation => {\n\t\t\tif(!notation.sides) {\n\t\t\t\tthrow new Error(\"Improper dice notation or unable to parse notation\")\n\t\t\t}\n\t\t\tlet theme = notation.theme || collection.theme || this.config.theme\n\t\t\tconst themeColor = notation.themeColor || collection.themeColor || this.config.themeColor\n\t\t\tconst rolls = {}\n\t\t\tconst hasGroupId = notation.groupId !== undefined\n\t\t\tlet index\n\t\t\t\n\t\t\t// load the theme, will be short circuited if previously loaded\n\t\t\tconst loadTheme = () => this.loadTheme(theme)\n\t\t\tawait this.loadThemeQueue.push(loadTheme)\n\n\t\t\t// const {meshName, diceAvailable, diceInherited = {}, material: { type: materialType }} = this.themesLoadedData[theme]\n\t\t\tlet meshName = this.themesLoadedData[theme].meshName\n\t\t\tlet diceAvailable = this.themesLoadedData[theme]?.diceAvailable\n\t\t\tlet diceExtended = this.themesLoadedData[theme].diceExtended || {}\n\t\t\tlet materialType = this.themesLoadedData[theme]?.material?.type\n\n\t\t\tconst diceExtra = Object.keys(diceExtended)\n\n\t\t\tif(diceExtra && diceExtra.includes(notation.sides)){\n\t\t\t\ttheme = diceExtended[notation.sides]\n\t\t\t\tconst loadExtendedTheme = () => this.loadTheme(theme)\n\t\t\t\tthis.loadThemeQueue.push(loadExtendedTheme)\n\t\t\t\tmeshName = this.themesLoadedData[theme].meshName\n\t\t\t\tdiceAvailable = this.themesLoadedData[theme]?.diceAvailable\n\t\t\t\tmaterialType = this.themesLoadedData[theme]?.material?.type\n\t\t\t}\n\n\t\t\tlet colorSuffix = '', color\n\n\t\t\tif(materialType === \"color\") {\n\t\t\t\tcolor = hexToRGB(themeColor)\n\t\t\t\t// dat.gui uses HSB(a.k.a HSV) brightness greater than .5 and saturation less than .5\n\t\t\t\tcolorSuffix = ((color.r*0.299 + color.g*0.587 + color.b*0.114) > 175) ? '_dark' : '_light'\n\t\t\t}\n\n\t\t\t// TODO: should I validate that added dice are only joining groups of the same \"sides\" value - e.g.: d6's can only be added to groups when sides: 6? Probably.\n\t\t\tfor (var i = 0, len = notation.qty; i < len; i++) {\n\t\t\t\t// id's start at zero and zero can be falsy, so we check for undefined\n\t\t\t\tlet rollId = notation.rollId !== undefined ? notation.rollId : this.#rollIndex++\n\t\t\t\tlet id = notation.id !== undefined ? notation.id : this.#idIndex++\n\t\t\t\tindex = hasGroupId ? notation.groupId : this.#groupIndex\n\n        // when a roll object is passed in, notation.sides could be an integer - convert the die type to include the \"d\" prefix so it will match the model names\n\t\t\t\tconst dieType = Number.isInteger(notation.sides) ? `d${notation.sides}` : notation.sides\n\n        // when a roll string is passed in, notation.sides will be a string - convert it to an integer so it will match the object data type of a notation object\n        if(/^d[1-9]{1}[0-9]{0,1}0?$/.test(notation.sides)){\n          notation.sides =  parseInt(notation.sides.replace('d', ''))\n        }\n\n\t\t\t\tconst roll = {\n\t\t\t\t\tsides: notation.sides,\n\t\t\t\t\tdata: notation.data,\n\t\t\t\t\tdieType,\n\t\t\t\t\tgroupId: index,\n\t\t\t\t\tcollectionId: collection.id,\n\t\t\t\t\trollId,\n\t\t\t\t\tid,\n\t\t\t\t\ttheme,\n\t\t\t\t\tthemeColor,\n\t\t\t\t\tmeshName\n\t\t\t\t}\n\n\t\t\t\trolls[rollId] = roll\n\t\t\t\tthis.rollDiceData[rollId] = roll\n\t\t\t\tcollection.rolls.push(this.rollDiceData[rollId])\n\n\t\t\t\t// TODO: eliminate the 'd' for more flexible naming such as 'fate' - ensure numbers are strings\n\t\t\t\tif (roll.sides === 'fate' && (!diceAvailable.includes(dieType) && !diceExtra.includes(dieType)) || roll.sides === 'fate' && !this.#webgl_support){\n\t\t\t\t\tconsole.warn(`fate die unavailable in '${theme}' theme. Using fallback.`)\n\t\t\t\t\tconst min = -1\n\t\t\t\t\tconst max = 1\n\t\t\t\t\troll.value = Random.range(min,max)\n\t\t\t\t\tthis.#DiceWorld.addNonDie(roll)\n\t\t\t\t} else if(this.config.suspendSimulation || (!diceAvailable.includes(dieType) && !diceExtra.includes(dieType)) || !this.#webgl_support){\n\t\t\t\t\t// check if the requested roll is available in the current theme, if not then use crypto fallback\n\t\t\t\t\tconst warning = \n\t\t\t\t\t!this.#webgl_support \n\t\t\t\t\t\t? `This browser does not support webGL. Using random number fallback.` \n\t\t\t\t\t\t: this.config.suspendSimulation \n\t\t\t\t\t\t\t? \"3D simulation suspended. Using fallback.\" \n\t\t\t\t\t\t\t: `${roll.sides} die unavailable in '${theme}' theme. Using fallback.`\n\t\t\t\t\tconsole.warn(warning)\n\t\t\t\t\tconst max = Number.isInteger(roll.sides) ? roll.sides : parseInt(roll.sides.replace(/\\D/g,''))\n\t\t\t\t\troll.value = Random.range(1, max)\n\t\t\t\t\tthis.#DiceWorld.addNonDie(roll)\n\t\t\t\t} else {\n\t\t\t\t\tlet extendedTheme\n\t\t\t\t\tif(diceExtra.includes(dieType)) {\n\t\t\t\t\t\tconst extendedThemeName = diceExtended[dieType]\n\t\t\t\t\t\textendedTheme = this.themesLoadedData[extendedThemeName]\n\t\t\t\t\t}\n\t\t\t\t\tthis.#DiceWorld.add({\n\t\t\t\t\t\t...roll,\n\t\t\t\t\t\tnewStartPoint,\n\t\t\t\t\t\ttheme: extendedTheme?.systemName || theme,\n\t\t\t\t\t\tmeshName: extendedTheme?.meshName || meshName,\n\t\t\t\t\t\tcolorSuffix\n\t\t\t\t\t})\n\t\t\t\t}\n\n\t\t\t\t// turn flag off\n\t\t\t\tnewStartPoint = false\n\t\t\t}\n\n\t\t\tif(hasGroupId) {\n\t\t\t\tObject.assign(this.rollGroupData[index].rolls, rolls)\n\t\t\t} else {\n\t\t\t\t// save this roll group for later\n\t\t\t\tnotation.rolls = rolls\n\t\t\t\tnotation.id = index\n\t\t\t\tthis.rollGroupData[index] = notation\n\t\t\t\t++this.#groupIndex\n\t\t\t}\n\t\t})\n\t}\n\n\t// accepts simple notations eg: 4d6\n\t// accepts array of notations eg: ['4d6','2d10']\n\t// accepts object {sides:int, qty:int}\n\t// accepts array of objects eg: [{sides:int, qty:int, mods:[]}]\n\tcreateNotationArray(input, diceAvailable){\n\t\tconst notation = Array.isArray( input ) ? input : [ input ]\n\t\tlet parsedNotation = []\n\n\n\t\tconst verifyObject = ( object ) => {\n\t\t\tif(!object.hasOwnProperty('qty')) {\n\t\t\t\tobject.qty = 1\n\t\t\t}\n\t\t\tif ( object.hasOwnProperty('sides') ) {\n\t\t\t\tif(object.sides === '100'){\n\t\t\t\t\tobject.sides = 100\n\t\t\t\t\tobject.data = 'single'\n\t\t\t\t}\n\t\t\t\treturn true\n\t\t\t} else {\n\t\t\t\tconst err = \"Roll notation is missing sides\"\n\t\t\t\tthrow new Error(err);\n\t\t\t}\n\t\t}\n\n\t\tconst incrementId = (key) => {\n\t\t\tkey = key.toString()\n\t\t\tlet splitKey = key.split(\".\")\n\t\t\tif(splitKey[1]){\n\t\t\t\tsplitKey[1] = parseInt(splitKey[1]) + 1\n\t\t\t} else {\n\t\t\t\tsplitKey[1] = 1\n\t\t\t}\n\t\t\treturn splitKey[0] + \".\" + splitKey[1]\n\t\t}\n\n\t\t// verify that the rollId is unique. If not then increment it by .1\n\t\t// rollIds become keys in the rollDiceData object, so they must be unique or they will overwrite another entry\n\t\tconst verifyRollId = ( object ) => {\n\t\t\tif(object.hasOwnProperty('rollId')){\n\t\t\t\tif(this.rollDiceData.hasOwnProperty(object.rollId)){\n\t\t\t\t\tobject.rollId = incrementId(object.rollId)\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(!object.hasOwnProperty('modifier')){\n\t\t\t\tobject.modifier = 0\n\t\t\t}\n\t\t}\n\n\t\t// notation is an array of strings or objects\n\t\tnotation.forEach(roll => {\n\t\t\t// console.log('roll', roll)\n\t\t\t// if notation is an array of strings\n\t\t\tif ( typeof roll === 'string' ) {\n\t\t\t\tparsedNotation.push( this.parse( roll, diceAvailable ) )\n\t\t\t} else if ( typeof notation === 'object' ) {\n\t\t\t\tverifyRollId( roll )\n\t\t\t\tverifyObject( roll )  && parsedNotation.push( roll )\n\t\t\t}\n\t\t})\n\n\t\treturn parsedNotation\n\t}\n\n  // parse text die notation such as 2d10+3 => {number:2, type:6, modifier:3}\n  // taken from https://github.com/ChapelR/dice-notation\n  parse(notation, diceAvailable) {\n    const diceNotation = /(\\d+)([dD]{1}\\d+)(.*)$/i\n\t\tconst percentNotation = /(\\d+)[dD](00|%)(.*)$/i\n\t\tconst fudgeNotation = /(\\d+)[dD](f+[ate]*)(.*)$/i\n\t\t// const customNotation = /(\\d+)[dD](.*)([+-])/i\n\t\tconst customNotation = /(\\d+)[dD]([\\d\\w]+)([+-]{0,1}\\d+)?/i\n    const modifier = /([+-])(\\d+)/\n    const cleanNotation = notation.trim().replace(/\\s+/g, '')\n    const validNumber = (n, err) => {\n      n = Number(n)\n      if (Number.isNaN(n) || !Number.isInteger(n) || n < 1) {\n        throw new Error(err);\n      }\n      return n\n    }\n\n\t\t// match percentNotation before diceNotation\n    const roll = cleanNotation.match(percentNotation) || cleanNotation.match(diceNotation) || cleanNotation.match(fudgeNotation) || cleanNotation.match(customNotation);\n\n\t\tlet mod = 0;\n    const msg = 'Invalid notation: ' + notation + '';\n\n    if (!roll || !roll.length || roll.length < 3) {\n      throw new Error(msg);\n    }\n    if (roll[3] && modifier.test(roll[3])) {\n      const modParts = roll[3].match(modifier);\n      let basicMod = validNumber(modParts[2], msg);\n      if (modParts[1].trim() === '-') {\n        basicMod *= -1;\n      }\n      mod = basicMod;\n    }\n\n\t\tconst returnObj = {\n\t\t\tqty : validNumber(roll[1], msg),\n      modifier: mod,\n\t\t}\n\n\t\tif(cleanNotation.match(percentNotation)){\n\t\t\treturnObj.sides = 'd100'\n\t\t\treturnObj.data = 'single'\n\t\t} else if(cleanNotation.match(fudgeNotation)){\n\t\t\treturnObj.sides = 'fate' // force lowercase\n\t\t} else if(diceAvailable.includes(cleanNotation.match(customNotation)[2])){\n\t\t\treturnObj.sides = roll[2] // dice type instead of number\n\t\t} else {\n\t\t\treturnObj.sides = roll[2];\n\t\t}\n\n    return returnObj\n  }\n\n\t#parseGroup(groupId) {\n\t\t// console.log('groupId', groupId)\n\t\tconst rollGroup = this.rollGroupData[groupId]\n\t\t// turn object into an array\n\t\tconst rollsArray = Object.values(rollGroup.rolls).map(({collectionId, id, meshName, ...rest}) => rest)\n\t\t// add up the values\n\t\t// some dice may still be rolling, should this be a promise?\n\t\t// if dice are still rolling in the group then the value is undefined - hence the isNaN check\n\t\tlet value = rollsArray.reduce((val,roll) => {\n\t\t\tconst rollVal = isNaN(roll.value) ? 0 : roll.value\n\t\t\treturn val + rollVal\n\t\t},0)\n\t\t// add the modifier\n\t\tvalue += rollGroup.modifier ? rollGroup.modifier : 0\n\t\t// return the value and the rollsArray\n\t\treturn {value, rollsArray}\n\t}\n\n\tgetRollResults(){\n\t\t// loop through each roll group\n\t\treturn Object.entries(this.rollGroupData).map(([key,val]) => {\n\t\t\t// parse the group data to get the value and the rolls as an array\n\t\t\tconst groupData = this.#parseGroup(key)\n\t\t\t// set the value for this roll group in this.rollGroupData\n\t\t\tval.value = groupData.value\n\t\t\t// set the qty equal to the number of rolls - this can be changed by rerolls and removals\n\t\t\tval.qty = groupData.rollsArray.length\n\t\t\t// copy the group that will be put into the return object\n\t\t\tconst groupCopy = {...val}\n\t\t\t// replace the rolls object with a rolls array\n\t\t\tgroupCopy.rolls = groupData.rollsArray\n\t\t\t// return the groupCopy - note: we never return this.rollGroupData\n\t\t\treturn groupCopy\n\t\t})\n\t}\n}\n\nclass Collection{\n\tconstructor(options){\n\t\tObject.assign(this,options)\n\t\tthis.rolls = options.rolls || []\n\t\tthis.completedRolls = 0\n\t\tconst that = this\n\t\tthis.promise = new Promise((resolve,reject) => {\n\t\t\tthat.resolve = resolve\n\t\t\tthat.reject = reject\n\t\t})\n\t}\n}\n\nexport default WorldFacade"],"names":["createCanvas","options","selector","id","container","canvas","debounce","fn","timeout","context","args","createAsyncQueue","opts","dedupe","queue","running","push","task","start","res","item","deepCopy","obj","Random","crypto","buffer","min","max","hexToRGB","hex","alpha","h","x","val","webgl_support","defaultOptions","WorldFacade","__privateAdd","_loadWorld","_loadPhysics","_connectWorld","_makeRoll","_parseGroup","__publicField","_collectionIndex","_groupIndex","_rollIndex","_idIndex","_DiceWorld","_diceWorldPromise","_diceWorldResolve","_DicePhysics","_dicePhysicsPromise","_dicePhysicsResolve","_webgl_support","onBeforeRoll","onDieComplete","onRollComplete","onRemoveComplete","onThemeConfigLoaded","onThemeLoaded","boxOptions","__privateSet","debounceResize","__privateGet","__privateMethod","loadPhysics_fn","loadWorld_fn","result","die","group","collection","collectionId","meshName","rest","returnDie","rollId","groupData","parseGroup_fn","removeCollectionId","connectWorld_fn","theme","basePath","themeData","resp","contentType","error","meshFilePath","target","newDice","themeConfig","newConfig","className","hideClass","_a","notation","themeColor","newStartPoint","__privateWrapper","Collection","parsedNotation","makeRoll_fn","remove","hide","cleanNotation","value","rollArray","input","diceAvailable","verifyObject","object","err","incrementId","key","splitKey","verifyRollId","roll","diceNotation","percentNotation","fudgeNotation","customNotation","modifier","validNumber","n","mod","msg","modParts","basicMod","returnObj","groupCopy","resolve","reject","onInitComplete","WorldOffscreen","module","WorldOnscreen","WorldNone","physicsWorker","e","channel","rolls","hasGroupId","index","loadTheme","diceExtended","materialType","_c","_b","diceExtra","loadExtendedTheme","_d","_f","_e","colorSuffix","color","i","len","dieType","warning","extendedTheme","extendedThemeName","groupId","rollGroup","rollsArray","rollVal","that"],"mappings":"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","debugId":null}}]
}