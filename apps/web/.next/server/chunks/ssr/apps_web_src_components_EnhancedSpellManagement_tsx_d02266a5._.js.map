{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///home/irakli/Projects/RollKeeper/apps/web/src/components/EnhancedSpellManagement.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React, { useState, useMemo } from 'react';\r\nimport { Spell, SpellActionType } from '@/types/character';\r\nimport { useCharacterStore } from '@/store/characterStore';\r\nimport {\r\n  Plus,\r\n  Edit2,\r\n  Trash2,\r\n  Eye,\r\n  BookOpen,\r\n  Search,\r\n  Filter,\r\n  Star,\r\n  ChevronDown,\r\n  ChevronRight,\r\n  Grid3X3,\r\n  List,\r\n  SortAsc,\r\n  SortDesc,\r\n  X,\r\n  Wand2,\r\n} from 'lucide-react';\r\nimport { Button } from '@/components/ui/forms/button';\r\nimport { Badge } from '@/components/ui/layout/badge';\r\nimport { SelectField, SelectItem } from '@/components/ui/forms/select';\r\nimport { Checkbox } from '@/components/ui/forms/checkbox';\r\nimport { Input } from '@/components/ui/forms/input';\r\nimport { Modal } from '@/components/ui/feedback/Modal';\r\nimport SpellDetailsModal from '@/components/ui/game/SpellDetailsModal';\r\nimport { SpellCastModal } from '@/components/ui/game/SpellCastModal';\r\nimport DragDropList from '@/components/ui/layout/DragDropList';\r\nimport { SpellAutocomplete } from '@/components/ui/forms/SpellAutocomplete';\r\nimport { useSpellsData } from '@/hooks/useSpellsData';\r\nimport { convertProcessedSpellToFormData } from '@/utils/spellConversion';\r\nimport { ProcessedSpell } from '@/types/spells';\r\nimport RichTextEditor from '@/components/ui/forms/RichTextEditor';\r\n\r\n// Constants for spell schools and common casting times\r\nconst SPELL_SCHOOLS = [\r\n  'Abjuration',\r\n  'Conjuration',\r\n  'Divination',\r\n  'Enchantment',\r\n  'Evocation',\r\n  'Illusion',\r\n  'Necromancy',\r\n  'Transmutation',\r\n];\r\n\r\nconst CASTING_TIMES = [\r\n  '1 action',\r\n  '1 bonus action',\r\n  '1 reaction',\r\n  '1 minute',\r\n  '10 minutes',\r\n  '1 hour',\r\n  '8 hours',\r\n  '24 hours',\r\n];\r\n\r\nconst RANGES = [\r\n  'Self',\r\n  'Touch',\r\n  '5 feet',\r\n  '10 feet',\r\n  '15 feet',\r\n  '30 feet',\r\n  '60 feet',\r\n  '90 feet',\r\n  '120 feet',\r\n  '150 feet',\r\n  '300 feet',\r\n  '500 feet',\r\n  '1 mile',\r\n  'Sight',\r\n  'Unlimited',\r\n];\r\n\r\nconst DURATIONS = [\r\n  'Instantaneous',\r\n  '1 round',\r\n  '1 minute',\r\n  '10 minutes',\r\n  '1 hour',\r\n  '2 hours',\r\n  '8 hours',\r\n  '24 hours',\r\n  '7 days',\r\n  '10 days',\r\n  '30 days',\r\n  'Until dispelled',\r\n  'Permanent',\r\n];\r\n\r\nconst ACTION_TYPES = [\r\n  { value: '', label: 'No Action Required' },\r\n  { value: 'attack', label: 'Spell Attack' },\r\n  { value: 'save', label: 'Saving Throw' },\r\n  { value: 'utility', label: 'Utility/Other' },\r\n];\r\n\r\nconst SAVING_THROWS = [\r\n  'Strength',\r\n  'Dexterity',\r\n  'Constitution',\r\n  'Intelligence',\r\n  'Wisdom',\r\n  'Charisma',\r\n];\r\n\r\nconst DAMAGE_TYPES = [\r\n  'Acid',\r\n  'Bludgeoning',\r\n  'Cold',\r\n  'Fire',\r\n  'Force',\r\n  'Lightning',\r\n  'Necrotic',\r\n  'Piercing',\r\n  'Poison',\r\n  'Psychic',\r\n  'Radiant',\r\n  'Slashing',\r\n  'Thunder',\r\n];\r\n\r\ninterface SpellFormData {\r\n  name: string;\r\n  level: number;\r\n  school: string;\r\n  castingTime: string;\r\n  range: string;\r\n  components: {\r\n    verbal: boolean;\r\n    somatic: boolean;\r\n    material: boolean;\r\n    materialDescription: string;\r\n  };\r\n  duration: string;\r\n  description: string;\r\n  higherLevel: string;\r\n  ritual: boolean;\r\n  concentration: boolean;\r\n  isPrepared: boolean;\r\n  isAlwaysPrepared: boolean;\r\n  actionType: SpellActionType | '';\r\n  savingThrow: string;\r\n  damage: string;\r\n  damageType: string;\r\n  source: string;\r\n}\r\n\r\ninterface SpellFilters {\r\n  searchQuery: string;\r\n  level: number | 'all';\r\n  school: string | 'all';\r\n  actionType: string | 'all';\r\n  damageType: string | 'all';\r\n  prepared: 'all' | 'prepared' | 'unprepared';\r\n  concentration: 'all' | 'yes' | 'no';\r\n  ritual: 'all' | 'yes' | 'no';\r\n  favorites: boolean;\r\n}\r\n\r\ninterface SpellsByLevel {\r\n  [level: number]: Spell[];\r\n}\r\n\r\nconst initialFormData: SpellFormData = {\r\n  name: '',\r\n  level: 0,\r\n  school: 'Evocation',\r\n  castingTime: '1 action',\r\n  range: 'Touch',\r\n  components: {\r\n    verbal: false,\r\n    somatic: false,\r\n    material: false,\r\n    materialDescription: '',\r\n  },\r\n  duration: 'Instantaneous',\r\n  description: '',\r\n  higherLevel: '',\r\n  ritual: false,\r\n  concentration: false,\r\n  isPrepared: false,\r\n  isAlwaysPrepared: false,\r\n  actionType: '',\r\n  savingThrow: '',\r\n  damage: '',\r\n  damageType: '',\r\n  source: 'PHB',\r\n};\r\n\r\nconst initialFilters: SpellFilters = {\r\n  searchQuery: '',\r\n  level: 'all',\r\n  school: 'all',\r\n  actionType: 'all',\r\n  damageType: 'all',\r\n  prepared: 'all',\r\n  concentration: 'all',\r\n  ritual: 'all',\r\n  favorites: false,\r\n};\r\n\r\nconst SpellCard: React.FC<{\r\n  spell: Spell;\r\n  compact: boolean;\r\n  isFavorite: boolean;\r\n  onEdit: () => void;\r\n  onDelete: () => void;\r\n  onView: () => void;\r\n  onTogglePrepared: () => void;\r\n  onToggleFavorite: () => void;\r\n  onCast: () => void;\r\n}> = ({\r\n  spell,\r\n  compact,\r\n  isFavorite,\r\n  onEdit,\r\n  onDelete,\r\n  onView,\r\n  onTogglePrepared,\r\n  onToggleFavorite,\r\n  onCast,\r\n}) => {\r\n  const isCantrip = spell.level === 0;\r\n\r\n  if (compact) {\r\n    return (\r\n      <div\r\n        className={`flex items-center justify-between rounded-lg border-2 p-3 transition-all hover:shadow-md ${\r\n          spell.isPrepared\r\n            ? 'border-green-300 bg-white'\r\n            : 'border-gray-200 bg-white hover:border-purple-300'\r\n        }`}\r\n      >\r\n        <div className=\"flex min-w-0 flex-1 items-center gap-3\">\r\n          <button\r\n            onClick={onToggleFavorite}\r\n            className={`flex-shrink-0 transition-colors ${\r\n              isFavorite\r\n                ? 'text-yellow-500 hover:text-yellow-600'\r\n                : 'text-gray-400 hover:text-yellow-500'\r\n            }`}\r\n          >\r\n            <Star size={16} fill={isFavorite ? 'currentColor' : 'none'} />\r\n          </button>\r\n\r\n          <div className=\"flex min-w-0 flex-1 items-center gap-2\">\r\n            <span className=\"truncate font-bold text-gray-800\">\r\n              {spell.name}\r\n            </span>\r\n            <Badge\r\n              variant={isCantrip ? 'warning' : 'primary'}\r\n              size=\"sm\"\r\n              className={\r\n                isCantrip\r\n                  ? 'flex-shrink-0 bg-yellow-100 text-yellow-800'\r\n                  : 'flex-shrink-0 bg-purple-100 text-purple-800'\r\n              }\r\n            >\r\n              {isCantrip ? 'Cantrip' : `Lv${spell.level}`}\r\n            </Badge>\r\n            <span className=\"hidden flex-shrink-0 text-xs text-gray-500 sm:inline\">\r\n              {spell.school}\r\n            </span>\r\n          </div>\r\n\r\n          <div className=\"flex flex-shrink-0 items-center gap-1\">\r\n            {spell.concentration && (\r\n              <Badge variant=\"warning\" size=\"sm\">\r\n                C\r\n              </Badge>\r\n            )}\r\n            {spell.ritual && (\r\n              <Badge variant=\"secondary\" size=\"sm\">\r\n                R\r\n              </Badge>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"ml-2 flex flex-shrink-0 items-center gap-1\">\r\n          <Button\r\n            onClick={onCast}\r\n            variant=\"primary\"\r\n            size=\"xs\"\r\n            className=\"bg-purple-600 hover:bg-purple-700\"\r\n            title=\"Cast spell\"\r\n          >\r\n            <Wand2 size={12} />\r\n          </Button>\r\n          <Button\r\n            onClick={onTogglePrepared}\r\n            variant={spell.isPrepared ? 'success' : 'outline'}\r\n            size=\"xs\"\r\n          >\r\n            {spell.isPrepared ? 'Prepared' : 'Prepare'}\r\n          </Button>\r\n          <Button\r\n            onClick={onView}\r\n            variant=\"ghost\"\r\n            size=\"xs\"\r\n            title=\"View details\"\r\n          >\r\n            <Eye size={14} />\r\n          </Button>\r\n          <Button\r\n            onClick={onEdit}\r\n            variant=\"ghost\"\r\n            size=\"xs\"\r\n            title=\"Edit spell\"\r\n            className=\"text-blue-600 hover:bg-blue-50 hover:text-blue-800\"\r\n          >\r\n            <Edit2 size={14} />\r\n          </Button>\r\n          <Button\r\n            onClick={onDelete}\r\n            variant=\"ghost\"\r\n            size=\"xs\"\r\n            title=\"Delete spell\"\r\n            className=\"text-red-600 hover:bg-red-50 hover:text-red-800\"\r\n          >\r\n            <Trash2 size={14} />\r\n          </Button>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div\r\n      className={`rounded-lg border-2 p-4 transition-all hover:shadow-md ${\r\n        spell.isPrepared\r\n          ? 'border-green-300 bg-white'\r\n          : 'border-gray-200 bg-white hover:border-purple-300'\r\n      }`}\r\n    >\r\n      <div className=\"flex items-start justify-between\">\r\n        <div className=\"flex-1\">\r\n          <div className=\"mb-2 flex flex-wrap items-center gap-2\">\r\n            <button\r\n              onClick={onToggleFavorite}\r\n              className={`transition-colors ${\r\n                isFavorite\r\n                  ? 'text-yellow-500 hover:text-yellow-600'\r\n                  : 'text-gray-400 hover:text-yellow-500'\r\n              }`}\r\n            >\r\n              <Star size={18} fill={isFavorite ? 'currentColor' : 'none'} />\r\n            </button>\r\n            <h5 className=\"font-bold text-gray-800\">{spell.name}</h5>\r\n            <Badge\r\n              variant={isCantrip ? 'warning' : 'primary'}\r\n              size=\"sm\"\r\n              className={\r\n                isCantrip\r\n                  ? 'bg-yellow-100 text-yellow-800'\r\n                  : 'bg-purple-100 text-purple-800'\r\n              }\r\n            >\r\n              {isCantrip ? 'Cantrip' : `Level ${spell.level}`}\r\n            </Badge>\r\n            {spell.concentration && (\r\n              <Badge variant=\"warning\" size=\"sm\">\r\n                Concentration\r\n              </Badge>\r\n            )}\r\n            {spell.ritual && (\r\n              <Badge variant=\"secondary\" size=\"sm\">\r\n                Ritual\r\n              </Badge>\r\n            )}\r\n            {spell.isAlwaysPrepared && (\r\n              <Badge variant=\"info\" size=\"sm\">\r\n                Always Prepared\r\n              </Badge>\r\n            )}\r\n          </div>\r\n\r\n          <div className=\"mb-2 flex flex-wrap items-center gap-4 text-sm text-gray-600\">\r\n            <span>\r\n              <strong>School:</strong> {spell.school}\r\n            </span>\r\n            <span>\r\n              <strong>Time:</strong> {spell.castingTime}\r\n            </span>\r\n            <span>\r\n              <strong>Range:</strong> {spell.range}\r\n            </span>\r\n            {spell.duration && (\r\n              <span>\r\n                <strong>Duration:</strong> {spell.duration}\r\n              </span>\r\n            )}\r\n          </div>\r\n\r\n          <div className=\"mb-2 text-sm text-gray-600\">\r\n            <strong>Components:</strong>{' '}\r\n            {[\r\n              spell.components.verbal && 'V',\r\n              spell.components.somatic && 'S',\r\n              spell.components.material && 'M',\r\n            ]\r\n              .filter(Boolean)\r\n              .join(', ')}\r\n            {spell.components.material &&\r\n              spell.components.materialDescription && (\r\n                <span className=\"text-gray-500\">\r\n                  {' '}\r\n                  ({spell.components.materialDescription})\r\n                </span>\r\n              )}\r\n          </div>\r\n\r\n          {spell.damage && (\r\n            <div className=\"mb-2\">\r\n              <Badge variant=\"danger\" size=\"sm\">\r\n                {spell.damage} {spell.damageType}\r\n              </Badge>\r\n            </div>\r\n          )}\r\n\r\n          <div\r\n            className=\"line-clamp-2 text-sm text-gray-700\"\r\n            dangerouslySetInnerHTML={{ __html: spell.description }}\r\n          />\r\n        </div>\r\n\r\n        <div className=\"ml-4 flex flex-col gap-2\">\r\n          <Button\r\n            onClick={onCast}\r\n            variant=\"primary\"\r\n            size=\"sm\"\r\n            leftIcon={<Wand2 size={14} />}\r\n            className=\"bg-gradient-to-r from-purple-600 to-violet-600 hover:from-purple-700 hover:to-violet-700\"\r\n          >\r\n            Cast\r\n          </Button>\r\n\r\n          <Button\r\n            onClick={onTogglePrepared}\r\n            variant={spell.isPrepared ? 'success' : 'outline'}\r\n            size=\"sm\"\r\n          >\r\n            {spell.isPrepared ? 'Prepared' : 'Prepare'}\r\n          </Button>\r\n\r\n          <div className=\"flex gap-1\">\r\n            <Button\r\n              onClick={onView}\r\n              variant=\"outline\"\r\n              size=\"sm\"\r\n              title=\"View details\"\r\n            >\r\n              <Eye size={16} />\r\n            </Button>\r\n            <Button\r\n              onClick={onEdit}\r\n              variant=\"outline\"\r\n              size=\"sm\"\r\n              title=\"Edit spell\"\r\n              className=\"border-blue-300 text-blue-700 hover:bg-blue-50\"\r\n            >\r\n              <Edit2 size={16} />\r\n            </Button>\r\n            <Button\r\n              onClick={onDelete}\r\n              variant=\"outline\"\r\n              size=\"sm\"\r\n              title=\"Delete spell\"\r\n              className=\"border-red-300 text-red-700 hover:bg-red-50\"\r\n            >\r\n              <Trash2 size={16} />\r\n            </Button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst LevelSection: React.FC<{\r\n  level: number;\r\n  spells: Spell[];\r\n  isExpanded: boolean;\r\n  onToggle: () => void;\r\n  compact: boolean;\r\n  favoriteSpells: string[];\r\n  onSpellEdit: (spell: Spell) => void;\r\n  onSpellDelete: (id: string) => void;\r\n  onSpellView: (spell: Spell) => void;\r\n  onTogglePrepared: (id: string) => void;\r\n  onToggleFavorite: (id: string) => void;\r\n  onSpellCast: (spell: Spell) => void;\r\n  onReorder: (sourceIndex: number, destinationIndex: number) => void;\r\n}> = ({\r\n  level,\r\n  spells,\r\n  isExpanded,\r\n  onToggle,\r\n  compact,\r\n  favoriteSpells,\r\n  onSpellEdit,\r\n  onSpellDelete,\r\n  onSpellView,\r\n  onTogglePrepared,\r\n  onToggleFavorite,\r\n  onSpellCast,\r\n  onReorder,\r\n}) => {\r\n  const isCantrip = level === 0;\r\n  const levelName = isCantrip ? 'Cantrips' : `Level ${level}`;\r\n  const levelColor = isCantrip ? 'text-yellow-700' : 'text-purple-700';\r\n  const levelBg = isCantrip\r\n    ? 'bg-gradient-to-r from-yellow-50 to-amber-50'\r\n    : 'bg-gradient-to-r from-purple-50 to-violet-50';\r\n  const borderColor = isCantrip ? 'border-yellow-200' : 'border-purple-200';\r\n  const preparedCount = spells.filter(\r\n    s => s.isPrepared || s.isAlwaysPrepared\r\n  ).length;\r\n\r\n  return (\r\n    <div\r\n      className={`border-2 ${borderColor} overflow-hidden rounded-lg bg-white`}\r\n    >\r\n      <button\r\n        onClick={onToggle}\r\n        className={`flex w-full items-center justify-between p-4 ${levelBg} transition-all hover:opacity-90`}\r\n      >\r\n        <div className=\"flex items-center gap-3\">\r\n          <div className=\"flex items-center gap-2\">\r\n            {isExpanded ? (\r\n              <ChevronDown size={18} className={levelColor} />\r\n            ) : (\r\n              <ChevronRight size={18} className={levelColor} />\r\n            )}\r\n            <span className={`text-base font-bold ${levelColor}`}>\r\n              {levelName}\r\n            </span>\r\n          </div>\r\n          <div className=\"flex items-center gap-2\">\r\n            <Badge\r\n              variant={isCantrip ? 'warning' : 'primary'}\r\n              size=\"sm\"\r\n              className={\r\n                isCantrip\r\n                  ? 'bg-yellow-100 text-yellow-800'\r\n                  : 'bg-purple-100 text-purple-800'\r\n              }\r\n            >\r\n              {spells.length} spell{spells.length !== 1 ? 's' : ''}\r\n            </Badge>\r\n            {preparedCount > 0 && (\r\n              <Badge\r\n                variant=\"success\"\r\n                size=\"sm\"\r\n                className=\"bg-green-100 text-green-800\"\r\n              >\r\n                {preparedCount} prepared\r\n              </Badge>\r\n            )}\r\n          </div>\r\n        </div>\r\n      </button>\r\n\r\n      {isExpanded && (\r\n        <div className=\"border-t-2 border-gray-100 bg-white p-4\">\r\n          <DragDropList\r\n            items={spells}\r\n            onReorder={onReorder}\r\n            keyExtractor={spell => spell.id}\r\n            className={compact ? 'space-y-2' : 'space-y-3'}\r\n            itemClassName=\"\"\r\n            showDragHandle={true}\r\n            dragHandlePosition=\"left\"\r\n            renderItem={spell => (\r\n              <SpellCard\r\n                spell={spell}\r\n                compact={compact}\r\n                isFavorite={favoriteSpells.includes(spell.id)}\r\n                onEdit={() => onSpellEdit(spell)}\r\n                onDelete={() => onSpellDelete(spell.id)}\r\n                onView={() => onSpellView(spell)}\r\n                onTogglePrepared={() => onTogglePrepared(spell.id)}\r\n                onToggleFavorite={() => onToggleFavorite(spell.id)}\r\n                onCast={() => onSpellCast(spell)}\r\n              />\r\n            )}\r\n          />\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport const EnhancedSpellManagement: React.FC = () => {\r\n  const {\r\n    character,\r\n    updateCharacter,\r\n    reorderSpells,\r\n    toggleSpellFavorite,\r\n    updateSpellSlot,\r\n    startConcentration,\r\n    stopConcentration,\r\n  } = useCharacterStore();\r\n  const [isFormOpen, setIsFormOpen] = useState(false);\r\n  const [editingId, setEditingId] = useState<string | null>(null);\r\n  const [formData, setFormData] = useState<SpellFormData>(initialFormData);\r\n  const [viewingSpell, setViewingSpell] = useState<Spell | null>(null);\r\n  const [castModalOpen, setCastModalOpen] = useState(false);\r\n  const [selectedSpell, setSelectedSpell] = useState<Spell | null>(null);\r\n  const [filters, setFilters] = useState<SpellFilters>(initialFilters);\r\n  const [showFilters, setShowFilters] = useState(false);\r\n  const [compactView, setCompactView] = useState(false);\r\n  const [sortBy, setSortBy] = useState<'name' | 'level' | 'school'>('level');\r\n  const [sortOrder, setSortOrder] = useState<'asc' | 'desc'>('asc');\r\n  const [expandedLevels, setExpandedLevels] = useState<Set<number>>(\r\n    new Set([0, 1, 2])\r\n  );\r\n  const [justAutoFilled, setJustAutoFilled] = useState(false);\r\n\r\n  // Load spells from spellbook for autocomplete\r\n  const { spells: spellbookSpells, loading: spellbookLoading } =\r\n    useSpellsData();\r\n\r\n  // Get favorite spells\r\n  const favoriteSpells = useMemo(() => {\r\n    return character.spellbook?.favoriteSpells || [];\r\n  }, [character.spellbook?.favoriteSpells]);\r\n\r\n  // Apply filters and search\r\n  const filteredSpells = useMemo(() => {\r\n    let filtered = character.spells;\r\n\r\n    // Search query\r\n    if (filters.searchQuery.trim()) {\r\n      const query = filters.searchQuery.toLowerCase();\r\n      filtered = filtered.filter(\r\n        spell =>\r\n          spell.name.toLowerCase().includes(query) ||\r\n          spell.school.toLowerCase().includes(query) ||\r\n          spell.description.toLowerCase().includes(query) ||\r\n          spell.damageType?.toLowerCase().includes(query)\r\n      );\r\n    }\r\n\r\n    // Level filter\r\n    if (filters.level !== 'all') {\r\n      filtered = filtered.filter(spell => spell.level === filters.level);\r\n    }\r\n\r\n    // School filter\r\n    if (filters.school !== 'all') {\r\n      filtered = filtered.filter(spell => spell.school === filters.school);\r\n    }\r\n\r\n    // Action type filter\r\n    if (filters.actionType !== 'all') {\r\n      filtered = filtered.filter(\r\n        spell => spell.actionType === filters.actionType\r\n      );\r\n    }\r\n\r\n    // Damage type filter\r\n    if (filters.damageType !== 'all') {\r\n      filtered = filtered.filter(\r\n        spell =>\r\n          spell.damageType?.toLowerCase() === filters.damageType.toLowerCase()\r\n      );\r\n    }\r\n\r\n    // Prepared filter\r\n    if (filters.prepared === 'prepared') {\r\n      filtered = filtered.filter(\r\n        spell => spell.isPrepared || spell.isAlwaysPrepared\r\n      );\r\n    } else if (filters.prepared === 'unprepared') {\r\n      filtered = filtered.filter(\r\n        spell => !spell.isPrepared && !spell.isAlwaysPrepared\r\n      );\r\n    }\r\n\r\n    // Concentration filter\r\n    if (filters.concentration === 'yes') {\r\n      filtered = filtered.filter(spell => spell.concentration);\r\n    } else if (filters.concentration === 'no') {\r\n      filtered = filtered.filter(spell => !spell.concentration);\r\n    }\r\n\r\n    // Ritual filter\r\n    if (filters.ritual === 'yes') {\r\n      filtered = filtered.filter(spell => spell.ritual);\r\n    } else if (filters.ritual === 'no') {\r\n      filtered = filtered.filter(spell => !spell.ritual);\r\n    }\r\n\r\n    // Favorites filter\r\n    if (filters.favorites) {\r\n      filtered = filtered.filter(spell => favoriteSpells.includes(spell.id));\r\n    }\r\n\r\n    return filtered;\r\n  }, [character.spells, filters, favoriteSpells]);\r\n\r\n  // Sort spells\r\n  const sortedSpells = useMemo(() => {\r\n    return [...filteredSpells].sort((a, b) => {\r\n      let comparison = 0;\r\n\r\n      switch (sortBy) {\r\n        case 'name':\r\n          comparison = a.name.localeCompare(b.name);\r\n          break;\r\n        case 'level':\r\n          comparison = a.level - b.level;\r\n          if (comparison === 0) {\r\n            comparison = a.name.localeCompare(b.name);\r\n          }\r\n          break;\r\n        case 'school':\r\n          comparison = a.school.localeCompare(b.school);\r\n          if (comparison === 0) {\r\n            comparison = a.name.localeCompare(b.name);\r\n          }\r\n          break;\r\n      }\r\n\r\n      return sortOrder === 'asc' ? comparison : -comparison;\r\n    });\r\n  }, [filteredSpells, sortBy, sortOrder]);\r\n\r\n  // Group spells by level\r\n  const spellsByLevel = useMemo(() => {\r\n    const grouped: SpellsByLevel = {};\r\n\r\n    sortedSpells.forEach(spell => {\r\n      if (!grouped[spell.level]) {\r\n        grouped[spell.level] = [];\r\n      }\r\n      grouped[spell.level].push(spell);\r\n    });\r\n\r\n    return grouped;\r\n  }, [sortedSpells]);\r\n\r\n  // Handle spell selection from autocomplete\r\n  const handleSpellSelect = (spell: ProcessedSpell) => {\r\n    const converted = convertProcessedSpellToFormData(spell);\r\n    setFormData(converted);\r\n    setJustAutoFilled(true);\r\n\r\n    // Clear the animation flag after 2 seconds\r\n    setTimeout(() => {\r\n      setJustAutoFilled(false);\r\n    }, 2000);\r\n  };\r\n\r\n  const handleSubmit = (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n\r\n    if (!formData.name.trim()) return;\r\n\r\n    const spellData: Omit<Spell, 'id' | 'createdAt' | 'updatedAt'> = {\r\n      ...formData,\r\n      higherLevel: formData.higherLevel || undefined,\r\n      ritual: formData.ritual || undefined,\r\n      concentration: formData.concentration || undefined,\r\n      isPrepared: formData.isPrepared || undefined,\r\n      isAlwaysPrepared: formData.isAlwaysPrepared || undefined,\r\n      actionType: formData.actionType || undefined,\r\n      savingThrow: formData.savingThrow || undefined,\r\n      damage: formData.damage || undefined,\r\n      damageType: formData.damageType || undefined,\r\n      source: formData.source || undefined,\r\n    };\r\n\r\n    if (editingId) {\r\n      const updatedSpells = character.spells.map(spell =>\r\n        spell.id === editingId\r\n          ? { ...spell, ...spellData, updatedAt: new Date().toISOString() }\r\n          : spell\r\n      );\r\n      updateCharacter({ spells: updatedSpells });\r\n    } else {\r\n      const newSpell: Spell = {\r\n        ...spellData,\r\n        id: `spell_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\r\n        createdAt: new Date().toISOString(),\r\n        updatedAt: new Date().toISOString(),\r\n      };\r\n      updateCharacter({ spells: [...character.spells, newSpell] });\r\n    }\r\n\r\n    resetForm();\r\n  };\r\n\r\n  const resetForm = () => {\r\n    setFormData(initialFormData);\r\n    setIsFormOpen(false);\r\n    setEditingId(null);\r\n  };\r\n\r\n  const handleEdit = (spell: Spell) => {\r\n    setFormData({\r\n      name: spell.name,\r\n      level: spell.level,\r\n      school: spell.school,\r\n      castingTime: spell.castingTime,\r\n      range: spell.range,\r\n      components: {\r\n        ...spell.components,\r\n        materialDescription: spell.components.materialDescription || '',\r\n      },\r\n      duration: spell.duration,\r\n      description: spell.description,\r\n      higherLevel: spell.higherLevel || '',\r\n      ritual: spell.ritual || false,\r\n      concentration: spell.concentration || false,\r\n      isPrepared: spell.isPrepared || false,\r\n      isAlwaysPrepared: spell.isAlwaysPrepared || false,\r\n      actionType: spell.actionType || '',\r\n      savingThrow: spell.savingThrow || '',\r\n      damage: spell.damage || '',\r\n      damageType: spell.damageType || '',\r\n      source: spell.source || 'PHB',\r\n    });\r\n    setEditingId(spell.id);\r\n    setIsFormOpen(true);\r\n  };\r\n\r\n  const handleDelete = (id: string) => {\r\n    if (confirm('Are you sure you want to delete this spell?')) {\r\n      const updatedSpells = character.spells.filter(spell => spell.id !== id);\r\n      updateCharacter({ spells: updatedSpells });\r\n    }\r\n  };\r\n\r\n  const handlePreparedToggle = (id: string) => {\r\n    const updatedSpells = character.spells.map(spell =>\r\n      spell.id === id\r\n        ? {\r\n            ...spell,\r\n            isPrepared: !spell.isPrepared,\r\n            updatedAt: new Date().toISOString(),\r\n          }\r\n        : spell\r\n    );\r\n    updateCharacter({ spells: updatedSpells });\r\n  };\r\n\r\n  const handleReorderSpellsInLevel =\r\n    (level: number) => (sourceIndex: number, destinationIndex: number) => {\r\n      const spellsInLevel = spellsByLevel[level];\r\n      const sourceSpellId = spellsInLevel[sourceIndex].id;\r\n      const destinationSpellId = spellsInLevel[destinationIndex].id;\r\n\r\n      const sourceGlobalIndex = character.spells.findIndex(\r\n        spell => spell.id === sourceSpellId\r\n      );\r\n      const destinationGlobalIndex = character.spells.findIndex(\r\n        spell => spell.id === destinationSpellId\r\n      );\r\n\r\n      if (sourceGlobalIndex !== -1 && destinationGlobalIndex !== -1) {\r\n        reorderSpells(sourceGlobalIndex, destinationGlobalIndex);\r\n      }\r\n    };\r\n\r\n  const handleCastSpell = (spell: Spell) => {\r\n    setSelectedSpell(spell);\r\n    setCastModalOpen(true);\r\n  };\r\n\r\n  const handleCastSpellConfirm = (spellLevel: number) => {\r\n    if (!selectedSpell) return;\r\n\r\n    if (selectedSpell.concentration) {\r\n      if (character.concentration.isConcentrating) {\r\n        stopConcentration();\r\n      }\r\n      startConcentration(selectedSpell.name, selectedSpell.id, spellLevel);\r\n    }\r\n\r\n    if (selectedSpell.level > 0) {\r\n      updateSpellSlot(\r\n        spellLevel as keyof typeof character.spellSlots,\r\n        character.spellSlots[spellLevel as keyof typeof character.spellSlots]\r\n          .used + 1\r\n      );\r\n    }\r\n\r\n    setCastModalOpen(false);\r\n    setSelectedSpell(null);\r\n  };\r\n\r\n  const toggleLevelExpanded = (level: number) => {\r\n    const newExpanded = new Set(expandedLevels);\r\n    if (newExpanded.has(level)) {\r\n      newExpanded.delete(level);\r\n    } else {\r\n      newExpanded.add(level);\r\n    }\r\n    setExpandedLevels(newExpanded);\r\n  };\r\n\r\n  const clearFilters = () => {\r\n    setFilters(initialFilters);\r\n  };\r\n\r\n  const activeFilterCount = Object.entries(filters).filter(([key, value]) => {\r\n    if (key === 'searchQuery') return value.trim() !== '';\r\n    if (typeof value === 'boolean') return value;\r\n    return value !== 'all';\r\n  }).length;\r\n\r\n  const sortedLevels = Object.keys(spellsByLevel)\r\n    .map(Number)\r\n    .sort((a, b) => a - b);\r\n\r\n  // Calculate total prepared spells (excluding cantrips)\r\n  const preparedSpellsCount = useMemo(() => {\r\n    return character.spells.filter(\r\n      spell => spell.level > 0 && (spell.isPrepared || spell.isAlwaysPrepared)\r\n    ).length;\r\n  }, [character.spells]);\r\n\r\n  return (\r\n    <div className=\"rounded-lg border border-purple-200 bg-white p-6 shadow\">\r\n      {/* Header */}\r\n      <div className=\"mb-6 flex flex-col gap-4\">\r\n        <div className=\"flex items-center justify-between\">\r\n          <h3 className=\"flex items-center gap-2 text-xl font-bold text-gray-800\">\r\n            <BookOpen className=\"text-purple-600\" size={24} />\r\n            Spells & Cantrips\r\n            <Badge variant=\"secondary\" size=\"sm\">\r\n              {filteredSpells.length} of {character.spells.length}\r\n            </Badge>\r\n            {preparedSpellsCount > 0 && (\r\n              <Badge\r\n                variant=\"success\"\r\n                size=\"sm\"\r\n                className=\"bg-green-100 text-green-800\"\r\n              >\r\n                {preparedSpellsCount} prepared\r\n              </Badge>\r\n            )}\r\n          </h3>\r\n\r\n          <div className=\"flex items-center gap-2\">\r\n            <Button\r\n              onClick={() => setCompactView(!compactView)}\r\n              variant={compactView ? 'primary' : 'ghost'}\r\n              size=\"sm\"\r\n              title={\r\n                compactView\r\n                  ? 'Switch to detailed view'\r\n                  : 'Switch to compact view'\r\n              }\r\n              className={compactView ? 'bg-purple-600 hover:bg-purple-700' : ''}\r\n            >\r\n              {compactView ? <List size={18} /> : <Grid3X3 size={18} />}\r\n            </Button>\r\n\r\n            <Button\r\n              onClick={() => setShowFilters(!showFilters)}\r\n              variant={\r\n                showFilters || activeFilterCount > 0 ? 'primary' : 'ghost'\r\n              }\r\n              size=\"sm\"\r\n              leftIcon={<Filter size={16} />}\r\n              className={\r\n                showFilters || activeFilterCount > 0\r\n                  ? 'bg-purple-600 hover:bg-purple-700'\r\n                  : ''\r\n              }\r\n            >\r\n              Filters\r\n              {activeFilterCount > 0 && (\r\n                <Badge\r\n                  variant=\"danger\"\r\n                  size=\"sm\"\r\n                  className=\"ml-1 bg-red-600 text-white\"\r\n                >\r\n                  {activeFilterCount}\r\n                </Badge>\r\n              )}\r\n            </Button>\r\n\r\n            <Button\r\n              onClick={() => setIsFormOpen(true)}\r\n              variant=\"primary\"\r\n              size=\"sm\"\r\n              leftIcon={<Plus size={16} />}\r\n              className=\"bg-gradient-to-r from-purple-600 to-violet-600 hover:from-purple-700 hover:to-violet-700\"\r\n            >\r\n              Add Spell\r\n            </Button>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Search Bar */}\r\n        <div className=\"relative\">\r\n          <Search className=\"pointer-events-none absolute top-1/2 left-3 h-4 w-4 -translate-y-1/2 text-gray-400\" />\r\n          <Input\r\n            value={filters.searchQuery}\r\n            onChange={e =>\r\n              setFilters(prev => ({ ...prev, searchQuery: e.target.value }))\r\n            }\r\n            placeholder=\"Search spells by name, school, description, or damage type...\"\r\n            className=\"pl-10\"\r\n          />\r\n        </div>\r\n\r\n        {/* Advanced Filters */}\r\n        {showFilters && (\r\n          <div className=\"rounded-lg border-2 border-gray-200 bg-white p-4 shadow-sm\">\r\n            <div className=\"mb-4 flex items-center justify-between\">\r\n              <h4 className=\"font-bold text-gray-800\">Advanced Filters</h4>\r\n              <div className=\"flex items-center gap-2\">\r\n                {activeFilterCount > 0 && (\r\n                  <Button\r\n                    onClick={clearFilters}\r\n                    variant=\"ghost\"\r\n                    size=\"sm\"\r\n                    leftIcon={<X size={14} />}\r\n                  >\r\n                    Clear All\r\n                  </Button>\r\n                )}\r\n                <Button\r\n                  onClick={() => setShowFilters(false)}\r\n                  variant=\"ghost\"\r\n                  size=\"sm\"\r\n                >\r\n                  <X size={16} />\r\n                </Button>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-4\">\r\n              {/* Level Filter */}\r\n              <div>\r\n                <label className=\"mb-2 block text-sm font-medium text-gray-700\">\r\n                  Level\r\n                </label>\r\n                <SelectField\r\n                  value={filters.level.toString()}\r\n                  onValueChange={value =>\r\n                    setFilters(prev => ({\r\n                      ...prev,\r\n                      level: value === 'all' ? 'all' : parseInt(value),\r\n                    }))\r\n                  }\r\n                >\r\n                  <SelectItem value=\"all\">All Levels</SelectItem>\r\n                  <SelectItem value=\"0\">Cantrips</SelectItem>\r\n                  {Array.from({ length: 9 }, (_, i) => (\r\n                    <SelectItem key={i + 1} value={(i + 1).toString()}>\r\n                      Level {i + 1}\r\n                    </SelectItem>\r\n                  ))}\r\n                </SelectField>\r\n              </div>\r\n\r\n              {/* School Filter */}\r\n              <div>\r\n                <label className=\"mb-2 block text-sm font-medium text-gray-700\">\r\n                  School\r\n                </label>\r\n                <SelectField\r\n                  value={filters.school}\r\n                  onValueChange={value =>\r\n                    setFilters(prev => ({ ...prev, school: value }))\r\n                  }\r\n                >\r\n                  <SelectItem value=\"all\">All Schools</SelectItem>\r\n                  {SPELL_SCHOOLS.map(school => (\r\n                    <SelectItem key={school} value={school}>\r\n                      {school}\r\n                    </SelectItem>\r\n                  ))}\r\n                </SelectField>\r\n              </div>\r\n\r\n              {/* Action Type Filter */}\r\n              <div>\r\n                <label className=\"mb-2 block text-sm font-medium text-gray-700\">\r\n                  Action Type\r\n                </label>\r\n                <SelectField\r\n                  value={filters.actionType}\r\n                  onValueChange={value =>\r\n                    setFilters(prev => ({ ...prev, actionType: value }))\r\n                  }\r\n                >\r\n                  <SelectItem value=\"all\">All Types</SelectItem>\r\n                  {ACTION_TYPES.map(type => (\r\n                    <SelectItem\r\n                      key={type.value || 'none'}\r\n                      value={type.value || 'none'}\r\n                    >\r\n                      {type.label}\r\n                    </SelectItem>\r\n                  ))}\r\n                </SelectField>\r\n              </div>\r\n\r\n              {/* Damage Type Filter */}\r\n              <div>\r\n                <label className=\"mb-2 block text-sm font-medium text-gray-700\">\r\n                  Damage Type\r\n                </label>\r\n                <SelectField\r\n                  value={filters.damageType}\r\n                  onValueChange={value =>\r\n                    setFilters(prev => ({ ...prev, damageType: value }))\r\n                  }\r\n                >\r\n                  <SelectItem value=\"all\">All Damage Types</SelectItem>\r\n                  {DAMAGE_TYPES.map(type => (\r\n                    <SelectItem key={type} value={type}>\r\n                      {type}\r\n                    </SelectItem>\r\n                  ))}\r\n                </SelectField>\r\n              </div>\r\n\r\n              {/* Prepared Filter */}\r\n              <div>\r\n                <label className=\"mb-2 block text-sm font-medium text-gray-700\">\r\n                  Preparation\r\n                </label>\r\n                <SelectField\r\n                  value={filters.prepared}\r\n                  onValueChange={value =>\r\n                    setFilters(prev => ({\r\n                      ...prev,\r\n                      prepared: value as 'all' | 'prepared' | 'unprepared',\r\n                    }))\r\n                  }\r\n                >\r\n                  <SelectItem value=\"all\">All Spells</SelectItem>\r\n                  <SelectItem value=\"prepared\">Prepared Only</SelectItem>\r\n                  <SelectItem value=\"unprepared\">Unprepared Only</SelectItem>\r\n                </SelectField>\r\n              </div>\r\n\r\n              {/* Concentration Filter */}\r\n              <div>\r\n                <label className=\"mb-2 block text-sm font-medium text-gray-700\">\r\n                  Concentration\r\n                </label>\r\n                <SelectField\r\n                  value={filters.concentration}\r\n                  onValueChange={value =>\r\n                    setFilters(prev => ({\r\n                      ...prev,\r\n                      concentration: value as 'all' | 'yes' | 'no',\r\n                    }))\r\n                  }\r\n                >\r\n                  <SelectItem value=\"all\">All</SelectItem>\r\n                  <SelectItem value=\"yes\">Concentration</SelectItem>\r\n                  <SelectItem value=\"no\">No Concentration</SelectItem>\r\n                </SelectField>\r\n              </div>\r\n\r\n              {/* Ritual Filter */}\r\n              <div>\r\n                <label className=\"mb-2 block text-sm font-medium text-gray-700\">\r\n                  Ritual\r\n                </label>\r\n                <SelectField\r\n                  value={filters.ritual}\r\n                  onValueChange={value =>\r\n                    setFilters(prev => ({\r\n                      ...prev,\r\n                      ritual: value as 'all' | 'yes' | 'no',\r\n                    }))\r\n                  }\r\n                >\r\n                  <SelectItem value=\"all\">All</SelectItem>\r\n                  <SelectItem value=\"yes\">Ritual</SelectItem>\r\n                  <SelectItem value=\"no\">No Ritual</SelectItem>\r\n                </SelectField>\r\n              </div>\r\n\r\n              {/* Sort Options */}\r\n              <div>\r\n                <label className=\"mb-2 block text-sm font-medium text-gray-700\">\r\n                  Sort By\r\n                </label>\r\n                <div className=\"flex gap-2\">\r\n                  <div className=\"flex-1\">\r\n                    <SelectField\r\n                      value={sortBy}\r\n                      onValueChange={value =>\r\n                        setSortBy(value as 'name' | 'level' | 'school')\r\n                      }\r\n                    >\r\n                      <SelectItem value=\"level\">Level</SelectItem>\r\n                      <SelectItem value=\"name\">Name</SelectItem>\r\n                      <SelectItem value=\"school\">School</SelectItem>\r\n                    </SelectField>\r\n                  </div>\r\n                  <Button\r\n                    onClick={() =>\r\n                      setSortOrder(sortOrder === 'asc' ? 'desc' : 'asc')\r\n                    }\r\n                    variant=\"outline\"\r\n                    size=\"md\"\r\n                    title={`Sort ${sortOrder === 'asc' ? 'descending' : 'ascending'}`}\r\n                  >\r\n                    {sortOrder === 'asc' ? (\r\n                      <SortAsc size={16} />\r\n                    ) : (\r\n                      <SortDesc size={16} />\r\n                    )}\r\n                  </Button>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Favorites Toggle */}\r\n              <div className=\"flex items-end\">\r\n                <label className=\"flex cursor-pointer items-center gap-2\">\r\n                  <Checkbox\r\n                    checked={filters.favorites}\r\n                    onCheckedChange={checked =>\r\n                      setFilters(prev => ({\r\n                        ...prev,\r\n                        favorites: checked as boolean,\r\n                      }))\r\n                    }\r\n                  />\r\n                  <span className=\"flex items-center gap-1 text-sm font-medium text-gray-700\">\r\n                    Favorites Only\r\n                    <Star size={16} className=\"text-yellow-500\" />\r\n                  </span>\r\n                </label>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Spell List */}\r\n      <div className=\"space-y-4\">\r\n        {character.spells.length === 0 ? (\r\n          <div className=\"py-12 text-center text-gray-500\">\r\n            <BookOpen size={64} className=\"mx-auto mb-4 text-gray-400\" />\r\n            <p className=\"text-lg font-medium\">No spells added yet</p>\r\n            <p className=\"mt-2 text-sm\">\r\n              Click &quot;Add Spell&quot; to get started building your spellbook\r\n            </p>\r\n          </div>\r\n        ) : filteredSpells.length === 0 ? (\r\n          <div className=\"py-12 text-center text-gray-500\">\r\n            <Search size={64} className=\"mx-auto mb-4 text-gray-400\" />\r\n            <p className=\"text-lg font-medium\">No spells match your filters</p>\r\n            <p className=\"mt-2 text-sm\">\r\n              Try adjusting your search terms or clearing some filters\r\n            </p>\r\n            {activeFilterCount > 0 && (\r\n              <Button\r\n                onClick={clearFilters}\r\n                variant=\"primary\"\r\n                size=\"md\"\r\n                className=\"mt-4 bg-gradient-to-r from-purple-600 to-violet-600 hover:from-purple-700 hover:to-violet-700\"\r\n              >\r\n                Clear All Filters\r\n              </Button>\r\n            )}\r\n          </div>\r\n        ) : (\r\n          sortedLevels.map(level => (\r\n            <LevelSection\r\n              key={level}\r\n              level={level}\r\n              spells={spellsByLevel[level]}\r\n              isExpanded={expandedLevels.has(level)}\r\n              onToggle={() => toggleLevelExpanded(level)}\r\n              compact={compactView}\r\n              favoriteSpells={favoriteSpells}\r\n              onSpellEdit={handleEdit}\r\n              onSpellDelete={handleDelete}\r\n              onSpellView={setViewingSpell}\r\n              onTogglePrepared={handlePreparedToggle}\r\n              onToggleFavorite={toggleSpellFavorite}\r\n              onSpellCast={handleCastSpell}\r\n              onReorder={handleReorderSpellsInLevel(level)}\r\n            />\r\n          ))\r\n        )}\r\n      </div>\r\n\r\n      {/* Add/Edit Spell Modal */}\r\n      {isFormOpen && (\r\n        <Modal\r\n          isOpen={isFormOpen}\r\n          onClose={resetForm}\r\n          title={editingId ? 'Edit Spell' : 'Add New Spell'}\r\n          size=\"lg\"\r\n          closeOnBackdropClick={true}\r\n        >\r\n          <form onSubmit={handleSubmit} className=\"space-y-6\">\r\n            {/* Spell Autocomplete - Only show when adding new spell */}\r\n            {!editingId && (\r\n              <div className=\"rounded-lg border-2 border-purple-200 bg-purple-50/30 p-4\">\r\n                <SpellAutocomplete\r\n                  spells={spellbookSpells}\r\n                  onSelect={handleSpellSelect}\r\n                  loading={spellbookLoading}\r\n                  placeholder=\"Search spells from spellbook database...\"\r\n                />\r\n              </div>\r\n            )}\r\n\r\n            {/* Auto-fill success message */}\r\n            {justAutoFilled && (\r\n              <div className=\"animate-in fade-in slide-in-from-top-2 rounded-lg border-2 border-green-300 bg-green-50 p-3 duration-300\">\r\n                <div className=\"flex items-center gap-2 text-green-800\">\r\n                  <Wand2 className=\"h-5 w-5\" />\r\n                  <p className=\"text-sm font-medium\">\r\n                    âœ¨ Spell details loaded! Review and adjust as needed.\r\n                  </p>\r\n                </div>\r\n              </div>\r\n            )}\r\n\r\n            {/* Section: Basic Information */}\r\n            <div className=\"space-y-4\">\r\n              <h4 className=\"border-b-2 border-gray-200 pb-2 text-sm font-bold tracking-wide text-gray-800 uppercase\">\r\n                Basic Information\r\n              </h4>\r\n\r\n              <div className=\"grid grid-cols-1 gap-4 md:grid-cols-2\">\r\n                <Input\r\n                  label=\"Spell Name\"\r\n                  value={formData.name}\r\n                  onChange={e =>\r\n                    setFormData(prev => ({ ...prev, name: e.target.value }))\r\n                  }\r\n                  required\r\n                  placeholder=\"Enter spell name\"\r\n                />\r\n\r\n                <div>\r\n                  <label className=\"mb-2 block text-sm font-medium text-gray-700\">\r\n                    Level\r\n                  </label>\r\n                  <SelectField\r\n                    value={formData.level.toString()}\r\n                    onValueChange={value =>\r\n                      setFormData(prev => ({ ...prev, level: parseInt(value) }))\r\n                    }\r\n                  >\r\n                    <SelectItem value=\"0\">Cantrip</SelectItem>\r\n                    {Array.from({ length: 9 }, (_, i) => (\r\n                      <SelectItem key={i + 1} value={(i + 1).toString()}>\r\n                        Level {i + 1}\r\n                      </SelectItem>\r\n                    ))}\r\n                  </SelectField>\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"grid grid-cols-1 gap-4 md:grid-cols-2\">\r\n                <div>\r\n                  <label className=\"mb-2 block text-sm font-medium text-gray-700\">\r\n                    School\r\n                  </label>\r\n                  <SelectField\r\n                    value={formData.school}\r\n                    onValueChange={value =>\r\n                      setFormData(prev => ({ ...prev, school: value }))\r\n                    }\r\n                  >\r\n                    {SPELL_SCHOOLS.map(school => (\r\n                      <SelectItem key={school} value={school}>\r\n                        {school}\r\n                      </SelectItem>\r\n                    ))}\r\n                  </SelectField>\r\n                </div>\r\n\r\n                <Input\r\n                  label=\"Source\"\r\n                  value={formData.source}\r\n                  onChange={e =>\r\n                    setFormData(prev => ({ ...prev, source: e.target.value }))\r\n                  }\r\n                  placeholder=\"e.g., PHB, XGE, TCE\"\r\n                />\r\n              </div>\r\n            </div>\r\n\r\n            {/* Section: Casting Details */}\r\n            <div className=\"space-y-4\">\r\n              <h4 className=\"border-b-2 border-gray-200 pb-2 text-sm font-bold tracking-wide text-gray-800 uppercase\">\r\n                Casting Details\r\n              </h4>\r\n\r\n              <div className=\"grid grid-cols-1 gap-4 md:grid-cols-3\">\r\n                <div>\r\n                  <label className=\"mb-2 block text-sm font-medium text-gray-700\">\r\n                    Casting Time\r\n                  </label>\r\n                  <SelectField\r\n                    value={formData.castingTime}\r\n                    onValueChange={value =>\r\n                      setFormData(prev => ({ ...prev, castingTime: value }))\r\n                    }\r\n                  >\r\n                    {CASTING_TIMES.map(time => (\r\n                      <SelectItem key={time} value={time}>\r\n                        {time}\r\n                      </SelectItem>\r\n                    ))}\r\n                  </SelectField>\r\n                </div>\r\n\r\n                <div>\r\n                  <label className=\"mb-2 block text-sm font-medium text-gray-700\">\r\n                    Range\r\n                  </label>\r\n                  <SelectField\r\n                    value={formData.range}\r\n                    onValueChange={value =>\r\n                      setFormData(prev => ({ ...prev, range: value }))\r\n                    }\r\n                  >\r\n                    {RANGES.map(range => (\r\n                      <SelectItem key={range} value={range}>\r\n                        {range}\r\n                      </SelectItem>\r\n                    ))}\r\n                  </SelectField>\r\n                </div>\r\n\r\n                <div>\r\n                  <label className=\"mb-2 block text-sm font-medium text-gray-700\">\r\n                    Duration\r\n                  </label>\r\n                  <SelectField\r\n                    value={formData.duration}\r\n                    onValueChange={value =>\r\n                      setFormData(prev => ({ ...prev, duration: value }))\r\n                    }\r\n                  >\r\n                    {DURATIONS.map(duration => (\r\n                      <SelectItem key={duration} value={duration}>\r\n                        {duration}\r\n                      </SelectItem>\r\n                    ))}\r\n                  </SelectField>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Section: Components */}\r\n            <div className=\"space-y-4\">\r\n              <h4 className=\"border-b-2 border-gray-200 pb-2 text-sm font-bold tracking-wide text-gray-800 uppercase\">\r\n                Components\r\n              </h4>\r\n\r\n              <div className=\"flex flex-wrap gap-4\">\r\n                <label className=\"flex cursor-pointer items-center gap-2\">\r\n                  <Checkbox\r\n                    checked={formData.components.verbal}\r\n                    onCheckedChange={checked =>\r\n                      setFormData(prev => ({\r\n                        ...prev,\r\n                        components: {\r\n                          ...prev.components,\r\n                          verbal: checked as boolean,\r\n                        },\r\n                      }))\r\n                    }\r\n                  />\r\n                  <span className=\"text-sm font-medium text-gray-800\">\r\n                    Verbal (V)\r\n                  </span>\r\n                </label>\r\n\r\n                <label className=\"flex cursor-pointer items-center gap-2\">\r\n                  <Checkbox\r\n                    checked={formData.components.somatic}\r\n                    onCheckedChange={checked =>\r\n                      setFormData(prev => ({\r\n                        ...prev,\r\n                        components: {\r\n                          ...prev.components,\r\n                          somatic: checked as boolean,\r\n                        },\r\n                      }))\r\n                    }\r\n                  />\r\n                  <span className=\"text-sm font-medium text-gray-800\">\r\n                    Somatic (S)\r\n                  </span>\r\n                </label>\r\n\r\n                <label className=\"flex cursor-pointer items-center gap-2\">\r\n                  <Checkbox\r\n                    checked={formData.components.material}\r\n                    onCheckedChange={checked =>\r\n                      setFormData(prev => ({\r\n                        ...prev,\r\n                        components: {\r\n                          ...prev.components,\r\n                          material: checked as boolean,\r\n                        },\r\n                      }))\r\n                    }\r\n                  />\r\n                  <span className=\"text-sm font-medium text-gray-800\">\r\n                    Material (M)\r\n                  </span>\r\n                </label>\r\n              </div>\r\n\r\n              {formData.components.material && (\r\n                <Input\r\n                  label=\"Material Component Description\"\r\n                  value={formData.components.materialDescription}\r\n                  onChange={e =>\r\n                    setFormData(prev => ({\r\n                      ...prev,\r\n                      components: {\r\n                        ...prev.components,\r\n                        materialDescription: e.target.value,\r\n                      },\r\n                    }))\r\n                  }\r\n                  placeholder=\"Describe the material components...\"\r\n                />\r\n              )}\r\n            </div>\r\n\r\n            {/* Section: Spell Properties */}\r\n            <div className=\"space-y-4\">\r\n              <h4 className=\"border-b-2 border-gray-200 pb-2 text-sm font-bold tracking-wide text-gray-800 uppercase\">\r\n                Spell Properties\r\n              </h4>\r\n\r\n              <div className=\"flex flex-wrap gap-4\">\r\n                <label className=\"flex cursor-pointer items-center gap-2\">\r\n                  <Checkbox\r\n                    checked={formData.ritual}\r\n                    onCheckedChange={checked =>\r\n                      setFormData(prev => ({\r\n                        ...prev,\r\n                        ritual: checked as boolean,\r\n                      }))\r\n                    }\r\n                  />\r\n                  <span className=\"text-sm font-medium text-gray-800\">\r\n                    Ritual\r\n                  </span>\r\n                </label>\r\n\r\n                <label className=\"flex cursor-pointer items-center gap-2\">\r\n                  <Checkbox\r\n                    checked={formData.concentration}\r\n                    onCheckedChange={checked =>\r\n                      setFormData(prev => ({\r\n                        ...prev,\r\n                        concentration: checked as boolean,\r\n                      }))\r\n                    }\r\n                  />\r\n                  <span className=\"text-sm font-medium text-gray-800\">\r\n                    Concentration\r\n                  </span>\r\n                </label>\r\n\r\n                <label className=\"flex cursor-pointer items-center gap-2\">\r\n                  <Checkbox\r\n                    checked={formData.isPrepared}\r\n                    onCheckedChange={checked =>\r\n                      setFormData(prev => ({\r\n                        ...prev,\r\n                        isPrepared: checked as boolean,\r\n                      }))\r\n                    }\r\n                  />\r\n                  <span className=\"text-sm font-medium text-gray-800\">\r\n                    Prepared\r\n                  </span>\r\n                </label>\r\n\r\n                <label className=\"flex cursor-pointer items-center gap-2\">\r\n                  <Checkbox\r\n                    checked={formData.isAlwaysPrepared}\r\n                    onCheckedChange={checked =>\r\n                      setFormData(prev => ({\r\n                        ...prev,\r\n                        isAlwaysPrepared: checked as boolean,\r\n                      }))\r\n                    }\r\n                  />\r\n                  <span className=\"text-sm font-medium text-gray-800\">\r\n                    Always Prepared\r\n                  </span>\r\n                </label>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Section: Description */}\r\n            <div className=\"space-y-4\">\r\n              <h4 className=\"border-b-2 border-gray-200 pb-2 text-sm font-bold tracking-wide text-gray-800 uppercase\">\r\n                Description\r\n              </h4>\r\n\r\n              <div>\r\n                <label className=\"mb-2 block text-sm font-medium text-gray-700\">\r\n                  Spell Description *\r\n                </label>\r\n                <RichTextEditor\r\n                  content={formData.description}\r\n                  onChange={content =>\r\n                    setFormData(prev => ({\r\n                      ...prev,\r\n                      description: content,\r\n                    }))\r\n                  }\r\n                  placeholder=\"Describe what the spell does...\"\r\n                  minHeight=\"150px\"\r\n                />\r\n              </div>\r\n\r\n              <div>\r\n                <label className=\"mb-2 block text-sm font-medium text-gray-700\">\r\n                  At Higher Levels\r\n                </label>\r\n                <RichTextEditor\r\n                  content={formData.higherLevel}\r\n                  onChange={content =>\r\n                    setFormData(prev => ({\r\n                      ...prev,\r\n                      higherLevel: content,\r\n                    }))\r\n                  }\r\n                  placeholder=\"Describe what happens when cast at higher levels...\"\r\n                  minHeight=\"100px\"\r\n                />\r\n              </div>\r\n            </div>\r\n\r\n            {/* Section: Combat Details */}\r\n            <div className=\"space-y-4\">\r\n              <h4 className=\"border-b-2 border-gray-200 pb-2 text-sm font-bold tracking-wide text-gray-800 uppercase\">\r\n                Combat Details\r\n              </h4>\r\n\r\n              <div className=\"grid grid-cols-1 gap-4 md:grid-cols-2\">\r\n                <div>\r\n                  <label className=\"mb-2 block text-sm font-medium text-gray-700\">\r\n                    Action Type\r\n                  </label>\r\n                  <SelectField\r\n                    value={formData.actionType}\r\n                    onValueChange={value =>\r\n                      setFormData(prev => ({\r\n                        ...prev,\r\n                        actionType: value as SpellActionType | '',\r\n                      }))\r\n                    }\r\n                  >\r\n                    {ACTION_TYPES.map(type => (\r\n                      <SelectItem\r\n                        key={type.value || 'none'}\r\n                        value={type.value || 'none'}\r\n                      >\r\n                        {type.label}\r\n                      </SelectItem>\r\n                    ))}\r\n                  </SelectField>\r\n                </div>\r\n\r\n                {formData.actionType === 'save' && (\r\n                  <div>\r\n                    <label className=\"mb-2 block text-sm font-medium text-gray-700\">\r\n                      Saving Throw\r\n                    </label>\r\n                    <SelectField\r\n                      value={formData.savingThrow || '__none__'}\r\n                      onValueChange={value =>\r\n                        setFormData(prev => ({\r\n                          ...prev,\r\n                          savingThrow: value === '__none__' ? '' : value,\r\n                        }))\r\n                      }\r\n                    >\r\n                      <SelectItem value=\"__none__\" disabled>\r\n                        Select...\r\n                      </SelectItem>\r\n                      {SAVING_THROWS.map(save => (\r\n                        <SelectItem key={save} value={save}>\r\n                          {save}\r\n                        </SelectItem>\r\n                      ))}\r\n                    </SelectField>\r\n                  </div>\r\n                )}\r\n              </div>\r\n\r\n              <div className=\"grid grid-cols-1 gap-4 md:grid-cols-2\">\r\n                <Input\r\n                  label=\"Damage Dice\"\r\n                  value={formData.damage}\r\n                  onChange={e =>\r\n                    setFormData(prev => ({ ...prev, damage: e.target.value }))\r\n                  }\r\n                  placeholder=\"e.g., 1d8, 3d6\"\r\n                />\r\n\r\n                {formData.damage && (\r\n                  <div>\r\n                    <label className=\"mb-2 block text-sm font-medium text-gray-700\">\r\n                      Damage Type\r\n                    </label>\r\n                    <SelectField\r\n                      value={formData.damageType || '__none__'}\r\n                      onValueChange={value =>\r\n                        setFormData(prev => ({\r\n                          ...prev,\r\n                          damageType: value === '__none__' ? '' : value,\r\n                        }))\r\n                      }\r\n                    >\r\n                      <SelectItem value=\"__none__\" disabled>\r\n                        Select...\r\n                      </SelectItem>\r\n                      {DAMAGE_TYPES.map(type => (\r\n                        <SelectItem key={type} value={type}>\r\n                          {type}\r\n                        </SelectItem>\r\n                      ))}\r\n                    </SelectField>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n\r\n            {/* Form Actions */}\r\n            <div className=\"flex justify-end gap-3 border-t-2 border-gray-200 pt-4\">\r\n              <Button\r\n                type=\"button\"\r\n                onClick={resetForm}\r\n                variant=\"outline\"\r\n                size=\"md\"\r\n              >\r\n                Cancel\r\n              </Button>\r\n              <Button\r\n                type=\"submit\"\r\n                variant=\"primary\"\r\n                size=\"md\"\r\n                className=\"bg-gradient-to-r from-purple-600 to-violet-600 hover:from-purple-700 hover:to-violet-700\"\r\n              >\r\n                {editingId ? 'Update Spell' : 'Add Spell'}\r\n              </Button>\r\n            </div>\r\n          </form>\r\n        </Modal>\r\n      )}\r\n\r\n      {/* View Spell Modal - Using unified SpellDetailsModal */}\r\n      {viewingSpell && (\r\n        <SpellDetailsModal\r\n          spell={viewingSpell}\r\n          isOpen={true}\r\n          onClose={() => setViewingSpell(null)}\r\n          isFavorite={favoriteSpells.includes(viewingSpell.id)}\r\n          onToggleFavorite={() => toggleSpellFavorite(viewingSpell.id)}\r\n          onCast={() => handleCastSpell(viewingSpell)}\r\n        />\r\n      )}\r\n\r\n      {/* Spell Cast Modal */}\r\n      {selectedSpell && (\r\n        <SpellCastModal\r\n          isOpen={castModalOpen}\r\n          onClose={() => {\r\n            setCastModalOpen(false);\r\n            setSelectedSpell(null);\r\n          }}\r\n          spell={selectedSpell}\r\n          spellSlots={character.spellSlots}\r\n          concentration={character.concentration}\r\n          onCastSpell={handleCastSpellConfirm}\r\n        />\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n"],"names":[],"mappings":";;;;;AAEA;AAEA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAkBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AApCA;;;;;;;;;;;;;;;;;;AAsCA,uDAAuD;AACvD,MAAM,gBAAgB;IACpB;IACA;IACA;IACA;IACA;IACA;IACA;IACA;CACD;AAED,MAAM,gBAAgB;IACpB;IACA;IACA;IACA;IACA;IACA;IACA;IACA;CACD;AAED,MAAM,SAAS;IACb;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;CACD;AAED,MAAM,YAAY;IAChB;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;CACD;AAED,MAAM,eAAe;IACnB;QAAE,OAAO;QAAI,OAAO;IAAqB;IACzC;QAAE,OAAO;QAAU,OAAO;IAAe;IACzC;QAAE,OAAO;QAAQ,OAAO;IAAe;IACvC;QAAE,OAAO;QAAW,OAAO;IAAgB;CAC5C;AAED,MAAM,gBAAgB;IACpB;IACA;IACA;IACA;IACA;IACA;CACD;AAED,MAAM,eAAe;IACnB;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;CACD;AA4CD,MAAM,kBAAiC;IACrC,MAAM;IACN,OAAO;IACP,QAAQ;IACR,aAAa;IACb,OAAO;IACP,YAAY;QACV,QAAQ;QACR,SAAS;QACT,UAAU;QACV,qBAAqB;IACvB;IACA,UAAU;IACV,aAAa;IACb,aAAa;IACb,QAAQ;IACR,eAAe;IACf,YAAY;IACZ,kBAAkB;IAClB,YAAY;IACZ,aAAa;IACb,QAAQ;IACR,YAAY;IACZ,QAAQ;AACV;AAEA,MAAM,iBAA+B;IACnC,aAAa;IACb,OAAO;IACP,QAAQ;IACR,YAAY;IACZ,YAAY;IACZ,UAAU;IACV,eAAe;IACf,QAAQ;IACR,WAAW;AACb;AAEA,MAAM,YAUD,CAAC,EACJ,KAAK,EACL,OAAO,E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","debugId":null}}]
}