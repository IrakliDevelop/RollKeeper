{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///home/irakli/Projects/RollKeeper/apps/web/src/components/ui/character/SpellSlotTracker.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React from 'react';\r\nimport { SpellSlots, PactMagic } from '@/types/character';\r\nimport { SpellSlotTracker as SharedSpellSlotTracker } from '@/components/shared/spells';\r\n\r\ninterface SpellSlotTrackerProps {\r\n  spellSlots: SpellSlots;\r\n  pactMagic?: PactMagic;\r\n  onSpellSlotChange: (level: keyof SpellSlots, used: number) => void;\r\n  onPactMagicChange?: (used: number) => void;\r\n  onResetSpellSlots: () => void;\r\n  onResetPactMagic?: () => void;\r\n  className?: string;\r\n}\r\n\r\nexport default function SpellSlotTracker({\r\n  spellSlots,\r\n  pactMagic,\r\n  onSpellSlotChange,\r\n  onPactMagicChange,\r\n  onResetSpellSlots,\r\n  onResetPactMagic,\r\n  className = '',\r\n}: SpellSlotTrackerProps) {\r\n  // Use the shared SpellSlotTracker component with full functionality\r\n  return (\r\n    <SharedSpellSlotTracker\r\n      spellSlots={spellSlots}\r\n      pactMagic={pactMagic}\r\n      onSpellSlotChange={onSpellSlotChange}\r\n      onPactMagicChange={onPactMagicChange}\r\n      onResetSpellSlots={onResetSpellSlots}\r\n      onResetPactMagic={onResetPactMagic}\r\n      readonly={false}\r\n      compact={false}\r\n      hideControls={false}\r\n      hideResetButtons={false}\r\n      showOnlyUsed={false}\r\n      maxLevelToShow={9}\r\n      className={className}\r\n    />\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AAIA;AAAA;AAJA;;;AAgBe,SAAS,iBAAiB,EACvC,UAAU,EACV,SAAS,EACT,iBAAiB,EACjB,iBAAiB,EACjB,iBAAiB,EACjB,gBAAgB,EAChB,YAAY,EAAE,EACQ;IACtB,oEAAoE;IACpE,qBACE,8OAAC,6LAAsB;QACrB,YAAY;QACZ,WAAW;QACX,mBAAmB;QACnB,mBAAmB;QACnB,mBAAmB;QACnB,kBAAkB;QAClB,UAAU;QACV,SAAS;QACT,cAAc;QACd,kBAAkB;QAClB,cAAc;QACd,gBAAgB;QAChB,WAAW;;;;;;AAGjB","debugId":null}},
    {"offset": {"line": 40, "column": 0}, "map": {"version":3,"sources":["file:///home/irakli/Projects/RollKeeper/apps/web/src/components/ui/character/ExtendedFeatures/FeatureModal.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React, { useState, useEffect } from 'react';\r\nimport {\r\n  ExtendedFeature,\r\n  FeatureSourceType,\r\n  FEATURE_SOURCE_LABELS,\r\n} from '@/types/character';\r\nimport { calculateTraitMaxUses } from '@/utils/calculations';\r\nimport {\r\n  Edit3,\r\n  Save,\r\n  Trash2,\r\n  Zap,\r\n  Clock,\r\n  Settings,\r\n  AlertTriangle,\r\n} from 'lucide-react';\r\nimport { Modal } from '@/components/ui/feedback';\r\n\r\ninterface FeatureModalProps {\r\n  feature: ExtendedFeature;\r\n  isOpen: boolean;\r\n  mode: 'view' | 'edit';\r\n  characterLevel: number;\r\n  onClose: () => void;\r\n  onUpdate: (updates: Partial<ExtendedFeature>) => void;\r\n  onDelete: () => void;\r\n  onUse: () => void;\r\n  readonly?: boolean;\r\n}\r\n\r\nexport default function FeatureModal({\r\n  feature,\r\n  isOpen,\r\n  mode: initialMode,\r\n  characterLevel,\r\n  onClose,\r\n  onUpdate,\r\n  onDelete,\r\n  onUse,\r\n  readonly = false,\r\n}: FeatureModalProps) {\r\n  const [mode, setMode] = useState<'view' | 'edit'>(initialMode);\r\n  const [editData, setEditData] = useState<Partial<ExtendedFeature>>({});\r\n  const [showDeleteConfirm, setShowDeleteConfirm] = useState(false);\r\n\r\n  const maxUses = calculateTraitMaxUses(feature, characterLevel);\r\n  const usesRemaining = maxUses - feature.usedUses;\r\n  const isExhausted = !feature.isPassive && usesRemaining <= 0;\r\n  const hasUses = !feature.isPassive && maxUses > 0;\r\n\r\n  // Reset edit data when modal opens or feature changes\r\n  useEffect(() => {\r\n    if (isOpen) {\r\n      setMode(initialMode);\r\n      setEditData({\r\n        name: feature.name,\r\n        description: feature.description || '',\r\n        sourceType: feature.sourceType,\r\n        sourceDetail: feature.sourceDetail || '',\r\n        category: feature.category || '',\r\n        maxUses: feature.maxUses,\r\n        restType: feature.restType,\r\n        isPassive: feature.isPassive || false,\r\n        scaleWithProficiency: feature.scaleWithProficiency || false,\r\n        proficiencyMultiplier: feature.proficiencyMultiplier || 1,\r\n      });\r\n      setShowDeleteConfirm(false);\r\n    }\r\n  }, [feature, isOpen, initialMode]);\r\n\r\n  const handleSave = () => {\r\n    if (!editData.name?.trim()) return;\r\n\r\n    onUpdate({\r\n      name: editData.name.trim(),\r\n      description: editData.description?.trim() || undefined,\r\n      sourceType: editData.sourceType || feature.sourceType,\r\n      sourceDetail: editData.sourceDetail?.trim() || undefined,\r\n      category: editData.category?.trim() || undefined,\r\n      maxUses: editData.maxUses || 0,\r\n      restType: editData.restType || 'long',\r\n      isPassive: editData.isPassive || false,\r\n      scaleWithProficiency: editData.scaleWithProficiency || false,\r\n      proficiencyMultiplier: editData.scaleWithProficiency\r\n        ? editData.proficiencyMultiplier || 1\r\n        : undefined,\r\n    });\r\n    setMode('view');\r\n    onClose();\r\n  };\r\n\r\n  const handleCancel = () => {\r\n    setMode('view');\r\n    setEditData({\r\n      name: feature.name,\r\n      description: feature.description || '',\r\n      sourceType: feature.sourceType,\r\n      sourceDetail: feature.sourceDetail || '',\r\n      category: feature.category || '',\r\n      maxUses: feature.maxUses,\r\n      restType: feature.restType,\r\n      isPassive: feature.isPassive || false,\r\n      scaleWithProficiency: feature.scaleWithProficiency || false,\r\n      proficiencyMultiplier: feature.proficiencyMultiplier || 1,\r\n    });\r\n  };\r\n\r\n  const handleDelete = () => {\r\n    onDelete();\r\n    onClose();\r\n  };\r\n\r\n  return (\r\n    <Modal\r\n      isOpen={isOpen}\r\n      onClose={onClose}\r\n      title={mode === 'edit' ? 'Edit Feature' : feature.name}\r\n      size=\"lg\"\r\n    >\r\n      <div className=\"space-y-8\">\r\n        {/* Header Actions */}\r\n        <div className=\"mb-2 flex items-center justify-between border-b border-gray-200 pb-8\">\r\n          <div className=\"flex items-center gap-3\">\r\n            <span className=\"rounded-lg bg-indigo-100 px-3 py-1.5 text-sm font-semibold text-indigo-800\">\r\n              {FEATURE_SOURCE_LABELS[feature.sourceType]}\r\n            </span>\r\n            {feature.sourceDetail && (\r\n              <span className=\"rounded bg-gray-100 px-2 py-1 text-sm font-medium text-gray-600\">\r\n                {feature.sourceDetail}\r\n              </span>\r\n            )}\r\n          </div>\r\n\r\n          {!readonly && mode === 'view' && (\r\n            <div className=\"flex gap-3\">\r\n              {hasUses && !isExhausted && (\r\n                <button\r\n                  onClick={onUse}\r\n                  className=\"flex items-center gap-2 rounded-lg bg-indigo-600 px-4 py-2 text-sm font-medium text-white shadow-sm transition-colors hover:bg-indigo-700 focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 focus:outline-none\"\r\n                >\r\n                  <Zap className=\"h-4 w-4\" />\r\n                  Use Feature\r\n                </button>\r\n              )}\r\n              <button\r\n                onClick={() => setMode('edit')}\r\n                className=\"flex items-center gap-2 rounded-lg bg-blue-600 px-4 py-2 text-sm font-medium text-white shadow-sm transition-colors hover:bg-blue-700 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 focus:outline-none\"\r\n              >\r\n                <Edit3 className=\"h-4 w-4\" />\r\n                Edit\r\n              </button>\r\n              <button\r\n                onClick={() => setShowDeleteConfirm(true)}\r\n                className=\"flex items-center gap-2 rounded-lg bg-red-600 px-4 py-2 text-sm font-medium text-white shadow-sm transition-colors hover:bg-red-700 focus:ring-2 focus:ring-red-500 focus:ring-offset-2 focus:outline-none\"\r\n              >\r\n                <Trash2 className=\"h-4 w-4\" />\r\n                Delete\r\n              </button>\r\n            </div>\r\n          )}\r\n\r\n          {mode === 'edit' && (\r\n            <div className=\"flex gap-3\">\r\n              <button\r\n                onClick={handleCancel}\r\n                className=\"rounded-lg border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 shadow-sm transition-colors hover:bg-gray-50 focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 focus:outline-none\"\r\n              >\r\n                Cancel\r\n              </button>\r\n              <button\r\n                onClick={handleSave}\r\n                disabled={!editData.name?.trim()}\r\n                className=\"flex items-center gap-2 rounded-lg bg-green-600 px-4 py-2 text-sm font-medium text-white shadow-sm transition-colors hover:bg-green-700 focus:ring-2 focus:ring-green-500 focus:ring-offset-2 focus:outline-none disabled:cursor-not-allowed disabled:opacity-50\"\r\n              >\r\n                <Save className=\"h-4 w-4\" />\r\n                Save Changes\r\n              </button>\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* Content */}\r\n        {mode === 'view' ? (\r\n          <div className=\"mt-4 space-y-8\">\r\n            {/* Usage Info */}\r\n            <div className=\"rounded-xl border border-blue-200 bg-gradient-to-br from-blue-50 to-indigo-50 p-6\">\r\n              <div className=\"flex items-center justify-between\">\r\n                <div>\r\n                  <h4 className=\"mb-2 text-lg font-semibold text-gray-900\">\r\n                    Usage Information\r\n                  </h4>\r\n                  {feature.isPassive ? (\r\n                    <div className=\"flex items-center gap-2\">\r\n                      <div className=\"h-2 w-2 rounded-full bg-blue-500\"></div>\r\n                      <p className=\"text-sm font-medium text-blue-700\">\r\n                        Passive ability - always active\r\n                      </p>\r\n                    </div>\r\n                  ) : hasUses ? (\r\n                    <div className=\"flex items-center gap-2\">\r\n                      <div\r\n                        className={`h-2 w-2 rounded-full ${isExhausted ? 'bg-red-500' : usesRemaining <= 1 ? 'bg-orange-500' : 'bg-green-500'}`}\r\n                      ></div>\r\n                      <p className=\"text-sm font-medium text-gray-700\">\r\n                        <span\r\n                          className={`${isExhausted ? 'text-red-600' : usesRemaining <= 1 ? 'text-orange-600' : 'text-green-600'}`}\r\n                        >\r\n                          {usesRemaining}\r\n                        </span>{' '}\r\n                        of {maxUses} uses remaining\r\n                      </p>\r\n                    </div>\r\n                  ) : (\r\n                    <div className=\"flex items-center gap-2\">\r\n                      <div className=\"h-2 w-2 rounded-full bg-green-500\"></div>\r\n                      <p className=\"text-sm font-medium text-green-700\">\r\n                        Unlimited uses\r\n                      </p>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n                {hasUses && (\r\n                  <div className=\"flex items-center gap-2 rounded-lg border bg-white px-3 py-2 text-sm font-medium text-gray-600\">\r\n                    <Clock className=\"h-4 w-4\" />\r\n                    <span className=\"capitalize\">{feature.restType} rest</span>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n\r\n            {/* Description */}\r\n            {feature.description && (\r\n              <div className=\"rounded-lg border border-gray-200 bg-white p-6\">\r\n                <h4 className=\"mb-4 text-lg font-semibold text-gray-900\">\r\n                  Description\r\n                </h4>\r\n                <div\r\n                  className=\"prose prose-sm max-w-none leading-relaxed text-gray-700\"\r\n                  dangerouslySetInnerHTML={{ __html: feature.description }}\r\n                />\r\n              </div>\r\n            )}\r\n\r\n            {/* Additional Info */}\r\n            {(feature.scaleWithProficiency || feature.category) && (\r\n              <div className=\"rounded-lg border border-gray-200 bg-gray-50 p-6\">\r\n                <h4 className=\"mb-4 text-lg font-semibold text-gray-900\">\r\n                  Additional Details\r\n                </h4>\r\n                <div className=\"grid grid-cols-1 gap-4 sm:grid-cols-2\">\r\n                  {feature.scaleWithProficiency && (\r\n                    <div className=\"flex items-center gap-3 rounded-lg border bg-white p-3\">\r\n                      <div className=\"h-2 w-2 flex-shrink-0 rounded-full bg-purple-500\"></div>\r\n                      <div>\r\n                        <span className=\"text-sm font-medium text-gray-700\">\r\n                          Scaling:\r\n                        </span>\r\n                        <span className=\"ml-2 text-sm text-gray-600\">\r\n                          Proficiency Ã— {feature.proficiencyMultiplier || 1}\r\n                        </span>\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n                  {feature.category && (\r\n                    <div className=\"flex items-center gap-3 rounded-lg border bg-white p-3\">\r\n                      <div className=\"h-2 w-2 flex-shrink-0 rounded-full bg-green-500\"></div>\r\n                      <div>\r\n                        <span className=\"text-sm font-medium text-gray-700\">\r\n                          Category:\r\n                        </span>\r\n                        <span className=\"ml-2 text-sm text-gray-600\">\r\n                          {feature.category}\r\n                        </span>\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            )}\r\n          </div>\r\n        ) : (\r\n          <div className=\"mt-4 space-y-8\">\r\n            {/* Edit Form */}\r\n            <div className=\"rounded-lg border border-gray-200 bg-white p-6\">\r\n              <h4 className=\"mb-6 text-lg font-semibold text-gray-900\">\r\n                Basic Information\r\n              </h4>\r\n\r\n              <div className=\"space-y-4\">\r\n                <div>\r\n                  <label className=\"mb-2 block text-sm font-semibold text-gray-700\">\r\n                    Feature Name *\r\n                  </label>\r\n                  <input\r\n                    type=\"text\"\r\n                    value={editData.name || ''}\r\n                    onChange={e =>\r\n                      setEditData({ ...editData, name: e.target.value })\r\n                    }\r\n                    className=\"w-full rounded-lg border border-gray-300 px-4 py-3 text-sm transition-colors focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200\"\r\n                    placeholder=\"e.g., Action Surge, Darkvision, Lucky\"\r\n                  />\r\n                </div>\r\n\r\n                <div className=\"grid grid-cols-1 gap-4 sm:grid-cols-2\">\r\n                  <div>\r\n                    <label className=\"mb-2 block text-sm font-semibold text-gray-700\">\r\n                      Source Type\r\n                    </label>\r\n                    <select\r\n                      value={editData.sourceType || feature.sourceType}\r\n                      onChange={e =>\r\n                        setEditData({\r\n                          ...editData,\r\n                          sourceType: e.target.value as FeatureSourceType,\r\n                        })\r\n                      }\r\n                      className=\"w-full rounded-lg border border-gray-300 px-4 py-3 text-sm transition-colors focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200\"\r\n                    >\r\n                      {Object.entries(FEATURE_SOURCE_LABELS).map(\r\n                        ([value, label]) => (\r\n                          <option key={value} value={value}>\r\n                            {label}\r\n                          </option>\r\n                        )\r\n                      )}\r\n                    </select>\r\n                  </div>\r\n\r\n                  <div>\r\n                    <label className=\"mb-2 block text-sm font-semibold text-gray-700\">\r\n                      Source Detail\r\n                    </label>\r\n                    <input\r\n                      type=\"text\"\r\n                      value={editData.sourceDetail || ''}\r\n                      onChange={e =>\r\n                        setEditData({\r\n                          ...editData,\r\n                          sourceDetail: e.target.value,\r\n                        })\r\n                      }\r\n                      className=\"w-full rounded-lg border border-gray-300 px-4 py-3 text-sm transition-colors focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200\"\r\n                      placeholder=\"e.g., Fighter Level 2, Hill Dwarf\"\r\n                    />\r\n                  </div>\r\n                </div>\r\n\r\n                <div>\r\n                  <label className=\"mb-2 block text-sm font-semibold text-gray-700\">\r\n                    Description\r\n                  </label>\r\n                  <textarea\r\n                    value={editData.description || ''}\r\n                    onChange={e =>\r\n                      setEditData({ ...editData, description: e.target.value })\r\n                    }\r\n                    rows={4}\r\n                    className=\"w-full resize-none rounded-lg border border-gray-300 px-4 py-3 text-sm transition-colors focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200\"\r\n                    placeholder=\"Describe what this feature does, how it works, and any important details...\"\r\n                  />\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Usage Configuration */}\r\n            <div className=\"rounded-lg border border-gray-200 bg-gray-50 p-6\">\r\n              <h4 className=\"mb-6 flex items-center gap-2 text-lg font-semibold text-gray-900\">\r\n                <Settings className=\"h-5 w-5 text-gray-600\" />\r\n                Usage Configuration\r\n              </h4>\r\n\r\n              <div className=\"space-y-6\">\r\n                <label className=\"flex cursor-pointer items-start gap-3 rounded-lg border border-gray-200 bg-white p-4 transition-colors hover:bg-gray-50\">\r\n                  <input\r\n                    type=\"checkbox\"\r\n                    checked={editData.isPassive || false}\r\n                    onChange={e =>\r\n                      setEditData({ ...editData, isPassive: e.target.checked })\r\n                    }\r\n                    className=\"mt-0.5 rounded border-gray-300 focus:ring-indigo-500\"\r\n                  />\r\n                  <div>\r\n                    <span className=\"text-sm font-medium text-gray-900\">\r\n                      Passive ability\r\n                    </span>\r\n                    <p className=\"mt-1 text-xs text-gray-600\">\r\n                      This feature is always active and doesn&apos;t require\r\n                      usage tracking\r\n                    </p>\r\n                  </div>\r\n                </label>\r\n\r\n                {!editData.isPassive && (\r\n                  <div className=\"rounded-lg border border-gray-200 bg-white p-4\">\r\n                    <div className=\"space-y-4\">\r\n                      <div className=\"grid grid-cols-1 gap-4 sm:grid-cols-2\">\r\n                        <div>\r\n                          <label className=\"mb-2 block text-sm font-semibold text-gray-700\">\r\n                            Maximum Uses\r\n                          </label>\r\n                          <input\r\n                            type=\"number\"\r\n                            min=\"0\"\r\n                            value={editData.maxUses || 0}\r\n                            onChange={e =>\r\n                              setEditData({\r\n                                ...editData,\r\n                                maxUses: parseInt(e.target.value) || 0,\r\n                              })\r\n                            }\r\n                            className=\"w-full rounded-lg border border-gray-300 px-3 py-2 text-sm transition-colors focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200\"\r\n                          />\r\n                          <p className=\"mt-1 text-xs text-gray-500\">\r\n                            Set to 0 for unlimited uses\r\n                          </p>\r\n                        </div>\r\n\r\n                        <div>\r\n                          <label className=\"mb-2 block text-sm font-semibold text-gray-700\">\r\n                            Recharges On\r\n                          </label>\r\n                          <select\r\n                            value={editData.restType || 'long'}\r\n                            onChange={e =>\r\n                              setEditData({\r\n                                ...editData,\r\n                                restType: e.target.value as 'short' | 'long',\r\n                              })\r\n                            }\r\n                            className=\"w-full rounded-lg border border-gray-300 px-3 py-2 text-sm transition-colors focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200\"\r\n                          >\r\n                            <option value=\"short\">Short Rest</option>\r\n                            <option value=\"long\">Long Rest</option>\r\n                          </select>\r\n                        </div>\r\n                      </div>\r\n\r\n                      <div className=\"border-t border-gray-200 pt-4\">\r\n                        <label className=\"flex cursor-pointer items-start gap-3\">\r\n                          <input\r\n                            type=\"checkbox\"\r\n                            checked={editData.scaleWithProficiency || false}\r\n                            onChange={e =>\r\n                              setEditData({\r\n                                ...editData,\r\n                                scaleWithProficiency: e.target.checked,\r\n                              })\r\n                            }\r\n                            className=\"mt-0.5 rounded border-gray-300 focus:ring-indigo-500\"\r\n                          />\r\n                          <div className=\"flex-1\">\r\n                            <span className=\"text-sm font-medium text-gray-900\">\r\n                              Scale with proficiency bonus\r\n                            </span>\r\n                            <p className=\"mt-1 text-xs text-gray-600\">\r\n                              Maximum uses increase with character level\r\n                            </p>\r\n                          </div>\r\n                        </label>\r\n\r\n                        {editData.scaleWithProficiency && (\r\n                          <div className=\"mt-3 ml-6\">\r\n                            <label className=\"mb-2 block text-sm font-semibold text-gray-700\">\r\n                              Proficiency Multiplier\r\n                            </label>\r\n                            <input\r\n                              type=\"number\"\r\n                              min=\"0.5\"\r\n                              step=\"0.5\"\r\n                              value={editData.proficiencyMultiplier || 1}\r\n                              onChange={e =>\r\n                                setEditData({\r\n                                  ...editData,\r\n                                  proficiencyMultiplier:\r\n                                    parseFloat(e.target.value) || 1,\r\n                                })\r\n                              }\r\n                              className=\"w-32 rounded-lg border border-gray-300 px-3 py-2 text-sm transition-colors focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200\"\r\n                              placeholder=\"1.0\"\r\n                            />\r\n                            <p className=\"mt-1 text-xs text-gray-500\">\r\n                              Max uses = base uses + (proficiency Ã— multiplier)\r\n                            </p>\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Delete Confirmation */}\r\n        {showDeleteConfirm && (\r\n          <div className=\"rounded-lg border-2 border-red-200 bg-red-50 p-6\">\r\n            <div className=\"flex items-start gap-4\">\r\n              <div className=\"flex-shrink-0\">\r\n                <AlertTriangle className=\"h-6 w-6 text-red-600\" />\r\n              </div>\r\n              <div className=\"flex-1\">\r\n                <h4 className=\"mb-2 text-lg font-semibold text-red-900\">\r\n                  Delete this feature?\r\n                </h4>\r\n                <p className=\"mb-4 text-sm text-red-700\">\r\n                  This action cannot be undone. The feature &quot;{feature.name}\r\n                  &quot; will be permanently removed from both the extended\r\n                  features and special traits sections.\r\n                </p>\r\n                <div className=\"flex gap-3\">\r\n                  <button\r\n                    onClick={handleDelete}\r\n                    className=\"flex items-center gap-2 rounded-lg bg-red-600 px-4 py-2 text-sm font-medium text-white shadow-sm transition-colors hover:bg-red-700 focus:ring-2 focus:ring-red-500 focus:ring-offset-2 focus:outline-none\"\r\n                  >\r\n                    <Trash2 className=\"h-4 w-4\" />\r\n                    Delete Feature\r\n                  </button>\r\n                  <button\r\n                    onClick={() => setShowDeleteConfirm(false)}\r\n                    className=\"rounded-lg border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 shadow-sm transition-colors hover:bg-gray-50 focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 focus:outline-none\"\r\n                  >\r\n                    Cancel\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </Modal>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1127, "column": 0}, "map": {"version":3,"sources":["file:///home/irakli/Projects/RollKeeper/apps/web/src/components/ui/character/TraitTracker.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React, { useState } from 'react';\r\nimport { TrackableTrait, ExtendedFeature } from '@/types/character';\r\nimport { TraitTracker as SharedTraitTracker } from '@/components/shared/character';\r\nimport FeatureModal from '@/components/ui/character/ExtendedFeatures/FeatureModal';\r\n\r\ntype TraitType = TrackableTrait | ExtendedFeature;\r\n\r\ninterface TraitTrackerProps<T extends TraitType = TrackableTrait> {\r\n  traits: T[];\r\n  characterLevel: number;\r\n  onUpdateTrait: (id: string, updates: Partial<T>) => void;\r\n  onDeleteTrait: (id: string) => void;\r\n  onUseTrait: (id: string) => void;\r\n  onResetTraits: (restType: 'short' | 'long') => void;\r\n  className?: string;\r\n  // Display options\r\n  readonly?: boolean;\r\n  hideControls?: boolean;\r\n  enableViewModal?: boolean; // New prop to enable click-to-view functionality\r\n}\r\n\r\nexport default function TraitTracker<T extends TraitType = TrackableTrait>({\r\n  traits,\r\n  characterLevel,\r\n  onUpdateTrait,\r\n  onDeleteTrait,\r\n  onUseTrait,\r\n  onResetTraits,\r\n  className = '',\r\n  readonly = false,\r\n  hideControls = false,\r\n  enableViewModal = false,\r\n}: TraitTrackerProps<T>) {\r\n  const [viewingTrait, setViewingTrait] = useState<T | null>(null);\r\n\r\n  const handleModalClose = () => {\r\n    setViewingTrait(null);\r\n  };\r\n\r\n  const handleModalUpdate = (updates: Partial<ExtendedFeature>) => {\r\n    if (viewingTrait) {\r\n      onUpdateTrait(viewingTrait.id, updates as Partial<T>);\r\n      setViewingTrait({ ...viewingTrait, ...updates } as T);\r\n    }\r\n  };\r\n\r\n  const handleModalDelete = () => {\r\n    if (viewingTrait) {\r\n      onDeleteTrait(viewingTrait.id);\r\n      setViewingTrait(null);\r\n    }\r\n  };\r\n\r\n  const handleModalUse = () => {\r\n    if (viewingTrait) {\r\n      onUseTrait(viewingTrait.id);\r\n    }\r\n  };\r\n\r\n  // Check if trait is an ExtendedFeature (has sourceType property)\r\n  const isExtendedFeature = (trait: TraitType): trait is ExtendedFeature => {\r\n    return 'sourceType' in trait;\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <SharedTraitTracker\r\n          traits={traits as TrackableTrait[]}\r\n          characterLevel={characterLevel}\r\n          onUpdateTrait={onUpdateTrait as (id: string, updates: Partial<TrackableTrait>) => void}\r\n          onDeleteTrait={onDeleteTrait}\r\n          onUseTrait={onUseTrait}\r\n          onResetTraits={onResetTraits}\r\n          onTraitClick={enableViewModal ? (trait) => setViewingTrait(trait as T) : undefined}\r\n          readonly={readonly}\r\n          compact={false}\r\n          hideControls={hideControls}\r\n          showOnlyUsed={false}\r\n          className={className}\r\n        />\r\n      {enableViewModal && viewingTrait && isExtendedFeature(viewingTrait) && (\r\n        <FeatureModal\r\n          feature={viewingTrait}\r\n          isOpen={true}\r\n          mode=\"view\"\r\n          characterLevel={characterLevel}\r\n          onClose={handleModalClose}\r\n          onUpdate={handleModalUpdate}\r\n          onDelete={handleModalDelete}\r\n          onUse={handleModalUse}\r\n          readonly={hideControls} // If controls are hidden, make modal readonly too\r\n        />\r\n      )}\r\n    </>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AAEA;AAAA;AACA;AALA;;;;;AAuBe,SAAS,aAAmD,EACzE,MAAM,EACN,cAAc,EACd,aAAa,EACb,aAAa,EACb,UAAU,EACV,aAAa,EACb,YAAY,EAAE,EACd,WAAW,KAAK,EAChB,eAAe,KAAK,EACpB,kBAAkB,KAAK,EACF;IACrB,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,iNAAQ,EAAW;IAE3D,MAAM,mBAAmB;QACvB,gBAAgB;IAClB;IAEA,MAAM,oBAAoB,CAAC;QACzB,IAAI,cAAc;YAChB,cAAc,aAAa,EAAE,EAAE;YAC/B,gBAAgB;gBAAE,GAAG,YAAY;gBAAE,GAAG,OAAO;YAAC;QAChD;IACF;IAEA,MAAM,oBAAoB;QACxB,IAAI,cAAc;YAChB,cAAc,aAAa,EAAE;YAC7B,gBAAgB;QAClB;IACF;IAEA,MAAM,iBAAiB;QACrB,IAAI,cAAc;YAChB,WAAW,aAAa,EAAE;QAC5B;IACF;IAEA,iEAAiE;IACjE,MAAM,oBAAoB,CAAC;QACzB,OAAO,gBAAgB;IACzB;IAEA,qBACE;;0BACE,8OAAC,wLAAkB;gBACf,QAAQ;gBACR,gBAAgB;gBAChB,eAAe;gBACf,eAAe;gBACf,YAAY;gBACZ,eAAe;gBACf,cAAc,kBAAkB,CAAC,QAAU,gBAAgB,SAAc;gBACzE,UAAU;gBACV,SAAS;gBACT,cAAc;gBACd,cAAc;gBACd,WAAW;;;;;;YAEd,mBAAmB,gBAAgB,kBAAkB,+BACpD,8OAAC,mMAAY;gBACX,SAAS;gBACT,QAAQ;gBACR,MAAK;gBACL,gBAAgB;gBAChB,SAAS;gBACT,UAAU;gBACV,UAAU;gBACV,OAAO;gBACP,UAAU;;;;;;;;AAKpB","debugId":null}},
    {"offset": {"line": 1212, "column": 0}, "map": {"version":3,"sources":["file:///home/irakli/Projects/RollKeeper/apps/web/src/components/ui/character/HeroicInspirationTracker.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React from 'react';\r\nimport { HeroicInspiration } from '@/types/character';\r\nimport { HeroicInspirationTracker as SharedHeroicInspirationTracker } from '@/components/shared/character';\r\n\r\ninterface HeroicInspirationTrackerProps {\r\n  inspiration: HeroicInspiration;\r\n  onUpdateInspiration: (updates: Partial<HeroicInspiration>) => void;\r\n  onAddInspiration: (amount?: number) => void;\r\n  onUseInspiration: () => void;\r\n  onResetInspiration: () => void;\r\n  className?: string;\r\n}\r\n\r\nexport default function HeroicInspirationTracker({\r\n  inspiration,\r\n  onUpdateInspiration,\r\n  onAddInspiration,\r\n  onUseInspiration,\r\n  onResetInspiration,\r\n  className = '',\r\n}: HeroicInspirationTrackerProps) {\r\n  // Use the shared HeroicInspirationTracker component with full functionality\r\n  return (\r\n    <SharedHeroicInspirationTracker\r\n      inspiration={inspiration}\r\n      onUpdateInspiration={onUpdateInspiration}\r\n      onAddInspiration={onAddInspiration}\r\n      onUseInspiration={onUseInspiration}\r\n      onResetInspiration={onResetInspiration}\r\n      readonly={false}\r\n      compact={false}\r\n      hideControls={false}\r\n      hideSettings={false}\r\n      hideHelperText={false}\r\n      className={className}\r\n    />\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AAIA;AAAA;AAJA;;;AAee,SAAS,yBAAyB,EAC/C,WAAW,EACX,mBAAmB,EACnB,gBAAgB,EAChB,gBAAgB,EAChB,kBAAkB,EAClB,YAAY,EAAE,EACgB;IAC9B,4EAA4E;IAC5E,qBACE,8OAAC,gNAA8B;QAC7B,aAAa;QACb,qBAAqB;QACrB,kBAAkB;QAClB,kBAAkB;QAClB,oBAAoB;QACpB,UAAU;QACV,SAAS;QACT,cAAc;QACd,cAAc;QACd,gBAAgB;QAChB,WAAW;;;;;;AAGjB","debugId":null}},
    {"offset": {"line": 1246, "column": 0}, "map": {"version":3,"sources":["file:///home/irakli/Projects/RollKeeper/apps/web/src/components/ui/character/XPTracker.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React from 'react';\r\nimport { XPTracker as SharedXPTracker } from '@/components/shared/character';\r\n\r\ninterface XPTrackerProps {\r\n  currentXP: number;\r\n  currentLevel: number;\r\n  onAddXP: (xpToAdd: number) => void;\r\n  onSetXP: (newXP: number) => void;\r\n  className?: string;\r\n}\r\n\r\nexport default function XPTracker({\r\n  currentXP,\r\n  currentLevel,\r\n  onAddXP,\r\n  onSetXP,\r\n  className = '',\r\n}: XPTrackerProps) {\r\n  // Use the shared XPTracker component with full functionality\r\n  return (\r\n    <SharedXPTracker\r\n      currentXP={currentXP}\r\n      currentLevel={currentLevel}\r\n      onAddXP={onAddXP}\r\n      onSetXP={onSetXP}\r\n      readonly={false}\r\n      compact={false}\r\n      hideControls={false}\r\n      hideProgressBar={false}\r\n      hideLevelUpAlert={false}\r\n      hideThresholds={false}\r\n      className={className}\r\n    />\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AAGA;AAAA;AAHA;;;AAae,SAAS,UAAU,EAChC,SAAS,EACT,YAAY,EACZ,OAAO,EACP,OAAO,EACP,YAAY,EAAE,EACC;IACf,6DAA6D;IAC7D,qBACE,8OAAC,kLAAe;QACd,WAAW;QACX,cAAc;QACd,SAAS;QACT,SAAS;QACT,UAAU;QACV,SAAS;QACT,cAAc;QACd,iBAAiB;QACjB,kBAAkB;QAClB,gBAAgB;QAChB,WAAW;;;;;;AAGjB","debugId":null}},
    {"offset": {"line": 1280, "column": 0}, "map": {"version":3,"sources":["file:///home/irakli/Projects/RollKeeper/apps/web/src/components/ui/character/HitPointManager.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React from 'react';\r\nimport { HitPoints, ClassInfo } from '@/types/character';\r\nimport { HitPointTracker } from '@/components/shared/combat';\r\n\r\ninterface HitPointManagerProps {\r\n  hitPoints: HitPoints;\r\n  classInfo: ClassInfo;\r\n  level: number;\r\n  constitutionScore: number;\r\n  onApplyDamage: (damage: number) => void;\r\n  onApplyHealing: (healing: number) => void;\r\n  onAddTemporaryHP: (tempHP: number) => void;\r\n  onMakeDeathSave: (isSuccess: boolean, isCritical?: boolean) => void;\r\n  onResetDeathSaves: () => void;\r\n  onToggleCalculationMode: () => void;\r\n  onRecalculateMaxHP: () => void;\r\n  onUpdateHitPoints: (updates: Partial<HitPoints>) => void;\r\n  className?: string;\r\n}\r\n\r\nexport default function HitPointManager({\r\n  hitPoints,\r\n  classInfo,\r\n  level,\r\n  constitutionScore,\r\n  onApplyDamage,\r\n  onApplyHealing,\r\n  onAddTemporaryHP,\r\n  onMakeDeathSave,\r\n  onResetDeathSaves,\r\n  onToggleCalculationMode,\r\n  onRecalculateMaxHP,\r\n  onUpdateHitPoints,\r\n  className = '',\r\n}: HitPointManagerProps) {\r\n  // Use the shared HitPointTracker component with full functionality\r\n  return (\r\n    <HitPointTracker\r\n      hitPoints={hitPoints}\r\n      classInfo={classInfo}\r\n      level={level}\r\n      constitutionScore={constitutionScore}\r\n      onApplyDamage={onApplyDamage}\r\n      onApplyHealing={onApplyHealing}\r\n      onAddTemporaryHP={onAddTemporaryHP}\r\n      onMakeDeathSave={onMakeDeathSave}\r\n      onResetDeathSaves={onResetDeathSaves}\r\n      onToggleCalculationMode={onToggleCalculationMode}\r\n      onRecalculateMaxHP={onRecalculateMaxHP}\r\n      onUpdateHitPoints={onUpdateHitPoints}\r\n      readonly={false}\r\n      compact={false}\r\n      showControls={true}\r\n      showDeathSaves={true}\r\n      showCalculationInfo={true}\r\n      hideLabels={false}\r\n      className={className}\r\n    />\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AAIA;AAAA;AAJA;;;AAsBe,SAAS,gBAAgB,EACtC,SAAS,EACT,SAAS,EACT,KAAK,EACL,iBAAiB,EACjB,aAAa,EACb,cAAc,EACd,gBAAgB,EAChB,eAAe,EACf,iBAAiB,EACjB,uBAAuB,EACvB,kBAAkB,EAClB,iBAAiB,EACjB,YAAY,EAAE,EACO;IACrB,mEAAmE;IACnE,qBACE,8OAAC,2LAAe;QACd,WAAW;QACX,WAAW;QACX,OAAO;QACP,mBAAmB;QACnB,eAAe;QACf,gBAAgB;QAChB,kBAAkB;QAClB,iBAAiB;QACjB,mBAAmB;QACnB,yBAAyB;QACzB,oBAAoB;QACpB,mBAAmB;QACnB,UAAU;QACV,SAAS;QACT,cAAc;QACd,gBAAgB;QAChB,qBAAqB;QACrB,YAAY;QACZ,WAAW;;;;;;AAGjB","debugId":null}},
    {"offset": {"line": 1322, "column": 0}, "map": {"version":3,"sources":["file:///home/irakli/Projects/RollKeeper/apps/web/src/components/ui/character/AvatarUpload.tsx"],"sourcesContent":["/**\r\n * Avatar Upload Component\r\n *\r\n * Allows users to upload and display character avatars.\r\n * Images are converted to base64 and stored in character data.\r\n */\r\n\r\n'use client';\r\n\r\nimport React, { useRef, useState } from 'react';\r\nimport Image from 'next/image';\r\nimport { Upload, X, User } from 'lucide-react';\r\nimport { Button } from '@/components/ui/forms';\r\nimport { cn } from '@/utils/cn';\r\nimport { MAX_AVATAR_SIZE_MB, MAX_AVATAR_SIZE_BYTES } from '@/utils/constants';\r\n\r\nexport interface AvatarUploadProps {\r\n  avatar?: string; // S3 URL or base64 encoded image (for backwards compatibility)\r\n  characterId: string; // Required for S3 uploads\r\n  characterName: string;\r\n  onAvatarChange: (avatar: string | undefined) => void;\r\n  size?: 'sm' | 'md' | 'lg' | 'xl';\r\n  editable?: boolean;\r\n  className?: string;\r\n}\r\n\r\nconst sizeClasses = {\r\n  sm: 'h-16 w-16',\r\n  md: 'h-24 w-24',\r\n  lg: 'h-32 w-32',\r\n  xl: 'h-48 w-48',\r\n};\r\n\r\nconst iconSizeClasses = {\r\n  sm: 16,\r\n  md: 24,\r\n  lg: 32,\r\n  xl: 48,\r\n};\r\n\r\nexport function AvatarUpload({\r\n  avatar,\r\n  characterId,\r\n  characterName,\r\n  onAvatarChange,\r\n  size = 'md',\r\n  editable = true,\r\n  className,\r\n}: AvatarUploadProps) {\r\n  const fileInputRef = useRef<HTMLInputElement>(null);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  const handleFileSelect = async (\r\n    event: React.ChangeEvent<HTMLInputElement>\r\n  ) => {\r\n    const file = event.target.files?.[0];\r\n    console.log('ðŸ” File selected:', file);\r\n\r\n    if (!file) {\r\n      console.log('âŒ No file selected');\r\n      return;\r\n    }\r\n\r\n    // Validate file type\r\n    if (!file.type.startsWith('image/')) {\r\n      console.log('âŒ Invalid file type:', file.type);\r\n      setError('Please select an image file');\r\n      return;\r\n    }\r\n\r\n    // Validate file size\r\n    if (file.size > MAX_AVATAR_SIZE_BYTES) {\r\n      console.log('âŒ File too large:', file.size, 'bytes');\r\n      setError(`Image must be smaller than ${MAX_AVATAR_SIZE_MB}MB`);\r\n      return;\r\n    }\r\n\r\n    console.log('âœ… File validation passed, uploading to S3...');\r\n    setIsLoading(true);\r\n    setError(null);\r\n\r\n    try {\r\n      // Create form data\r\n      const formData = new FormData();\r\n      formData.append('file', file);\r\n      formData.append('characterId', characterId);\r\n\r\n      // Upload to S3 via API route\r\n      const response = await fetch('/api/avatar/upload', {\r\n        method: 'POST',\r\n        body: formData,\r\n      });\r\n\r\n      if (!response.ok) {\r\n        const errorData = await response.json();\r\n        throw new Error(errorData.error || 'Upload failed');\r\n      }\r\n\r\n      const { url } = await response.json();\r\n      console.log('âœ… Upload successful! URL:', url);\r\n\r\n      // Delete old avatar from S3 if it exists and is an S3 URL\r\n      if (avatar && avatar.includes('s3.amazonaws.com')) {\r\n        console.log('ðŸ—‘ï¸ Deleting old avatar from S3...');\r\n        await fetch(`/api/avatar/delete?url=${encodeURIComponent(avatar)}`, {\r\n          method: 'DELETE',\r\n        });\r\n      }\r\n\r\n      onAvatarChange(url);\r\n      setIsLoading(false);\r\n    } catch (err) {\r\n      console.log('âŒ Upload error:', err);\r\n      setError(err instanceof Error ? err.message : 'Failed to upload avatar');\r\n      setIsLoading(false);\r\n    }\r\n\r\n    // Reset input\r\n    event.target.value = '';\r\n  };\r\n\r\n  const handleRemoveAvatar = async () => {\r\n    // Delete from S3 if it's an S3 URL\r\n    if (avatar && avatar.includes('s3.amazonaws.com')) {\r\n      console.log('ðŸ—‘ï¸ Deleting avatar from S3...');\r\n      try {\r\n        await fetch(`/api/avatar/delete?url=${encodeURIComponent(avatar)}`, {\r\n          method: 'DELETE',\r\n        });\r\n        console.log('âœ… Avatar deleted from S3');\r\n      } catch (err) {\r\n        console.log('âš ï¸ Failed to delete from S3:', err);\r\n      }\r\n    }\r\n\r\n    onAvatarChange(undefined);\r\n    setError(null);\r\n  };\r\n\r\n  const handleUploadClick = () => {\r\n    fileInputRef.current?.click();\r\n  };\r\n\r\n  return (\r\n    <div className={cn('flex flex-col items-center gap-3', className)}>\r\n      <div className=\"relative\">\r\n        {/* Avatar Display */}\r\n        <div\r\n          className={cn(\r\n            'relative overflow-hidden rounded-full border-2 border-gray-300 bg-gradient-to-br from-slate-100 to-slate-200',\r\n            sizeClasses[size],\r\n            editable &&\r\n              'cursor-pointer transition-colors hover:border-blue-400',\r\n            isLoading && 'opacity-50'\r\n          )}\r\n          onClick={editable ? handleUploadClick : undefined}\r\n        >\r\n          {avatar ? (\r\n            <Image\r\n              src={avatar}\r\n              alt={`${characterName} avatar`}\r\n              fill\r\n              className=\"object-cover\"\r\n              sizes=\"(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 33vw\"\r\n            />\r\n          ) : (\r\n            <div className=\"flex h-full w-full items-center justify-center\">\r\n              <User size={iconSizeClasses[size]} className=\"text-slate-400\" />\r\n            </div>\r\n          )}\r\n\r\n          {isLoading && (\r\n            <div className=\"absolute inset-0 flex items-center justify-center bg-black/20\">\r\n              <div className=\"h-8 w-8 animate-spin rounded-full border-4 border-white border-t-transparent\" />\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* Remove Button (only show if avatar exists and is editable) */}\r\n        {avatar && editable && !isLoading && (\r\n          <button\r\n            onClick={e => {\r\n              e.stopPropagation();\r\n              handleRemoveAvatar();\r\n            }}\r\n            className=\"absolute -top-1 -right-1 rounded-full bg-red-500 p-1 text-white shadow-lg transition-colors hover:bg-red-600\"\r\n            title=\"Remove avatar\"\r\n          >\r\n            <X size={16} />\r\n          </button>\r\n        )}\r\n      </div>\r\n\r\n      {/* Upload Button (only show if editable) */}\r\n      {editable && (\r\n        <>\r\n          <input\r\n            ref={fileInputRef}\r\n            type=\"file\"\r\n            accept=\"image/*\"\r\n            onChange={handleFileSelect}\r\n            className=\"hidden\"\r\n          />\r\n\r\n          <Button\r\n            variant=\"outline\"\r\n            size=\"sm\"\r\n            onClick={handleUploadClick}\r\n            disabled={isLoading}\r\n            leftIcon={<Upload size={14} />}\r\n          >\r\n            {avatar ? 'Change Avatar' : 'Upload Avatar'}\r\n          </Button>\r\n        </>\r\n      )}\r\n\r\n      {/* Error Message */}\r\n      {error && <p className=\"text-xs text-red-600\">{error}</p>}\r\n\r\n      {/* Helper Text */}\r\n      {editable && !error && (\r\n        <p className=\"text-center text-xs text-gray-500\">\r\n          Max {MAX_AVATAR_SIZE_MB}MB â€¢ Uploaded to cloud storage\r\n        </p>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1583, "column": 0}, "map": {"version":3,"sources":["file:///home/irakli/Projects/RollKeeper/apps/web/src/components/ui/character/CharacterSheetHeader.tsx"],"sourcesContent":["'use client';\r\n\r\nimport {\r\n  Download,\r\n  Upload,\r\n  RotateCcw,\r\n  FileText,\r\n  ArrowLeft,\r\n  Pencil,\r\n  Eye,\r\n} from 'lucide-react';\r\nimport Link from 'next/link';\r\nimport { SaveIndicator } from '@/components/ui/feedback/SaveIndicator';\r\nimport { usePlayerStore } from '@/store/playerStore';\r\nimport { useCharacterStore } from '@/store/characterStore';\r\nimport { exportCharacterToFile } from '@/utils/fileOperations';\r\nimport { useState, useEffect } from 'react';\r\nimport { Button, Input } from '@/components/ui/forms';\r\nimport { AvatarUpload } from './AvatarUpload';\r\n\r\ninterface CharacterSheetHeaderProps {\r\n  characterId: string;\r\n  characterName: string;\r\n  characterRace: string;\r\n  characterClass: string;\r\n  characterLevel: number;\r\n  saveStatus: 'saving' | 'saved' | 'error';\r\n  lastSaved: Date | string | null;\r\n  hasUnsavedChanges: boolean;\r\n  onManualSave: () => void;\r\n  onExport: () => void;\r\n  onShowResetModal: () => void;\r\n  onUpdateName: (name: string) => void;\r\n  onAddToast: (toast: {\r\n    type: 'error' | 'damage' | 'attack' | 'save' | 'info' | 'success';\r\n    title: string;\r\n    message: string;\r\n  }) => void;\r\n}\r\n\r\nexport default function CharacterSheetHeader({\r\n  characterId,\r\n  characterName,\r\n  characterRace,\r\n  characterClass,\r\n  characterLevel,\r\n  saveStatus,\r\n  lastSaved,\r\n  hasUnsavedChanges,\r\n  onManualSave,\r\n  onExport,\r\n  onShowResetModal,\r\n  onUpdateName,\r\n  onAddToast,\r\n}: CharacterSheetHeaderProps) {\r\n  const { exportCharacter } = useCharacterStore();\r\n  const { getCharacterById, updateCharacterData } = usePlayerStore();\r\n\r\n  // Get character data for avatar\r\n  const playerCharacter = getCharacterById(characterId);\r\n\r\n  // Handle avatar change\r\n  const handleAvatarChange = (newAvatar: string | undefined) => {\r\n    if (playerCharacter?.characterData) {\r\n      updateCharacterData(characterId, {\r\n        ...playerCharacter.characterData,\r\n        avatar: newAvatar,\r\n      });\r\n    } else {\r\n    }\r\n  };\r\n\r\n  // Header visibility state\r\n  const [isHeaderVisible, setIsHeaderVisible] = useState(true);\r\n  const [lastScrollY, setLastScrollY] = useState(0);\r\n  const [isHovering, setIsHovering] = useState(false);\r\n\r\n  const [isEditMode, setIsEditMode] = useState(false);\r\n\r\n  useEffect(() => {\r\n    const handleScroll = () => {\r\n      const currentScrollY = window.scrollY;\r\n\r\n      if (currentScrollY < 10) {\r\n        setIsHeaderVisible(true);\r\n      } else if (!isHovering) {\r\n        if (currentScrollY > lastScrollY && currentScrollY > 100) {\r\n          setIsHeaderVisible(false);\r\n        } else if (currentScrollY < lastScrollY) {\r\n          setIsHeaderVisible(true);\r\n        }\r\n      }\r\n\r\n      setLastScrollY(currentScrollY);\r\n    };\r\n\r\n    window.addEventListener('scroll', handleScroll, { passive: true });\r\n    return () => window.removeEventListener('scroll', handleScroll);\r\n  }, [lastScrollY, isHovering]);\r\n\r\n  return (\r\n    <>\r\n      {!isHeaderVisible && (\r\n        <div\r\n          className=\"fixed top-0 left-0 z-[60] h-3 w-full cursor-pointer\"\r\n          onMouseEnter={() => setIsHovering(true)}\r\n          title=\"Hover to show header\"\r\n        />\r\n      )}\r\n\r\n      <header\r\n        className={`sticky top-0 z-50 border-b border-slate-200 bg-white shadow-lg transition-transform duration-300 ease-in-out ${\r\n          isHeaderVisible ? 'translate-y-0' : '-translate-y-full'\r\n        }`}\r\n        onMouseEnter={() => setIsHovering(true)}\r\n        onMouseLeave={() => setIsHovering(false)}\r\n      >\r\n        <div className=\"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8\">\r\n          <div className=\"flex h-16 items-center justify-between\">\r\n            <div className=\"flex items-center\">\r\n              <Link href=\"/player\">\r\n                <Button\r\n                  variant=\"ghost\"\r\n                  size=\"sm\"\r\n                  leftIcon={<ArrowLeft size={20} />}\r\n                >\r\n                  Back to Characters\r\n                </Button>\r\n              </Link>\r\n              <div className=\"ml-6\">\r\n                <h1 className=\"text-xl font-bold text-slate-800\">\r\n                  {characterName}\r\n                </h1>\r\n                <p className=\"text-sm text-slate-600\">\r\n                  {characterRace} {characterClass || 'Unknown Class'} â€¢ Level{' '}\r\n                  {characterLevel}\r\n                </p>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"flex items-center space-x-4\">\r\n              <SaveIndicator lastSaved={lastSaved} status={saveStatus} />\r\n\r\n              {/* File Operations */}\r\n              <div className=\"flex items-center space-x-2\">\r\n                <Button\r\n                  onClick={() => {\r\n                    try {\r\n                      const exportData = exportCharacter();\r\n                      exportCharacterToFile(exportData);\r\n                      onAddToast({\r\n                        type: 'success',\r\n                        title: 'Export Successful',\r\n                        message: 'Character exported successfully!',\r\n                      });\r\n                    } catch (error) {\r\n                      console.error('Export failed:', error);\r\n                      onAddToast({\r\n                        type: 'error',\r\n                        title: 'Export Failed',\r\n                        message: 'Failed to export character.',\r\n                      });\r\n                    }\r\n                  }}\r\n                  variant=\"outline\"\r\n                  size=\"sm\"\r\n                  leftIcon={<Download size={16} />}\r\n                  title=\"Export Character\"\r\n                >\r\n                  Export\r\n                </Button>\r\n\r\n                <Button asChild variant=\"outline\" size=\"sm\">\r\n                  <label className=\"cursor-pointer\">\r\n                    <span className=\"flex items-center gap-2\">\r\n                      <Upload size={16} />\r\n                      Import\r\n                    </span>\r\n                    <input\r\n                      type=\"file\"\r\n                      accept=\".json\"\r\n                      onChange={async e => {\r\n                        const file = e.target.files?.[0];\r\n                        if (file) {\r\n                          try {\r\n                            const text = await file.text();\r\n                            const data = JSON.parse(text);\r\n\r\n                            // Use the player store's import function\r\n                            const { importCharacter: importToPlayerStore } =\r\n                              usePlayerStore.getState();\r\n                            const newCharacterId = importToPlayerStore(data);\r\n\r\n                            onAddToast({\r\n                              type: 'success',\r\n                              title: 'Import Successful',\r\n                              message:\r\n                                'Character imported successfully! Redirecting to new character...',\r\n                            });\r\n\r\n                            // Redirect to the newly imported character after a brief delay\r\n                            setTimeout(() => {\r\n                              window.location.href = `/player/characters/${newCharacterId}`;\r\n                            }, 1500);\r\n                          } catch (error) {\r\n                            console.error('Import failed:', error);\r\n                            onAddToast({\r\n                              type: 'error',\r\n                              title: 'Import Failed',\r\n                              message:\r\n                                'Failed to import character. Please check the file format.',\r\n                            });\r\n                          }\r\n                        }\r\n                        e.target.value = '';\r\n                      }}\r\n                      className=\"hidden\"\r\n                    />\r\n                  </label>\r\n                </Button>\r\n\r\n                <Button\r\n                  onClick={onShowResetModal}\r\n                  variant=\"danger\"\r\n                  size=\"sm\"\r\n                  leftIcon={<RotateCcw size={16} />}\r\n                  title=\"Reset Character\"\r\n                >\r\n                  Reset\r\n                </Button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </header>\r\n\r\n      {/* Main Character Header */}\r\n      <header className=\"relative z-30 mx-auto mb-8 max-w-7xl\">\r\n        <div className=\"rounded-xl border border-slate-200 bg-white/90 p-6 shadow-xl backdrop-blur-sm\">\r\n          <div className=\"flex items-start gap-4\">\r\n            {/* Avatar */}\r\n            <AvatarUpload\r\n              avatar={playerCharacter?.avatar}\r\n              characterId={characterId}\r\n              characterName={characterName}\r\n              onAvatarChange={handleAvatarChange}\r\n              size=\"lg\"\r\n              editable={isEditMode}\r\n            />\r\n\r\n            {/* Name Input and Buttons - side by side */}\r\n            <div className=\"flex flex-1 items-start justify-between gap-4\">\r\n              <div className=\"flex-1\">\r\n                {isEditMode ? (\r\n                  <Input\r\n                    type=\"text\"\r\n                    placeholder=\"Character Name\"\r\n                    value={characterName}\r\n                    onChange={e => onUpdateName(e.target.value)}\r\n                    className=\"text-text-primary placeholder-text-tertiary w-full border-none bg-transparent text-3xl font-bold outline-none\"\r\n                    size=\"lg\"\r\n                  />\r\n                ) : (\r\n                  <h2 className=\"w-full text-3xl font-bold text-gray-900\">\r\n                    {characterName || 'Unnamed Character'}\r\n                  </h2>\r\n                )}\r\n                <SaveIndicator\r\n                  status={saveStatus}\r\n                  lastSaved={lastSaved}\r\n                  hasUnsavedChanges={hasUnsavedChanges}\r\n                  className=\"mt-1\"\r\n                />\r\n              </div>\r\n\r\n              {/* Action Buttons */}\r\n              <div className=\"flex shrink-0 gap-2\">\r\n                {/* Edit/View Mode Toggle */}\r\n                <Button\r\n                  onClick={() => setIsEditMode(!isEditMode)}\r\n                  variant={isEditMode ? 'primary' : 'outline'}\r\n                  size=\"sm\"\r\n                  leftIcon={\r\n                    isEditMode ? <Eye size={16} /> : <Pencil size={16} />\r\n                  }\r\n                  className={\r\n                    isEditMode\r\n                      ? 'bg-linear-to-r from-blue-600 to-blue-700 shadow-md hover:from-blue-700 hover:to-blue-800'\r\n                      : 'shadow-sm'\r\n                  }\r\n                  title={\r\n                    isEditMode ? 'Switch to view mode' : 'Switch to edit mode'\r\n                  }\r\n                >\r\n                  {isEditMode ? 'View' : 'Edit'}\r\n                </Button>\r\n\r\n                {/* <Button\r\n                  onClick={onManualSave}\r\n                  disabled={!hasUnsavedChanges}\r\n                  variant=\"success\"\r\n                  size=\"sm\"\r\n                  leftIcon={<Save size={16} />}\r\n                  className=\"bg-gradient-to-r from-emerald-600 to-emerald-700 hover:from-emerald-700 hover:to-emerald-800 shadow-md\"\r\n                >\r\n                  Save\r\n                </Button> */}\r\n                <Button\r\n                  onClick={onExport}\r\n                  variant=\"outline\"\r\n                  size=\"sm\"\r\n                  leftIcon={<Download size={16} />}\r\n                  className=\"shadow-sm\"\r\n                >\r\n                  Export\r\n                </Button>\r\n\r\n                <Button\r\n                  asChild\r\n                  variant=\"secondary\"\r\n                  size=\"sm\"\r\n                  className=\"shadow-sm\"\r\n                  title=\"Try the new Notes module prototype\"\r\n                >\r\n                  <Link href=\"/prototype\" className=\"flex items-center gap-2\">\r\n                    <FileText size={16} />\r\n                    Notes Prototype\r\n                  </Link>\r\n                </Button>\r\n\r\n                <Button\r\n                  onClick={onShowResetModal}\r\n                  variant=\"danger\"\r\n                  size=\"sm\"\r\n                  leftIcon={<RotateCcw size={16} />}\r\n                  className=\"bg-gradient-to-r from-red-600 to-red-700 shadow-md hover:from-red-700 hover:to-red-800\"\r\n                  title=\"Reset character - this will clear all data!\"\r\n                >\r\n                  Reset\r\n                </Button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </header>\r\n    </>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AASA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AAlBA;;;;;;;;;;;AAwCe,SAAS,qBAAqB,EAC3C,WAAW,EACX,aAAa,EACb,aAAa,EACb,cAAc,EACd,cAAc,EACd,UAAU,EACV,SAAS,EACT,iBAAiB,EACjB,YAAY,EACZ,QAAQ,EACR,gBAAgB,EAChB,YAAY,EACZ,UAAU,EACgB;IAC1B,MAAM,EAAE,eAAe,EAAE,GAAG,IAAA,kKAAiB;IAC7C,MAAM,EAAE,gBAAgB,EAAE,mBAAmB,EAAE,GAAG,IAAA,4JAAc;IAEhE,gCAAgC;IAChC,MAAM,kBAAkB,iBAAiB;IAEzC,uBAAuB;IACvB,MAAM,qBAAqB,CAAC;QAC1B,IAAI,iBAAiB,eAAe;YAClC,oBAAoB,aAAa;gBAC/B,GAAG,gBAAgB,aAAa;gBAChC,QAAQ;YACV;QACF,OAAO,CACP;IACF;IAEA,0BAA0B;IAC1B,MAAM,CAAC,iBAAiB,mBAAmB,GAAG,IAAA,iNAAQ,EAAC;IACvD,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,iNAAQ,EAAC;IAC/C,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,iNAAQ,EAAC;IAE7C,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,iNAAQ,EAAC;IAE7C,IAAA,kNAAS,EAAC;QACR,MAAM,eAAe;YACnB,MAAM,iBAAiB,OAAO,OAAO;YAErC,IAAI,iBAAiB,IAAI;gBACvB,mBAAmB;YACrB,OAAO,IAAI,CAAC,YAAY;gBACtB,IAAI,iBAAiB,eAAe,iBAAiB,KAAK;oBACxD,mBAAmB;gBACrB,OAAO,IAAI,iBAAiB,aAAa;oBACvC,mBAAmB;gBACrB;YACF;YAEA,eAAe;QACjB;QAEA,OAAO,gBAAgB,CAAC,UAAU,cAAc;YAAE,SAAS;QAAK;QAChE,OAAO,IAAM,OAAO,mBAAmB,CAAC,UAAU;IACpD,GAAG;QAAC;QAAa;KAAW;IAE5B,qBACE;;YACG,CAAC,iCACA,8OAAC;gBACC,WAAU;gBACV,cAAc,IAAM,cAAc;gBAClC,OAAM;;;;;;0BAIV,8OAAC;gBACC,WAAW,CAAC,6GAA6G,EACvH,kBAAkB,kBAAkB,qBACpC;gBACF,cAAc,IAAM,cAAc;gBAClC,cAAc,IAAM,cAAc;0BAElC,cAAA,8OAAC;oBAAI,WAAU;8BACb,cAAA,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;gCAAI,WAAU;;kDACb,8OAAC,uKAAI;wCAAC,MAAK;kDACT,cAAA,8OAAC,oLAAM;4CACL,SAAQ;4CACR,MAAK;4CACL,wBAAU,8OAAC,6NAAS;gDAAC,MAAM;;;;;;sDAC5B;;;;;;;;;;;kDAIH,8OAAC;wCAAI,WAAU;;0DACb,8OAAC;gDAAG,WAAU;0DACX;;;;;;0DAEH,8OAAC;gDAAE,WAAU;;oDACV;oDAAc;oDAAE,kBAAkB;oDAAgB;oDAAS;oDAC3D;;;;;;;;;;;;;;;;;;;0CAKP,8OAAC;gCAAI,WAAU;;kDACb,8OAAC,qLAAa;wCAAC,WAAW;wCAAW,QAAQ;;;;;;kDAG7C,8OAAC;wCAAI,WAAU;;0DACb,8OAAC,oLAAM;gDACL,SAAS;oDACP,IAAI;wDACF,MAAM,aAAa;wDACnB,IAAA,sKAAqB,EAAC;wDACtB,WAAW;4DACT,MAAM;4DACN,OAAO;4DACP,SAAS;wDACX;oDACF,EAAE,OAAO,OAAO;wDACd,QAAQ,KAAK,CAAC,kBAAkB;wDAChC,WAAW;4DACT,MAAM;4DACN,OAAO;4DACP,SAAS;wDACX;oDACF;gDACF;gDACA,SAAQ;gDACR,MAAK;gDACL,wBAAU,8OAAC,sNAAQ;oDAAC,MAAM;;;;;;gDAC1B,OAAM;0DACP;;;;;;0DAID,8OAAC,oLAAM;gDAAC,OAAO;gDAAC,SAAQ;gDAAU,MAAK;0DACrC,cAAA,8OAAC;oDAAM,WAAU;;sEACf,8OAAC;4DAAK,WAAU;;8EACd,8OAAC,gNAAM;oEAAC,MAAM;;;;;;gEAAM;;;;;;;sEAGtB,8OAAC;4DACC,MAAK;4DACL,QAAO;4DACP,UAAU,OAAM;gEACd,MAAM,OAAO,EAAE,MAAM,CAAC,KAAK,EAAE,CAAC,EAAE;gEAChC,IAAI,MAAM;oEACR,IAAI;wEACF,MAAM,OAAO,MAAM,KAAK,IAAI;wEAC5B,MAAM,OAAO,KAAK,KAAK,CAAC;wEAExB,yCAAyC;wEACzC,MAAM,EAAE,iBAAiB,mBAAmB,EAAE,GAC5C,4JAAc,CAAC,QAAQ;wEACzB,MAAM,iBAAiB,oBAAoB;wEAE3C,WAAW;4EACT,MAAM;4EACN,OAAO;4EACP,SACE;wEACJ;wEAEA,+DAA+D;wEAC/D,WAAW;4EACT,OAAO,QAAQ,CAAC,IAAI,GAAG,CAAC,mBAAmB,EAAE,gBAAgB;wEAC/D,GAAG;oEACL,EAAE,OAAO,OAAO;wEACd,QAAQ,KAAK,CAAC,kBAAkB;wEAChC,WAAW;4EACT,MAAM;4EACN,OAAO;4EACP,SACE;wEACJ;oEACF;gEACF;gEACA,EAAE,MAAM,CAAC,KAAK,GAAG;4DACnB;4DACA,WAAU;;;;;;;;;;;;;;;;;0DAKhB,8OAAC,oLAAM;gDACL,SAAS;gDACT,SAAQ;gDACR,MAAK;gDACL,wBAAU,8OAAC,6NAAS;oDAAC,MAAM;;;;;;gDAC3B,OAAM;0DACP;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;0BAUX,8OAAC;gBAAO,WAAU;0BAChB,cAAA,8OAAC;oBAAI,WAAU;8BACb,cAAA,8OAAC;wBAAI,WAAU;;0CAEb,8OAAC,oLAAY;gCACX,QAAQ,iBAAiB;gCACzB,aAAa;gCACb,eAAe;gCACf,gBAAgB;gCAChB,MAAK;gCACL,UAAU;;;;;;0CAIZ,8OAAC;gCAAI,WAAU;;kDACb,8OAAC;wCAAI,WAAU;;4CACZ,2BACC,8OAAC,kKAAK;gDACJ,MAAK;gDACL,aAAY;gDACZ,OAAO;gDACP,UAAU,CAAA,IAAK,aAAa,EAAE,MAAM,CAAC,KAAK;gDAC1C,WAAU;gDACV,MAAK;;;;;qEAGP,8OAAC;gDAAG,WAAU;0DACX,iBAAiB;;;;;;0DAGtB,8OAAC,qLAAa;gDACZ,QAAQ;gDACR,WAAW;gDACX,mBAAmB;gDACnB,WAAU;;;;;;;;;;;;kDAKd,8OAAC;wCAAI,WAAU;;0DAEb,8OAAC,oLAAM;gDACL,SAAS,IAAM,cAAc,CAAC;gDAC9B,SAAS,aAAa,YAAY;gDAClC,MAAK;gDACL,UACE,2BAAa,8OAAC,uMAAG;oDAAC,MAAM;;;;;2EAAS,8OAAC,gNAAM;oDAAC,MAAM;;;;;;gDAEjD,WACE,aACI,6FACA;gDAEN,OACE,aAAa,wBAAwB;0DAGtC,aAAa,SAAS;;;;;;0DAazB,8OAAC,oLAAM;gDACL,SAAS;gDACT,SAAQ;gDACR,MAAK;gDACL,wBAAU,8OAAC,sNAAQ;oDAAC,MAAM;;;;;;gDAC1B,WAAU;0DACX;;;;;;0DAID,8OAAC,oLAAM;gDACL,OAAO;gDACP,SAAQ;gDACR,MAAK;gDACL,WAAU;gDACV,OAAM;0DAEN,cAAA,8OAAC,uKAAI;oDAAC,MAAK;oDAAa,WAAU;;sEAChC,8OAAC,0NAAQ;4DAAC,MAAM;;;;;;wDAAM;;;;;;;;;;;;0DAK1B,8OAAC,oLAAM;gDACL,SAAS;gDACT,SAAQ;gDACR,MAAK;gDACL,wBAAU,8OAAC,6NAAS;oDAAC,MAAM;;;;;;gDAC3B,WAAU;gDACV,OAAM;0DACP;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAUjB","debugId":null}},
    {"offset": {"line": 2098, "column": 0}, "map": {"version":3,"sources":["file:///home/irakli/Projects/RollKeeper/apps/web/src/components/ui/character/SimpleClassSelector.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React from 'react';\r\nimport { ClassInfo } from '@/types/character';\r\nimport { COMMON_CLASSES } from '@/utils/constants';\r\nimport { SelectField, SelectItem } from '@/components/ui/forms/select';\r\n\r\ninterface SimpleClassSelectorProps {\r\n  value: ClassInfo;\r\n  onChange: (classInfo: ClassInfo) => void;\r\n  className?: string;\r\n}\r\n\r\nexport default function SimpleClassSelector({\r\n  value,\r\n  onChange,\r\n  className = '',\r\n}: SimpleClassSelectorProps) {\r\n  const handleClassChange = (className: string) => {\r\n    const classData = COMMON_CLASSES.find(c => c.name === className);\r\n    if (classData) {\r\n      onChange({\r\n        name: classData.name,\r\n        isCustom: false,\r\n        spellcaster: classData.spellcaster,\r\n        hitDie: classData.hitDie,\r\n      });\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className={className}>\r\n      <SelectField\r\n        label=\"Class\"\r\n        value={value.name}\r\n        onValueChange={handleClassChange}\r\n      >\r\n        {COMMON_CLASSES.map(classData => (\r\n          <SelectItem key={classData.name} value={classData.name}>\r\n            <div className=\"flex flex-col\">\r\n              <span className=\"font-medium\">{classData.name}</span>\r\n              <span className=\"text-xs text-gray-600\">\r\n                {classData.spellcaster !== 'none'\r\n                  ? `${\r\n                      classData.spellcaster === 'full'\r\n                        ? 'Full'\r\n                        : classData.spellcaster === 'half'\r\n                          ? 'Half'\r\n                          : classData.spellcaster === 'third'\r\n                            ? '1/3'\r\n                            : 'Pact'\r\n                    } Caster`\r\n                  : 'Non-spellcaster'}\r\n              </span>\r\n            </div>\r\n          </SelectItem>\r\n        ))}\r\n      </SelectField>\r\n\r\n      {/* Show spellcaster info for selected class */}\r\n      {value.name && (\r\n        <div className=\"mt-2 text-xs text-gray-600\">\r\n          {value.spellcaster === 'none' && 'â€¢ Non-spellcaster'}\r\n          {value.spellcaster === 'full' &&\r\n            'â€¢ Full spellcaster (Spell slots by class level)'}\r\n          {value.spellcaster === 'half' &&\r\n            'â€¢ Half caster (Spell slots by half class level)'}\r\n          {value.spellcaster === 'third' &&\r\n            'â€¢ Third caster (Limited spell slots)'}\r\n          {value.spellcaster === 'warlock' &&\r\n            'â€¢ Warlock (Pact Magic - short rest recovery)'}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AAIA;AACA;AALA;;;;AAae,SAAS,oBAAoB,EAC1C,KAAK,EACL,QAAQ,EACR,YAAY,EAAE,EACW;IACzB,MAAM,oBAAoB,CAAC;QACzB,MAAM,YAAY,0JAAc,CAAC,IAAI,CAAC,CAAA,IAAK,EAAE,IAAI,KAAK;QACtD,IAAI,WAAW;YACb,SAAS;gBACP,MAAM,UAAU,IAAI;gBACpB,UAAU;gBACV,aAAa,UAAU,WAAW;gBAClC,QAAQ,UAAU,MAAM;YAC1B;QACF;IACF;IAEA,qBACE,8OAAC;QAAI,WAAW;;0BACd,8OAAC,yKAAW;gBACV,OAAM;gBACN,OAAO,MAAM,IAAI;gBACjB,eAAe;0BAEd,0JAAc,CAAC,GAAG,CAAC,CAAA,0BAClB,8OAAC,wKAAU;wBAAsB,OAAO,UAAU,IAAI;kCACpD,cAAA,8OAAC;4BAAI,WAAU;;8CACb,8OAAC;oCAAK,WAAU;8CAAe,UAAU,IAAI;;;;;;8CAC7C,8OAAC;oCAAK,WAAU;8CACb,UAAU,WAAW,KAAK,SACvB,GACE,UAAU,WAAW,KAAK,SACtB,SACA,UAAU,WAAW,KAAK,SACxB,SACA,UAAU,WAAW,KAAK,UACxB,QACA,OACT,OAAO,CAAC,GACT;;;;;;;;;;;;uBAdO,UAAU,IAAI;;;;;;;;;;YAsBlC,MAAM,IAAI,kBACT,8OAAC;gBAAI,WAAU;;oBACZ,MAAM,WAAW,KAAK,UAAU;oBAChC,MAAM,WAAW,KAAK,UACrB;oBACD,MAAM,WAAW,KAAK,UACrB;oBACD,MAAM,WAAW,KAAK,WACrB;oBACD,MAAM,WAAW,KAAK,aACrB;;;;;;;;;;;;;AAKZ","debugId":null}},
    {"offset": {"line": 2190, "column": 0}, "map": {"version":3,"sources":["file:///home/irakli/Projects/RollKeeper/apps/web/src/components/ui/character/MulticlassManager.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React, { useState } from 'react';\r\nimport { Plus, Minus, AlertTriangle, Info, Users, Sparkles } from 'lucide-react';\r\nimport { CharacterState } from '@/types/character';\r\nimport { validateMulticlassRequirements } from '@/utils/multiclass';\r\nimport { COMMON_CLASSES } from '@/utils/constants';\r\nimport { Button, Input, SelectField, SelectItem } from '@/components/ui/forms';\r\nimport { Badge } from '@/components/ui/layout';\r\nimport { useClassData } from '@/hooks/useClassData';\r\n\r\ninterface MulticlassManagerProps {\r\n  character: CharacterState;\r\n  onAddClassLevel: (\r\n    className: string,\r\n    isCustom?: boolean,\r\n    spellcaster?: 'full' | 'half' | 'third' | 'warlock' | 'none',\r\n    hitDie?: number,\r\n    subclass?: string\r\n  ) => void;\r\n  onRemoveClassLevel: (className: string) => void;\r\n  onUpdateClassLevel: (className: string, newLevel: number) => void;\r\n}\r\n\r\nexport default function MulticlassManager({\r\n  character,\r\n  onAddClassLevel,\r\n  onRemoveClassLevel,\r\n  onUpdateClassLevel,\r\n}: MulticlassManagerProps) {\r\n  const [showAddClass, setShowAddClass] = useState(false);\r\n  const [newClassName, setNewClassName] = useState('');\r\n  const [validationResult, setValidationResult] = useState<{\r\n    valid: boolean;\r\n    errors: string[];\r\n    warnings?: string[];\r\n  } | null>(null);\r\n\r\n  const { classData, loading: classDataLoading, error: classDataError } = useClassData();\r\n\r\n  const classes = character.classes || [];\r\n  const isMulticlassed = classes.length > 1;\r\n  const totalLevel = classes.reduce((sum, cls) => sum + cls.level, 0);\r\n\r\n  // Get class data for the new class to determine spellcaster type and hit die\r\n  const getClassData = (className: string) => {\r\n    const apiClass = classData.find(cls => cls.name === className);\r\n    if (apiClass) {\r\n      return {\r\n        spellcaster: apiClass.spellcasting.type,\r\n        hitDie: parseInt(apiClass.hitDie.replace('d', '')),\r\n      };\r\n    }\r\n    \r\n    // Fallback to COMMON_CLASSES for backwards compatibility\r\n    const commonClass = COMMON_CLASSES.find(cls => cls.name === className);\r\n    if (commonClass) {\r\n      return {\r\n        spellcaster: commonClass.spellcaster,\r\n        hitDie: commonClass.hitDie,\r\n      };\r\n    }\r\n    \r\n    // Final fallback for unknown classes\r\n    return {\r\n      spellcaster: 'none' as const,\r\n      hitDie: 8,\r\n    };\r\n  };\r\n\r\n  const handleAddClass = () => {\r\n    if (!newClassName.trim()) return;\r\n\r\n    const classInfo = getClassData(newClassName);\r\n    \r\n    // Validate multiclassing requirements\r\n    const validation = validateMulticlassRequirements(\r\n      classes,\r\n      newClassName,\r\n      character.abilities,\r\n      classData\r\n    );\r\n    \r\n    setValidationResult(validation);\r\n\r\n    if (validation.valid) {\r\n      onAddClassLevel(\r\n        newClassName,\r\n        false, // isCustom - we'll assume false for now\r\n        classInfo.spellcaster,\r\n        classInfo.hitDie\r\n      );\r\n      setNewClassName('');\r\n      setShowAddClass(false);\r\n      setValidationResult(null);\r\n    }\r\n  };\r\n\r\n  const handleRemoveClass = (className: string) => {\r\n    onRemoveClassLevel(className);\r\n    setValidationResult(null);\r\n  };\r\n\r\n  const handleLevelChange = (className: string, newLevel: number) => {\r\n    const clampedLevel = Math.max(1, Math.min(20, newLevel));\r\n    onUpdateClassLevel(className, clampedLevel);\r\n  };\r\n\r\n  const canAddClass = totalLevel < 20;\r\n\r\n  // Show loading state while class data is loading\r\n  if (classDataLoading) {\r\n    return (\r\n      <div className=\"rounded-lg border-2 border-blue-200 bg-gradient-to-br from-blue-50 to-indigo-50 p-6 shadow-sm\">\r\n        <div className=\"flex items-center justify-center py-8\">\r\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\r\n          <span className=\"ml-3 text-gray-600 font-medium\">Loading class data...</span>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // Show error state if class data failed to load\r\n  if (classDataError) {\r\n    return (\r\n      <div className=\"rounded-lg border-2 border-red-200 bg-gradient-to-br from-red-50 to-pink-50 p-6 shadow-sm\">\r\n        <div className=\"flex items-center justify-center py-8\">\r\n          <AlertTriangle className=\"h-8 w-8 text-red-500\" />\r\n          <span className=\"ml-3 text-red-600 font-medium\">Failed to load class data</span>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"rounded-lg border-2 border-indigo-200 bg-gradient-to-br from-indigo-50 to-purple-50 p-6 shadow-sm\">\r\n      <div className=\"mb-4 flex items-center justify-between\">\r\n        <h3 className=\"flex items-center gap-2 text-lg font-bold text-indigo-800\">\r\n          <Users className=\"h-5 w-5\" />\r\n          {isMulticlassed ? 'Multiclass Levels' : 'Class Levels'}\r\n        </h3>\r\n        {canAddClass && (\r\n          <Button\r\n            onClick={() => setShowAddClass(!showAddClass)}\r\n            variant=\"primary\"\r\n            size=\"sm\"\r\n            leftIcon={<Plus className=\"h-4 w-4\" />}\r\n            className=\"bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700\"\r\n          >\r\n            Add Class\r\n          </Button>\r\n        )}\r\n      </div>\r\n\r\n      {/* Current Classes */}\r\n      <div className=\"space-y-3\">\r\n        {classes.map((classInfo, index) => (\r\n          <div\r\n            key={`${classInfo.className}-${index}`}\r\n            className=\"flex items-center justify-between rounded-lg border-2 border-indigo-200 bg-white p-3 transition-shadow hover:shadow-md\"\r\n          >\r\n            <div className=\"flex items-center gap-2 flex-wrap\">\r\n              <Badge variant=\"secondary\" size=\"lg\" className=\"font-semibold\">\r\n                {classInfo.className}\r\n              </Badge>\r\n              {classInfo.subclass && (\r\n                <Badge variant=\"neutral\" size=\"sm\">\r\n                  {classInfo.subclass}\r\n                </Badge>\r\n              )}\r\n              {classInfo.spellcaster && classInfo.spellcaster !== 'none' && (\r\n                <Badge variant=\"info\" size=\"sm\" leftIcon={<Sparkles className=\"h-3 w-3\" />}>\r\n                  {classInfo.spellcaster === 'full' ? 'Full' : \r\n                   classInfo.spellcaster === 'half' ? 'Half' : \r\n                   classInfo.spellcaster === 'third' ? '1/3' : \r\n                   'Pact'} Caster\r\n                </Badge>\r\n              )}\r\n            </div>\r\n\r\n            <div className=\"flex items-center gap-2\">\r\n              <div className=\"flex items-center gap-2\">\r\n                <label className=\"text-sm font-medium text-gray-700\">Level:</label>\r\n                <Input\r\n                  type=\"number\"\r\n                  min=\"1\"\r\n                  max=\"20\"\r\n                  value={classInfo.level.toString()}\r\n                  onChange={(e) => handleLevelChange(classInfo.className, parseInt(e.target.value) || 1)}\r\n                  className=\"w-16 text-center\"\r\n                  size=\"sm\"\r\n                />\r\n              </div>\r\n              \r\n              {classes.length > 1 && (\r\n                <Button\r\n                  onClick={() => handleRemoveClass(classInfo.className)}\r\n                  variant=\"ghost\"\r\n                  size=\"xs\"\r\n                  className=\"text-red-600 hover:bg-red-100\"\r\n                  title=\"Remove class level\"\r\n                >\r\n                  <Minus className=\"h-4 w-4\" />\r\n                </Button>\r\n              )}\r\n            </div>\r\n          </div>\r\n        ))}\r\n      </div>\r\n\r\n      {/* Total Level Display */}\r\n      <div className=\"mt-4 rounded-lg border-2 border-blue-300 bg-gradient-to-r from-blue-100 to-cyan-100 p-4 shadow-sm\">\r\n        <div className=\"flex items-center justify-between\">\r\n          <span className=\"font-semibold text-blue-900\">Total Character Level:</span>\r\n          <Badge variant=\"primary\" size=\"lg\" className=\"text-xl font-bold px-4 py-2\">\r\n            {totalLevel}\r\n          </Badge>\r\n        </div>\r\n        {isMulticlassed && (\r\n          <div className=\"mt-2 flex items-center gap-2\">\r\n            <Badge variant=\"info\" size=\"sm\">\r\n              Multiclass\r\n            </Badge>\r\n            <span className=\"text-sm text-blue-700\">\r\n              {classes.length} classes\r\n            </span>\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Add New Class Form */}\r\n      {showAddClass && (\r\n        <div className=\"mt-4 rounded-lg border-2 border-purple-200 bg-gradient-to-br from-purple-50 to-pink-50 p-4 shadow-sm\">\r\n          <h4 className=\"mb-3 flex items-center gap-2 font-semibold text-purple-800\">\r\n            <Plus className=\"h-4 w-4\" />\r\n            Add New Class\r\n          </h4>\r\n          \r\n          <div className=\"space-y-3\">\r\n            <div>\r\n              <SelectField\r\n                label=\"Select Class\"\r\n                value={newClassName}\r\n                onValueChange={(value: string) => {\r\n                  // Don't process the placeholder value\r\n                  if (value === '__placeholder__') {\r\n                    setNewClassName('');\r\n                    setValidationResult(null);\r\n                    return;\r\n                  }\r\n                  \r\n                  setNewClassName(value);\r\n                  \r\n                  // Validate multiclass requirements when class is selected\r\n                  if (value && classData.length > 0) {\r\n                    const validation = validateMulticlassRequirements(\r\n                      classes,\r\n                      value,\r\n                      character.abilities,\r\n                      classData\r\n                    );\r\n                    setValidationResult(validation);\r\n                  } else {\r\n                    setValidationResult(null);\r\n                  }\r\n                }}\r\n              >\r\n                <SelectItem value=\"__placeholder__\" disabled>\r\n                  Choose a class...\r\n                </SelectItem>\r\n                {classData\r\n                  .filter(cls => !classes.some(existingCls => existingCls.className === cls.name))\r\n                  .map(cls => (\r\n                    <SelectItem key={cls.name} value={cls.name}>\r\n                      {cls.name}\r\n                      {cls.spellcasting.type !== 'none' && \r\n                        ` (${\r\n                          cls.spellcasting.type === 'full' ? 'Full' :\r\n                          cls.spellcasting.type === 'half' ? 'Half' :\r\n                          cls.spellcasting.type === 'third' ? '1/3' :\r\n                          'Half'\r\n                        } Caster)`\r\n                      }\r\n                    </SelectItem>\r\n                  ))}\r\n              </SelectField>\r\n              <p className=\"mt-1 text-xs text-gray-500\">\r\n                Only classes you don&apos;t already have are shown\r\n              </p>\r\n            </div>\r\n\r\n            {/* Validation Messages */}\r\n            {validationResult && (\r\n              <div className=\"space-y-2\">\r\n                {validationResult.errors.length > 0 && (\r\n                  <div className=\"rounded-lg border-2 border-red-200 bg-red-50 p-3\">\r\n                    <div className=\"flex items-start gap-2\">\r\n                      <AlertTriangle className=\"h-5 w-5 mt-0.5 text-red-500 flex-shrink-0\" />\r\n                      <div className=\"flex-1\">\r\n                        <h5 className=\"font-semibold text-red-800\">Requirements Not Met:</h5>\r\n                        <ul className=\"mt-1 list-disc list-inside text-sm text-red-700 space-y-1\">\r\n                          {validationResult.errors.map((error, index) => (\r\n                            <li key={index}>{error}</li>\r\n                          ))}\r\n                        </ul>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                )}\r\n\r\n                {validationResult.warnings && validationResult.warnings.length > 0 && (\r\n                  <div className=\"rounded-lg border-2 border-yellow-200 bg-yellow-50 p-3\">\r\n                    <div className=\"flex items-start gap-2\">\r\n                      <Info className=\"h-5 w-5 mt-0.5 text-yellow-500 flex-shrink-0\" />\r\n                      <div className=\"flex-1\">\r\n                        <h5 className=\"font-semibold text-yellow-800\">Considerations:</h5>\r\n                        <ul className=\"mt-1 list-disc list-inside text-sm text-yellow-700 space-y-1\">\r\n                          {validationResult.warnings.map((warning, index) => (\r\n                            <li key={index}>{warning}</li>\r\n                          ))}\r\n                        </ul>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            )}\r\n\r\n            <div className=\"flex gap-2\">\r\n              <Button\r\n                onClick={handleAddClass}\r\n                disabled={!newClassName.trim() || (validationResult ? !validationResult.valid : false)}\r\n                variant=\"primary\"\r\n                size=\"sm\"\r\n                className=\"bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700\"\r\n              >\r\n                Add Class Level\r\n              </Button>\r\n              <Button\r\n                onClick={() => {\r\n                  setShowAddClass(false);\r\n                  setNewClassName('');\r\n                  setValidationResult(null);\r\n                }}\r\n                variant=\"outline\"\r\n                size=\"sm\"\r\n              >\r\n                Cancel\r\n              </Button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Level 20 Warning */}\r\n      {totalLevel >= 20 && (\r\n        <div className=\"mt-4 rounded-lg border-2 border-amber-200 bg-gradient-to-r from-amber-50 to-yellow-50 p-3 shadow-sm\">\r\n          <div className=\"flex items-center gap-2\">\r\n            <AlertTriangle className=\"h-5 w-5 text-amber-500 flex-shrink-0\" />\r\n            <span className=\"text-sm font-semibold text-amber-800\">\r\n              Maximum character level reached (20)\r\n            </span>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Multiclassing Info */}\r\n      {!isMulticlassed && classes.length === 1 && (\r\n        <div className=\"mt-4 rounded-lg border-2 border-gray-200 bg-gray-50 p-4 shadow-sm\">\r\n          <div className=\"flex items-start gap-2\">\r\n            <Info className=\"h-5 w-5 mt-0.5 text-gray-500 flex-shrink-0\" />\r\n            <div className=\"text-sm text-gray-600\">\r\n              <p className=\"font-semibold text-gray-700\">About Multiclassing:</p>\r\n              <p className=\"mt-1\">\r\n                You can add levels in other classes to create a multiclass character. \r\n                Each class has ability score requirements that must be met.\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 2912, "column": 0}, "map": {"version":3,"sources":["file:///home/irakli/Projects/RollKeeper/apps/web/src/components/ui/character/CharacterBasicInfo.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useState } from 'react';\r\nimport { Settings } from 'lucide-react';\r\nimport SimpleClassSelector from '@/components/ui/character/SimpleClassSelector';\r\nimport MulticlassManager from '@/components/ui/character/MulticlassManager';\r\nimport { Button, Input } from '@/components/ui/forms';\r\nimport { SelectField, SelectItem } from '@/components/ui/forms/select';\r\nimport { ALIGNMENTS } from '@/utils/constants';\r\nimport { CharacterState } from '@/types/character';\r\n\r\ninterface CharacterBasicInfoProps {\r\n  character: CharacterState;\r\n  race: string;\r\n  characterClass: CharacterState['class'];\r\n  level: number;\r\n  background: string;\r\n  playerName: string;\r\n  alignment: string;\r\n  onUpdateRace: (race: string) => void;\r\n  onUpdateClass: (characterClass: CharacterState['class']) => void;\r\n  onUpdateLevel: (level: number) => void;\r\n  onUpdateBackground: (background: string) => void;\r\n  onUpdatePlayerName: (playerName: string) => void;\r\n  onUpdateAlignment: (alignment: string) => void;\r\n  // Multiclass methods\r\n  onAddClassLevel: (\r\n    className: string,\r\n    isCustom?: boolean,\r\n    spellcaster?: 'full' | 'half' | 'third' | 'warlock' | 'none',\r\n    hitDie?: number,\r\n    subclass?: string\r\n  ) => void;\r\n  onRemoveClassLevel: (className: string) => void;\r\n  onUpdateClassLevel: (className: string, newLevel: number) => void;\r\n  getClassDisplayString: () => string;\r\n}\r\n\r\nexport default function CharacterBasicInfo({\r\n  character,\r\n  race,\r\n  characterClass,\r\n  level,\r\n  background,\r\n  playerName,\r\n  alignment,\r\n  onUpdateRace,\r\n  onUpdateClass,\r\n  onUpdateLevel,\r\n  onUpdateBackground,\r\n  onUpdatePlayerName,\r\n  onUpdateAlignment,\r\n  onAddClassLevel,\r\n  onRemoveClassLevel,\r\n  onUpdateClassLevel,\r\n  getClassDisplayString,\r\n}: CharacterBasicInfoProps) {\r\n  const [showMulticlassManager, setShowMulticlassManager] = useState(false);\r\n  \r\n  const isMulticlassed = (character.classes?.length || 0) > 1;\r\n  const classDisplayString = getClassDisplayString();\r\n  return (\r\n    <div className=\"space-y-4\">\r\n      <div className=\"rounded-lg border border-amber-200 bg-white p-6 shadow-lg\">\r\n        <h2 className=\"mb-4 border-b border-gray-200 pb-2 text-lg font-bold text-gray-800\">\r\n          Character Information\r\n        </h2>\r\n        <div className=\"grid grid-cols-1 gap-4 sm:grid-cols-2\">\r\n          <div>\r\n            <Input\r\n              label=\"Race\"\r\n              type=\"text\"\r\n              placeholder=\"Human\"\r\n              value={race}\r\n              onChange={e => onUpdateRace(e.target.value)}\r\n            />\r\n          </div>\r\n\r\n          {/* Class Display - Show multiclass info or single class selector */}\r\n          {isMulticlassed ? (\r\n            <div>\r\n              <label className=\"mb-1 block text-sm font-medium text-gray-700\">\r\n                Classes\r\n              </label>\r\n              <div className=\"flex items-center gap-2\">\r\n                <div className=\"flex-1 rounded-md border border-gray-300 bg-gray-50 p-2 text-gray-800\">\r\n                  {classDisplayString}\r\n                </div>\r\n                <Button\r\n                  onClick={() => setShowMulticlassManager(!showMulticlassManager)}\r\n                  variant=\"primary\"\r\n                  size=\"sm\"\r\n                  leftIcon={<Settings size={16} />}\r\n                  title=\"Manage multiclass levels\"\r\n                  className=\"px-2\"\r\n                />\r\n              </div>\r\n            </div>\r\n          ) : (\r\n            <div>\r\n              <SimpleClassSelector value={characterClass} onChange={onUpdateClass} />\r\n            </div>\r\n          )}\r\n\r\n          {/* Multiclass Settings Button - Separate row for single class */}\r\n          {!isMulticlassed && (\r\n            <div className=\"sm:col-span-2\">\r\n              <Button\r\n                onClick={() => setShowMulticlassManager(!showMulticlassManager)}\r\n                variant=\"outline\"\r\n                size=\"md\"\r\n                leftIcon={<Settings size={16} />}\r\n                fullWidth\r\n                className=\"border-blue-200 bg-blue-50 text-blue-700 hover:bg-blue-100\"\r\n              >\r\n                Manage Multiclassing\r\n              </Button>\r\n            </div>\r\n          )}\r\n\r\n          <div>\r\n            <Input\r\n              label=\"Level\"\r\n              type=\"number\"\r\n              placeholder=\"1\"\r\n              min=\"1\"\r\n              max=\"20\"\r\n              value={level.toString()}\r\n              onChange={e => onUpdateLevel(parseInt(e.target.value) || 1)}\r\n            />\r\n          </div>\r\n          <div>\r\n            <Input\r\n              label=\"Background\"\r\n              type=\"text\"\r\n              placeholder=\"Soldier\"\r\n              value={background}\r\n              onChange={e => onUpdateBackground(e.target.value)}\r\n            />\r\n          </div>\r\n          <div>\r\n            <Input\r\n              label=\"Player Name\"\r\n              type=\"text\"\r\n              placeholder=\"Your Name\"\r\n              value={playerName}\r\n              onChange={e => onUpdatePlayerName(e.target.value)}\r\n            />\r\n          </div>\r\n          <div>\r\n            <SelectField\r\n              label=\"Alignment\"\r\n              value={alignment}\r\n              onValueChange={onUpdateAlignment}\r\n            >\r\n              {ALIGNMENTS.map(align => (\r\n                <SelectItem key={align} value={align}>\r\n                  {align}\r\n                </SelectItem>\r\n              ))}\r\n            </SelectField>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Multiclass Manager */}\r\n      {showMulticlassManager && (\r\n        <MulticlassManager\r\n          character={character}\r\n          onAddClassLevel={onAddClassLevel}\r\n          onRemoveClassLevel={onRemoveClassLevel}\r\n          onUpdateClassLevel={onUpdateClassLevel}\r\n        />\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AARA;;;;;;;;;AAsCe,SAAS,mBAAmB,EACzC,SAAS,EACT,IAAI,EACJ,cAAc,EACd,KAAK,EACL,UAAU,EACV,UAAU,EACV,SAAS,EACT,YAAY,EACZ,aAAa,EACb,aAAa,EACb,kBAAkB,EAClB,kBAAkB,EAClB,iBAAiB,EACjB,eAAe,EACf,kBAAkB,EAClB,kBAAkB,EAClB,qBAAqB,EACG;IACxB,MAAM,CAAC,uBAAuB,yBAAyB,GAAG,IAAA,iNAAQ,EAAC;IAEnE,MAAM,iBAAiB,CAAC,UAAU,OAAO,EAAE,UAAU,CAAC,IAAI;IAC1D,MAAM,qBAAqB;IAC3B,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAG,WAAU;kCAAqE;;;;;;kCAGnF,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;0CACC,cAAA,8OAAC,kKAAK;oCACJ,OAAM;oCACN,MAAK;oCACL,aAAY;oCACZ,OAAO;oCACP,UAAU,CAAA,IAAK,aAAa,EAAE,MAAM,CAAC,KAAK;;;;;;;;;;;4BAK7C,+BACC,8OAAC;;kDACC,8OAAC;wCAAM,WAAU;kDAA+C;;;;;;kDAGhE,8OAAC;wCAAI,WAAU;;0DACb,8OAAC;gDAAI,WAAU;0DACZ;;;;;;0DAEH,8OAAC,oLAAM;gDACL,SAAS,IAAM,yBAAyB,CAAC;gDACzC,SAAQ;gDACR,MAAK;gDACL,wBAAU,8OAAC,sNAAQ;oDAAC,MAAM;;;;;;gDAC1B,OAAM;gDACN,WAAU;;;;;;;;;;;;;;;;;qDAKhB,8OAAC;0CACC,cAAA,8OAAC,sLAAmB;oCAAC,OAAO;oCAAgB,UAAU;;;;;;;;;;;4BAKzD,CAAC,gCACA,8OAAC;gCAAI,WAAU;0CACb,cAAA,8OAAC,oLAAM;oCACL,SAAS,IAAM,yBAAyB,CAAC;oCACzC,SAAQ;oCACR,MAAK;oCACL,wBAAU,8OAAC,sNAAQ;wCAAC,MAAM;;;;;;oCAC1B,SAAS;oCACT,WAAU;8CACX;;;;;;;;;;;0CAML,8OAAC;0CACC,cAAA,8OAAC,kKAAK;oCACJ,OAAM;oCACN,MAAK;oCACL,aAAY;oCACZ,KAAI;oCACJ,KAAI;oCACJ,OAAO,MAAM,QAAQ;oCACrB,UAAU,CAAA,IAAK,cAAc,SAAS,EAAE,MAAM,CAAC,KAAK,KAAK;;;;;;;;;;;0CAG7D,8OAAC;0CACC,cAAA,8OAAC,kKAAK;oCACJ,OAAM;oCACN,MAAK;oCACL,aAAY;oCACZ,OAAO;oCACP,UAAU,CAAA,IAAK,mBAAmB,EAAE,MAAM,CAAC,KAAK;;;;;;;;;;;0CAGpD,8OAAC;0CACC,cAAA,8OAAC,kKAAK;oCACJ,OAAM;oCACN,MAAK;oCACL,aAAY;oCACZ,OAAO;oCACP,UAAU,CAAA,IAAK,mBAAmB,EAAE,MAAM,CAAC,KAAK;;;;;;;;;;;0CAGpD,8OAAC;0CACC,cAAA,8OAAC,yKAAW;oCACV,OAAM;oCACN,OAAO;oCACP,eAAe;8CAEd,sJAAU,CAAC,GAAG,CAAC,CAAA,sBACd,8OAAC,wKAAU;4CAAa,OAAO;sDAC5B;2CADc;;;;;;;;;;;;;;;;;;;;;;;;;;;YAU1B,uCACC,8OAAC,oLAAiB;gBAChB,WAAW;gBACX,iBAAiB;gBACjB,oBAAoB;gBACpB,oBAAoB;;;;;;;;;;;;AAK9B","debugId":null}},
    {"offset": {"line": 3172, "column": 0}, "map": {"version":3,"sources":["file:///home/irakli/Projects/RollKeeper/apps/web/src/components/ui/character/HitDiceTracker.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React from 'react';\r\nimport {\r\n  Dice1,\r\n  Dice2,\r\n  Dice3,\r\n  Dice4,\r\n  Dice5,\r\n  Dice6,\r\n  Moon,\r\n  RefreshCw,\r\n} from 'lucide-react';\r\nimport { Button } from '@/components/ui/forms';\r\nimport { HitDicePools } from '@/types/character';\r\n\r\ninterface HitDiceTrackerProps {\r\n  hitDicePools: HitDicePools;\r\n  onUseHitDie: (dieType: string, count?: number) => void;\r\n  onRestoreHitDice: (dieType: string, count?: number) => void;\r\n  onResetAllHitDice: () => void;\r\n}\r\n\r\n// Map die types to appropriate icons\r\nconst getDieIcon = (dieType: string) => {\r\n  const dieNumber = parseInt(dieType.replace('d', ''));\r\n  switch (dieNumber) {\r\n    case 4:\r\n      return <Dice1 size={20} />;\r\n    case 6:\r\n      return <Dice2 size={20} />;\r\n    case 8:\r\n      return <Dice3 size={20} />;\r\n    case 10:\r\n      return <Dice4 size={20} />;\r\n    case 12:\r\n      return <Dice5 size={20} />;\r\n    default:\r\n      return <Dice6 size={20} />;\r\n  }\r\n};\r\n\r\n// Get color scheme based on die type\r\nconst getDieColor = (dieType: string) => {\r\n  const dieNumber = parseInt(dieType.replace('d', ''));\r\n  switch (dieNumber) {\r\n    case 4:\r\n      return 'text-orange-600 bg-orange-50 border-orange-200';\r\n    case 6:\r\n      return 'text-purple-600 bg-purple-50 border-purple-200';\r\n    case 8:\r\n      return 'text-blue-600 bg-blue-50 border-blue-200';\r\n    case 10:\r\n      return 'text-green-600 bg-green-50 border-green-200';\r\n    case 12:\r\n      return 'text-red-600 bg-red-50 border-red-200';\r\n    default:\r\n      return 'text-gray-600 bg-gray-50 border-gray-200';\r\n  }\r\n};\r\n\r\n// Get dice button colors (filled vs empty)\r\nconst getDiceButtonColors = (dieType: string, isAvailable: boolean) => {\r\n  const dieNumber = parseInt(dieType.replace('d', ''));\r\n\r\n  if (isAvailable) {\r\n    // Filled dice - colored background with white text\r\n    switch (dieNumber) {\r\n      case 4:\r\n        return 'border-orange-500 bg-orange-500 text-white shadow-md hover:shadow-lg';\r\n      case 6:\r\n        return 'border-purple-500 bg-purple-500 text-white shadow-md hover:shadow-lg';\r\n      case 8:\r\n        return 'border-blue-500 bg-blue-500 text-white shadow-md hover:shadow-lg';\r\n      case 10:\r\n        return 'border-green-500 bg-green-500 text-white shadow-md hover:shadow-lg';\r\n      case 12:\r\n        return 'border-red-500 bg-red-500 text-white shadow-md hover:shadow-lg';\r\n      default:\r\n        return 'border-gray-500 bg-gray-500 text-white shadow-md hover:shadow-lg';\r\n    }\r\n  } else {\r\n    // Empty dice - just colored border\r\n    switch (dieNumber) {\r\n      case 4:\r\n        return 'border-orange-500 bg-transparent text-orange-500 hover:bg-orange-50';\r\n      case 6:\r\n        return 'border-purple-500 bg-transparent text-purple-500 hover:bg-purple-50';\r\n      case 8:\r\n        return 'border-blue-500 bg-transparent text-blue-500 hover:bg-blue-50';\r\n      case 10:\r\n        return 'border-green-500 bg-transparent text-green-500 hover:bg-green-50';\r\n      case 12:\r\n        return 'border-red-500 bg-transparent text-red-500 hover:bg-red-50';\r\n      default:\r\n        return 'border-gray-500 bg-transparent text-gray-500 hover:bg-gray-50';\r\n    }\r\n  }\r\n};\r\n\r\nexport default function HitDiceTracker({\r\n  hitDicePools,\r\n  onUseHitDie,\r\n  onRestoreHitDice,\r\n  onResetAllHitDice,\r\n}: HitDiceTrackerProps) {\r\n  const dieTypes = Object.keys(hitDicePools).sort((a, b) => {\r\n    const aNum = parseInt(a.replace('d', ''));\r\n    const bNum = parseInt(b.replace('d', ''));\r\n    return aNum - bNum;\r\n  });\r\n\r\n  if (dieTypes.length === 0) {\r\n    return (\r\n      <div className=\"rounded-lg border border-gray-200 bg-white p-6 shadow-sm\">\r\n        <h3 className=\"mb-4 text-lg font-semibold text-gray-900\">Hit Dice</h3>\r\n        <p className=\"text-sm text-gray-500\">\r\n          No hit dice available. Add class levels to gain hit dice.\r\n        </p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"rounded-xl border border-gray-200 bg-gradient-to-br from-white to-gray-50 p-6 shadow-lg\">\r\n      <div className=\"mb-6 flex items-center justify-between\">\r\n        <div className=\"flex items-center gap-3\">\r\n          <div className=\"rounded-lg bg-gradient-to-br from-red-500 to-red-600 p-2 shadow-md\">\r\n            <Dice6 size={20} className=\"text-white\" />\r\n          </div>\r\n          <h3 className=\"text-xl font-bold text-gray-900\">Hit Dice</h3>\r\n        </div>\r\n        <Button\r\n          onClick={onResetAllHitDice}\r\n          variant=\"secondary\"\r\n          size=\"sm\"\r\n          leftIcon={<Moon className=\"h-4 w-4\" />}\r\n          className=\"bg-blue-100 text-blue-700 hover:bg-blue-200\"\r\n          title=\"Long Rest (restore all hit dice - D&D 2024 rules)\"\r\n        >\r\n          Long Rest\r\n        </Button>\r\n      </div>\r\n\r\n      <div className=\"space-y-4\">\r\n        {dieTypes.map(dieType => {\r\n          const pool = hitDicePools[dieType];\r\n          const available = pool.max - pool.used;\r\n          const colorClasses = getDieColor(dieType);\r\n\r\n          return (\r\n            <div\r\n              key={dieType}\r\n              className={`rounded-xl border-2 p-5 shadow-md transition-all hover:shadow-lg ${colorClasses}`}\r\n            >\r\n              <div className=\"mb-4 flex items-center justify-between\">\r\n                <div className=\"flex items-center gap-3\">\r\n                  <div className=\"bg-opacity-80 rounded-lg bg-white p-2 shadow-sm\">\r\n                    {getDieIcon(dieType)}\r\n                  </div>\r\n                  <div>\r\n                    <span className=\"text-lg font-bold\">\r\n                      {dieType.toUpperCase()}\r\n                    </span>\r\n                    <div className=\"text-xs opacity-75\">Hit Dice</div>\r\n                  </div>\r\n                </div>\r\n                <div className=\"text-right\">\r\n                  <div className=\"text-lg font-bold\">\r\n                    {available} / {pool.max}\r\n                  </div>\r\n                  <div className=\"text-xs opacity-75\">available</div>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Visual representation of dice */}\r\n              <div className=\"mb-4 flex flex-wrap gap-2\">\r\n                {Array.from({ length: pool.max }, (_, index) => {\r\n                  const isAvailable = index < available;\r\n                  const dieNumber = index + 1;\r\n\r\n                  return (\r\n                    <button\r\n                      key={index}\r\n                      onClick={() => {\r\n                        if (isAvailable) {\r\n                          // If clicking on an available die, set available count to this position - 1\r\n                          // (so clicking die #6 leaves 5 available, spending die #6 and #7)\r\n                          const newUsed = pool.max - (dieNumber - 1);\r\n                          const diceToUse = newUsed - pool.used;\r\n                          if (diceToUse > 0) {\r\n                            onUseHitDie(dieType, diceToUse);\r\n                          }\r\n                        } else {\r\n                          // If clicking on a spent die, restore up to this position\r\n                          const newUsed = pool.max - dieNumber;\r\n                          const diceToRestore = pool.used - newUsed;\r\n                          if (diceToRestore > 0) {\r\n                            onRestoreHitDice(dieType, diceToRestore);\r\n                          }\r\n                        }\r\n                      }}\r\n                      className={`group relative h-8 w-8 rounded-lg border-2 text-xs font-bold transition-all duration-200 hover:scale-110 active:scale-95 ${getDiceButtonColors(dieType, isAvailable)}`}\r\n                      title={\r\n                        isAvailable\r\n                          ? `Click to set ${dieNumber - 1} available (use ${pool.max - (dieNumber - 1)} dice)`\r\n                          : `Click to set ${dieNumber} available (restore ${dieNumber - available} dice)`\r\n                      }\r\n                    >\r\n                      {/* Show number only for available dice, empty for spent */}\r\n                      {isAvailable ? dieNumber : ''}\r\n\r\n                      {/* Hover indicator showing target state */}\r\n                      <div\r\n                        className={`absolute -top-1 -right-1 flex h-3 w-3 items-center justify-center rounded-full text-[8px] font-bold transition-all duration-200 ${\r\n                          isAvailable\r\n                            ? 'scale-75 bg-red-500 text-white opacity-0 group-hover:scale-100 group-hover:opacity-100'\r\n                            : 'scale-75 bg-green-500 text-white opacity-0 group-hover:scale-100 group-hover:opacity-100'\r\n                        }`}\r\n                      >\r\n                        {isAvailable ? dieNumber - 1 : dieNumber}\r\n                      </div>\r\n                    </button>\r\n                  );\r\n                })}\r\n              </div>\r\n\r\n              {/* Controls */}\r\n              <div className=\"border-opacity-20 flex items-center justify-between border-t border-current pt-4\">\r\n                <div className=\"flex gap-2\">\r\n                  <Button\r\n                    onClick={() => onUseHitDie(dieType, 1)}\r\n                    disabled={available === 0}\r\n                    variant=\"outline\"\r\n                    size=\"xs\"\r\n                    className=\"bg-opacity-90 hover:bg-opacity-100 bg-white\"\r\n                  >\r\n                    Use 1\r\n                  </Button>\r\n                  {available > 1 && (\r\n                    <Button\r\n                      onClick={() =>\r\n                        onUseHitDie(dieType, Math.min(available, 5))\r\n                      }\r\n                      variant=\"outline\"\r\n                      size=\"xs\"\r\n                      className=\"bg-opacity-90 hover:bg-opacity-100 bg-white\"\r\n                    >\r\n                      Use {Math.min(available, 5)}\r\n                    </Button>\r\n                  )}\r\n                </div>\r\n\r\n                <div className=\"flex gap-2\">\r\n                  {pool.used > 0 && (\r\n                    <>\r\n                      <Button\r\n                        onClick={() => onRestoreHitDice(dieType, 1)}\r\n                        variant=\"outline\"\r\n                        size=\"xs\"\r\n                        className=\"bg-opacity-90 hover:bg-opacity-100 bg-white\"\r\n                      >\r\n                        Restore 1\r\n                      </Button>\r\n                      <Button\r\n                        onClick={() => onRestoreHitDice(dieType, pool.used)}\r\n                        variant=\"outline\"\r\n                        size=\"xs\"\r\n                        leftIcon={<RefreshCw className=\"h-3 w-3\" />}\r\n                        className=\"bg-opacity-90 hover:bg-opacity-100 bg-white\"\r\n                      >\r\n                        All\r\n                      </Button>\r\n                    </>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          );\r\n        })}\r\n      </div>\r\n\r\n      <div className=\"mt-6 rounded-xl border border-blue-200 bg-gradient-to-r from-blue-50 to-indigo-50 p-4\">\r\n        <div className=\"flex items-start gap-3\">\r\n          <div className=\"mt-0.5 rounded-lg bg-blue-100 p-2\">\r\n            <svg\r\n              className=\"h-4 w-4 text-blue-600\"\r\n              fill=\"none\"\r\n              viewBox=\"0 0 24 24\"\r\n              stroke=\"currentColor\"\r\n            >\r\n              <path\r\n                strokeLinecap=\"round\"\r\n                strokeLinejoin=\"round\"\r\n                strokeWidth={2}\r\n                d=\"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\"\r\n              />\r\n            </svg>\r\n          </div>\r\n          <div className=\"flex-1\">\r\n            <h4 className=\"mb-2 font-medium text-blue-900\">\r\n              How to Use Hit Dice\r\n            </h4>\r\n            <div className=\"space-y-1 text-sm text-blue-800\">\r\n              <p>\r\n                <strong>Click any die:</strong> Use/restore all dice from that\r\n                position to the end\r\n              </p>\r\n              <p>\r\n                <strong>Short Rest:</strong> Spend hit dice to regain HP (roll\r\n                die + CON modifier)\r\n              </p>\r\n              <p>\r\n                <strong>Long Rest:</strong> Regain all your max hit dice\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 3758, "column": 0}, "map": {"version":3,"sources":["file:///home/irakli/Projects/RollKeeper/apps/web/src/components/ui/character/RestManager.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React from 'react';\r\nimport { Moon, Sun } from 'lucide-react';\r\nimport { Button } from '@/components/ui/forms';\r\n\r\ninterface RestManagerProps {\r\n  onShortRest: () => void;\r\n  onLongRest: () => void;\r\n  onShowShortRestToast?: () => void;\r\n  onShowLongRestToast?: () => void;\r\n  className?: string;\r\n}\r\n\r\nexport default function RestManager({\r\n  onShortRest,\r\n  onLongRest,\r\n  onShowShortRestToast,\r\n  onShowLongRestToast,\r\n  className = '',\r\n}: RestManagerProps) {\r\n  const handleShortRest = () => {\r\n    onShortRest();\r\n    onShowShortRestToast?.();\r\n  };\r\n\r\n  const handleLongRest = () => {\r\n    onLongRest();\r\n    onShowLongRestToast?.();\r\n  };\r\n\r\n  return (\r\n    <div className={className}>\r\n      <p className=\"mb-4 text-sm text-gray-600\">\r\n        Take a rest to restore your character&apos;s resources, abilities, and hit points.\r\n      </p>\r\n\r\n      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n        {/* Short Rest */}\r\n        <div className=\"flex flex-col rounded-lg border-2 border-blue-200 bg-gradient-to-br from-blue-50 to-cyan-50 p-4 shadow-sm\">\r\n          <div className=\"mb-3 flex items-center gap-2\">\r\n            <div className=\"rounded-lg bg-gradient-to-br from-blue-500 to-cyan-600 p-2 shadow-md\">\r\n              <Sun size={20} className=\"text-white\" />\r\n            </div>\r\n            <h4 className=\"text-lg font-semibold text-blue-900\">Short Rest</h4>\r\n          </div>\r\n          \r\n          <div className=\"mb-4 flex-1 space-y-1 text-xs text-blue-800\">\r\n            <p>â€¢ Restores short rest abilities</p>\r\n            <p>â€¢ Restores Pact Magic slots (Warlock)</p>\r\n            <p>â€¢ Resets reaction usage</p>\r\n            <p>â€¢ Spend Hit Dice to heal (manual)</p>\r\n          </div>\r\n\r\n          <Button\r\n            onClick={handleShortRest}\r\n            fullWidth\r\n            variant=\"secondary\"\r\n            size=\"md\"\r\n            leftIcon={<Sun className=\"h-4 w-4\" />}\r\n            className=\"bg-gradient-to-r from-blue-500 to-cyan-600 hover:from-blue-600 hover:to-cyan-700\"\r\n          >\r\n            Take Short Rest\r\n          </Button>\r\n        </div>\r\n\r\n        {/* Long Rest */}\r\n        <div className=\"flex flex-col rounded-lg border-2 border-indigo-200 bg-gradient-to-br from-indigo-50 to-purple-50 p-4 shadow-sm\">\r\n          <div className=\"mb-3 flex items-center gap-2\">\r\n            <div className=\"rounded-lg bg-gradient-to-br from-indigo-500 to-purple-600 p-2 shadow-md\">\r\n              <Moon size={20} className=\"text-white\" />\r\n            </div>\r\n            <h4 className=\"text-lg font-semibold text-indigo-900\">Long Rest</h4>\r\n          </div>\r\n          \r\n          <div className=\"mb-4 flex-1 space-y-1 text-xs text-indigo-800\">\r\n            <p>â€¢ Restores ALL abilities</p>\r\n            <p>â€¢ Restores ALL spell slots</p>\r\n            <p>â€¢ Restores ALL hit dice</p>\r\n            <p>â€¢ Heals to full HP</p>\r\n            <p>â€¢ Clears temp HP & temp AC</p>\r\n            <p>â€¢ Resets reaction & death saves</p>\r\n          </div>\r\n\r\n          <Button\r\n            onClick={handleLongRest}\r\n            fullWidth\r\n            variant=\"secondary\"\r\n            size=\"md\"\r\n            leftIcon={<Moon className=\"h-4 w-4\" />}\r\n            className=\"bg-gradient-to-r from-indigo-500 to-purple-600 hover:from-indigo-600 hover:to-purple-700\"\r\n          >\r\n            Take Long Rest\r\n          </Button>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"mt-4 rounded-lg bg-gradient-to-r from-amber-50 to-yellow-50 border border-amber-200 p-3\">\r\n        <p className=\"text-xs text-amber-900\">\r\n          <strong>Note:</strong> Individual reset buttons in each section still work independently if you need fine-grained control.\r\n        </p>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n"],"names":[],"mappings":";;;;;AAGA;AAAA;AACA;AAAA;AAJA;;;;AAce,SAAS,YAAY,EAClC,WAAW,EACX,UAAU,EACV,oBAAoB,EACpB,mBAAmB,EACnB,YAAY,EAAE,EACG;IACjB,MAAM,kBAAkB;QACtB;QACA;IACF;IAEA,MAAM,iBAAiB;QACrB;QACA;IACF;IAEA,qBACE,8OAAC;QAAI,WAAW;;0BACd,8OAAC;gBAAE,WAAU;0BAA6B;;;;;;0BAI1C,8OAAC;gBAAI,WAAU;;kCAEb,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;gCAAI,WAAU;;kDACb,8OAAC;wCAAI,WAAU;kDACb,cAAA,8OAAC,uMAAG;4CAAC,MAAM;4CAAI,WAAU;;;;;;;;;;;kDAE3B,8OAAC;wCAAG,WAAU;kDAAsC;;;;;;;;;;;;0CAGtD,8OAAC;gCAAI,WAAU;;kDACb,8OAAC;kDAAE;;;;;;kDACH,8OAAC;kDAAE;;;;;;kDACH,8OAAC;kDAAE;;;;;;kDACH,8OAAC;kDAAE;;;;;;;;;;;;0CAGL,8OAAC,oLAAM;gCACL,SAAS;gCACT,SAAS;gCACT,SAAQ;gCACR,MAAK;gCACL,wBAAU,8OAAC,uMAAG;oCAAC,WAAU;;;;;;gCACzB,WAAU;0CACX;;;;;;;;;;;;kCAMH,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;gCAAI,WAAU;;kDACb,8OAAC;wCAAI,WAAU;kDACb,cAAA,8OAAC,0MAAI;4CAAC,MAAM;4CAAI,WAAU;;;;;;;;;;;kDAE5B,8OAAC;wCAAG,WAAU;kDAAwC;;;;;;;;;;;;0CAGxD,8OAAC;gCAAI,WAAU;;kDACb,8OAAC;kDAAE;;;;;;kDACH,8OAAC;kDAAE;;;;;;kDACH,8OAAC;kDAAE;;;;;;kDACH,8OAAC;kDAAE;;;;;;kDACH,8OAAC;kDAAE;;;;;;kDACH,8OAAC;kDAAE;;;;;;;;;;;;0CAGL,8OAAC,oLAAM;gCACL,SAAS;gCACT,SAAS;gCACT,SAAQ;gCACR,MAAK;gCACL,wBAAU,8OAAC,0MAAI;oCAAC,WAAU;;;;;;gCAC1B,WAAU;0CACX;;;;;;;;;;;;;;;;;;0BAML,8OAAC;gBAAI,WAAU;0BACb,cAAA,8OAAC;oBAAE,WAAU;;sCACX,8OAAC;sCAAO;;;;;;wBAAc;;;;;;;;;;;;;;;;;;AAKhC","debugId":null}},
    {"offset": {"line": 4043, "column": 0}, "map": {"version":3,"sources":["file:///home/irakli/Projects/RollKeeper/apps/web/src/components/ui/character/DaysSpentTracker.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React, { useState, useCallback } from 'react';\r\nimport {\r\n  Calendar,\r\n  Plus,\r\n  Minus,\r\n  Edit2,\r\n  Check,\r\n  X,\r\n  Moon,\r\n  Info,\r\n} from 'lucide-react';\r\nimport { Button } from '@/components/ui/forms';\r\nimport { Input } from '@/components/ui/forms';\r\n\r\ninterface DaysSpentTrackerProps {\r\n  daysSpent: number;\r\n  onUpdateDays: (days: number) => void;\r\n  onIncrementDays: (amount?: number) => void;\r\n  className?: string;\r\n}\r\n\r\nexport default function DaysSpentTracker({\r\n  daysSpent,\r\n  onUpdateDays,\r\n  onIncrementDays,\r\n  className = '',\r\n}: DaysSpentTrackerProps) {\r\n  const [isEditing, setIsEditing] = useState(false);\r\n  const [editValue, setEditValue] = useState('');\r\n  const [showQuickAdd, setShowQuickAdd] = useState(false);\r\n\r\n  const weeks = Math.floor(daysSpent / 7);\r\n  const remainingDays = daysSpent % 7;\r\n\r\n  const handleStartEdit = useCallback(() => {\r\n    setEditValue(daysSpent.toString());\r\n    setIsEditing(true);\r\n  }, [daysSpent]);\r\n\r\n  const handleConfirmEdit = useCallback(() => {\r\n    const newValue = parseInt(editValue, 10);\r\n    if (!isNaN(newValue) && newValue >= 0) {\r\n      onUpdateDays(newValue);\r\n    }\r\n    setIsEditing(false);\r\n  }, [editValue, onUpdateDays]);\r\n\r\n  const handleCancelEdit = useCallback(() => {\r\n    setIsEditing(false);\r\n    setEditValue('');\r\n  }, []);\r\n\r\n  const handleKeyDown = useCallback(\r\n    (e: React.KeyboardEvent) => {\r\n      if (e.key === 'Enter') {\r\n        handleConfirmEdit();\r\n      } else if (e.key === 'Escape') {\r\n        handleCancelEdit();\r\n      }\r\n    },\r\n    [handleConfirmEdit, handleCancelEdit]\r\n  );\r\n\r\n  const handleQuickAdd = (amount: number) => {\r\n    onIncrementDays(amount);\r\n    setShowQuickAdd(false);\r\n  };\r\n\r\n  return (\r\n    <div\r\n      className={`rounded-xl border-2 border-amber-200 bg-gradient-to-r from-amber-50 via-orange-50 to-yellow-50 p-4 shadow-md ${className}`}\r\n    >\r\n      {/* Main horizontal layout */}\r\n      <div className=\"flex flex-col gap-4 md:flex-row md:items-center md:justify-between\">\r\n        {/* Left: Title + Day count */}\r\n        <div className=\"flex items-center gap-4\">\r\n          <div className=\"rounded-lg bg-gradient-to-br from-amber-500 to-orange-600 p-2.5 shadow-md\">\r\n            <Calendar size={22} className=\"text-white\" />\r\n          </div>\r\n\r\n          <div className=\"flex items-center gap-4\">\r\n            <div>\r\n              <h3 className=\"text-sm font-semibold text-amber-800\">\r\n                Campaign Days\r\n              </h3>\r\n              <p className=\"text-xs text-amber-600\">\r\n                {weeks > 0 ? (\r\n                  <span>\r\n                    {weeks} {weeks === 1 ? 'week' : 'weeks'}\r\n                    {remainingDays > 0 &&\r\n                      `, ${remainingDays} ${remainingDays === 1 ? 'day' : 'days'}`}\r\n                  </span>\r\n                ) : (\r\n                  <span>\r\n                    {daysSpent} {daysSpent === 1 ? 'day' : 'days'} elapsed\r\n                  </span>\r\n                )}\r\n              </p>\r\n            </div>\r\n\r\n            {/* Day count display/edit */}\r\n            {isEditing ? (\r\n              <div className=\"flex items-center gap-2\">\r\n                <Input\r\n                  type=\"number\"\r\n                  min=\"0\"\r\n                  value={editValue}\r\n                  onChange={e => setEditValue(e.target.value)}\r\n                  onKeyDown={handleKeyDown}\r\n                  className=\"w-24 text-center text-xl font-bold\"\r\n                  autoFocus\r\n                />\r\n                <Button\r\n                  onClick={handleConfirmEdit}\r\n                  variant=\"success\"\r\n                  size=\"sm\"\r\n                  title=\"Confirm\"\r\n                >\r\n                  <Check size={16} />\r\n                </Button>\r\n                <Button\r\n                  onClick={handleCancelEdit}\r\n                  variant=\"ghost\"\r\n                  size=\"sm\"\r\n                  title=\"Cancel\"\r\n                >\r\n                  <X size={16} />\r\n                </Button>\r\n              </div>\r\n            ) : (\r\n              <div className=\"flex items-center gap-2 rounded-lg border-2 border-amber-300 bg-white px-4 py-2 shadow-inner\">\r\n                <span className=\"text-3xl font-bold text-amber-800\">\r\n                  {daysSpent}\r\n                </span>\r\n                <Button\r\n                  onClick={handleStartEdit}\r\n                  variant=\"ghost\"\r\n                  size=\"xs\"\r\n                  title=\"Edit days manually\"\r\n                  className=\"text-amber-600 hover:bg-amber-100\"\r\n                >\r\n                  <Edit2 size={14} />\r\n                </Button>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Center: Controls */}\r\n        <div className=\"flex flex-wrap items-center justify-center gap-2\">\r\n          <Button\r\n            onClick={() => onIncrementDays(-1)}\r\n            disabled={daysSpent === 0}\r\n            variant=\"outline\"\r\n            size=\"sm\"\r\n            className=\"border-amber-300 bg-white text-amber-700 hover:bg-amber-50\"\r\n            title=\"Subtract 1 day\"\r\n          >\r\n            <Minus size={16} />\r\n          </Button>\r\n\r\n          <Button\r\n            onClick={() => onIncrementDays(1)}\r\n            variant=\"secondary\"\r\n            size=\"sm\"\r\n            leftIcon={<Plus size={14} />}\r\n            className=\"bg-gradient-to-r from-amber-500 to-orange-600 text-white hover:from-amber-600 hover:to-orange-700\"\r\n            title=\"Add 1 day\"\r\n          >\r\n            +1 Day\r\n          </Button>\r\n\r\n          <div className=\"relative\">\r\n            <Button\r\n              onClick={() => setShowQuickAdd(!showQuickAdd)}\r\n              variant=\"outline\"\r\n              size=\"sm\"\r\n              className=\"border-amber-300 bg-white text-amber-700 hover:bg-amber-50\"\r\n              title=\"Quick add multiple days\"\r\n            >\r\n              <Plus size={14} />\r\n              <span className=\"ml-1\">More</span>\r\n            </Button>\r\n\r\n            {/* Quick add dropdown - opens upward */}\r\n            {showQuickAdd && (\r\n              <div className=\"absolute bottom-full left-0 z-10 mb-1 w-48 rounded-lg border border-amber-200 bg-white p-2 shadow-lg\">\r\n                <p className=\"mb-2 text-center text-xs font-medium text-amber-800\">\r\n                  Quick Add\r\n                </p>\r\n                <div className=\"grid grid-cols-2 gap-1\">\r\n                  {[\r\n                    { amount: 3, label: '+3 days' },\r\n                    { amount: 7, label: '+1 week' },\r\n                    { amount: 14, label: '+2 weeks' },\r\n                    { amount: 30, label: '+1 month' },\r\n                  ].map(({ amount, label }) => (\r\n                    <Button\r\n                      key={amount}\r\n                      onClick={() => handleQuickAdd(amount)}\r\n                      variant=\"ghost\"\r\n                      size=\"xs\"\r\n                      className=\"justify-center text-amber-700 hover:bg-amber-100\"\r\n                    >\r\n                      {label}\r\n                    </Button>\r\n                  ))}\r\n                </div>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Right: Info */}\r\n        <div className=\"flex items-center gap-2 rounded-lg bg-amber-100/50 px-3 py-2\">\r\n          <Info size={14} className=\"flex-shrink-0 text-amber-600\" />\r\n          <p className=\"text-xs text-amber-700\">\r\n            <Moon size={10} className=\"mr-1 inline text-indigo-500\" />\r\n            Auto +1 on Long Rest\r\n          </p>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Click outside to close quick add */}\r\n      {showQuickAdd && (\r\n        <div\r\n          className=\"fixed inset-0 z-0\"\r\n          onClick={() => setShowQuickAdd(false)}\r\n        />\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 4477, "column": 0}, "map": {"version":3,"sources":["file:///home/irakli/Projects/RollKeeper/apps/web/src/components/ui/character/AbilityScores.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useState } from 'react';\r\nimport { ABILITY_ABBREVIATIONS, ABILITY_NAMES } from '@/utils/constants';\r\nimport {\r\n  calculateModifier,\r\n  getProficiencyBonus,\r\n  formatModifier,\r\n} from '@/utils/calculations';\r\nimport { Button, Input } from '@/components/ui/forms';\r\nimport { Badge } from '@/components/ui/layout';\r\nimport { AbilityName, CharacterState } from '@/types/character';\r\nimport { Dices } from 'lucide-react';\r\n\r\ninterface AbilityScoresProps {\r\n  abilities: CharacterState['abilities'];\r\n  characterLevel: number;\r\n  onUpdateAbilityScore: (ability: AbilityName, value: number) => void;\r\n  onRollAbilityCheck: (ability: AbilityName) => void;\r\n}\r\n\r\nexport default function AbilityScores({\r\n  abilities,\r\n  characterLevel,\r\n  onUpdateAbilityScore,\r\n  onRollAbilityCheck,\r\n}: AbilityScoresProps) {\r\n  const proficiencyBonus = getProficiencyBonus(characterLevel);\r\n\r\n  // Local state for input values to allow free editing\r\n  const [editingValues, setEditingValues] = useState<\r\n    Record<AbilityName, string>\r\n  >({} as Record<AbilityName, string>);\r\n\r\n  const getAbilityModifier = (ability: AbilityName) => {\r\n    return calculateModifier(abilities[ability]);\r\n  };\r\n\r\n  const getModifierVariant = (modifier: number) => {\r\n    if (modifier >= 4) return 'success';\r\n    if (modifier >= 2) return 'info';\r\n    if (modifier >= 0) return 'neutral';\r\n    if (modifier >= -2) return 'warning';\r\n    return 'danger';\r\n  };\r\n\r\n  return (\r\n    <div className=\"rounded-lg border-2 border-emerald-200 bg-gradient-to-br from-emerald-50 to-teal-50 p-6 shadow-sm\">\r\n      <h2 className=\"mb-4 flex items-center gap-2 text-lg font-bold text-emerald-800\">\r\n        <Dices className=\"h-5 w-5\" />\r\n        Ability Scores\r\n      </h2>\r\n      <div className=\"grid grid-cols-2 gap-3 sm:grid-cols-2 sm:gap-4 lg:grid-cols-2\">\r\n        {(Object.keys(ABILITY_ABBREVIATIONS) as AbilityName[]).map(ability => {\r\n          const modifier = getAbilityModifier(ability);\r\n          return (\r\n            <div key={ability} className=\"text-center\">\r\n              <div className=\"rounded-lg border-2 border-emerald-300 bg-white p-4 transition-all hover:border-emerald-400 hover:shadow-md\">\r\n                <div className=\"mb-2 text-sm font-bold tracking-wide text-emerald-700 uppercase\">\r\n                  {ABILITY_ABBREVIATIONS[ability]}\r\n                </div>\r\n                <Input\r\n                  type=\"number\"\r\n                  value={\r\n                    editingValues[ability] ?? abilities[ability].toString()\r\n                  }\r\n                  onChange={e => {\r\n                    // Allow any input including empty string\r\n                    setEditingValues(prev => ({\r\n                      ...prev,\r\n                      [ability]: e.target.value,\r\n                    }));\r\n                  }}\r\n                  onFocus={e => {\r\n                    // Select all on focus for easy replacement\r\n                    e.target.select();\r\n                  }}\r\n                  onBlur={e => {\r\n                    // On blur, validate and update\r\n                    const value = e.target.value;\r\n                    let numValue: number;\r\n\r\n                    if (value === '' || isNaN(parseInt(value))) {\r\n                      numValue = 10; // Default\r\n                    } else {\r\n                      numValue = parseInt(value);\r\n                      // Clamp between 1 and 30\r\n                      numValue = Math.max(1, Math.min(30, numValue));\r\n                    }\r\n\r\n                    onUpdateAbilityScore(ability, numValue);\r\n\r\n                    // Clear editing state\r\n                    setEditingValues(prev => {\r\n                      const newState = { ...prev };\r\n                      delete newState[ability];\r\n                      return newState;\r\n                    });\r\n                  }}\r\n                  onKeyDown={e => {\r\n                    // Submit on Enter\r\n                    if (e.key === 'Enter') {\r\n                      e.currentTarget.blur();\r\n                    }\r\n                  }}\r\n                  min=\"1\"\r\n                  max=\"30\"\r\n                  size=\"lg\"\r\n                  className=\"[appearance:textfield] border-none bg-transparent text-center text-3xl font-bold text-gray-900 [&::-webkit-inner-spin-button]:appearance-none [&::-webkit-outer-spin-button]:appearance-none\"\r\n                />\r\n                <Badge\r\n                  variant={getModifierVariant(modifier)}\r\n                  size=\"lg\"\r\n                  className=\"mt-2 text-base font-bold\"\r\n                >\r\n                  {formatModifier(modifier)}\r\n                </Badge>\r\n                <div className=\"mt-1 text-xs text-gray-500\">modifier</div>\r\n                <Button\r\n                  onClick={() => onRollAbilityCheck(ability)}\r\n                  variant=\"ghost\"\r\n                  size=\"xs\"\r\n                  className=\"mt-2 w-full text-emerald-600 hover:bg-emerald-100\"\r\n                  leftIcon={<Dices className=\"h-3 w-3\" />}\r\n                  title={`Roll ${ABILITY_NAMES[ability]} check (d20 + ${formatModifier(modifier)})`}\r\n                >\r\n                  Roll\r\n                </Button>\r\n              </div>\r\n            </div>\r\n          );\r\n        })}\r\n      </div>\r\n      <div className=\"mt-4 rounded-lg border-2 border-indigo-300 bg-gradient-to-r from-indigo-100 to-purple-100 p-4 shadow-sm\">\r\n        <div className=\"flex items-center justify-between\">\r\n          <span className=\"text-sm font-semibold text-indigo-900\">\r\n            Proficiency Bonus:\r\n          </span>\r\n          <Badge variant=\"secondary\" size=\"lg\" className=\"text-base font-bold\">\r\n            {formatModifier(proficiencyBonus)}\r\n          </Badge>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 4699, "column": 0}, "map": {"version":3,"sources":["file:///home/irakli/Projects/RollKeeper/apps/web/src/components/ui/character/ArmorClassManager.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { calculateCharacterArmorClass } from '@/utils/calculations';\r\nimport { Input } from '@/components/ui/forms';\r\nimport { CharacterState } from '@/types/character';\r\nimport { Tooltip, TooltipProvider } from '@/components/ui/primitives/Tooltip';\r\nimport { Info } from 'lucide-react';\r\nimport { useState, useEffect } from 'react';\r\n\r\ninterface ArmorClassManagerProps {\r\n  character: CharacterState;\r\n  onUpdateArmorClass: (ac: number) => void;\r\n  onUpdateTempArmorClass: (tempAC: number) => void;\r\n  onToggleShield: () => void;\r\n  onUpdateShieldBonus: (bonus: number) => void;\r\n}\r\n\r\nexport default function ArmorClassManager({\r\n  character,\r\n  onUpdateArmorClass,\r\n  onUpdateTempArmorClass,\r\n  onToggleShield,\r\n  onUpdateShieldBonus,\r\n}: ArmorClassManagerProps) {\r\n  // Local state for input values to allow empty strings during editing\r\n  const [baseACInput, setBaseACInput] = useState(\r\n    character.armorClass.toString()\r\n  );\r\n  const [tempACInput, setTempACInput] = useState(\r\n    character.tempArmorClass.toString()\r\n  );\r\n  const [shieldBonusInput, setShieldBonusInput] = useState(\r\n    character.shieldBonus.toString()\r\n  );\r\n  const [isTempACActive, setIsTempACActive] = useState(\r\n    character.tempArmorClass > 0\r\n  );\r\n\r\n  // Update local state when character data changes externally\r\n  useEffect(() => {\r\n    setBaseACInput(character.armorClass.toString());\r\n  }, [character.armorClass]);\r\n\r\n  useEffect(() => {\r\n    setTempACInput(character.tempArmorClass.toString());\r\n    setIsTempACActive(character.tempArmorClass > 0);\r\n  }, [character.tempArmorClass]);\r\n\r\n  useEffect(() => {\r\n    setShieldBonusInput(character.shieldBonus.toString());\r\n  }, [character.shieldBonus]);\r\n\r\n  // Handlers for Base AC\r\n  const handleBaseACChange = (value: string) => {\r\n    setBaseACInput(value);\r\n  };\r\n\r\n  const handleBaseACBlur = () => {\r\n    const numValue = parseInt(baseACInput);\r\n    const finalValue = isNaN(numValue) ? 10 : numValue;\r\n    const clampedValue = Math.max(0, Math.min(30, finalValue));\r\n    setBaseACInput(clampedValue.toString());\r\n    onUpdateArmorClass(clampedValue);\r\n  };\r\n\r\n  const handleBaseACKeyDown = (e: React.KeyboardEvent<HTMLInputElement>) => {\r\n    if (e.key === 'Enter') {\r\n      e.currentTarget.blur();\r\n    }\r\n  };\r\n\r\n  // Handlers for Temp AC\r\n  const handleTempACChange = (value: string) => {\r\n    setTempACInput(value);\r\n  };\r\n\r\n  const handleTempACBlur = () => {\r\n    const numValue = parseInt(tempACInput);\r\n    const finalValue = isNaN(numValue) ? 0 : numValue;\r\n    const clampedValue = Math.max(0, Math.min(20, finalValue));\r\n    setTempACInput(clampedValue.toString());\r\n    onUpdateTempArmorClass(clampedValue);\r\n    if (clampedValue === 0) {\r\n      setIsTempACActive(false);\r\n    }\r\n  };\r\n\r\n  const handleTempACKeyDown = (e: React.KeyboardEvent<HTMLInputElement>) => {\r\n    if (e.key === 'Enter') {\r\n      e.currentTarget.blur();\r\n    }\r\n  };\r\n\r\n  const handleToggleTempAC = () => {\r\n    if (isTempACActive) {\r\n      // Deactivating - reset to 0\r\n      setTempACInput('0');\r\n      onUpdateTempArmorClass(0);\r\n      setIsTempACActive(false);\r\n    } else {\r\n      // Activating - set to 1 or keep current value\r\n      const currentValue = parseInt(tempACInput) || 0;\r\n      if (currentValue === 0) {\r\n        setTempACInput('1');\r\n        onUpdateTempArmorClass(1);\r\n      }\r\n      setIsTempACActive(true);\r\n    }\r\n  };\r\n\r\n  // Handlers for Shield Bonus\r\n  const handleShieldBonusChange = (value: string) => {\r\n    setShieldBonusInput(value);\r\n  };\r\n\r\n  const handleShieldBonusBlur = () => {\r\n    const numValue = parseInt(shieldBonusInput);\r\n    const finalValue = isNaN(numValue) ? 2 : numValue;\r\n    const clampedValue = Math.max(0, Math.min(5, finalValue));\r\n    setShieldBonusInput(clampedValue.toString());\r\n    onUpdateShieldBonus(clampedValue);\r\n  };\r\n\r\n  const handleShieldBonusKeyDown = (\r\n    e: React.KeyboardEvent<HTMLInputElement>\r\n  ) => {\r\n    if (e.key === 'Enter') {\r\n      e.currentTarget.blur();\r\n    }\r\n  };\r\n\r\n  return (\r\n    <TooltipProvider>\r\n      <div className=\"mb-6\">\r\n        <div className=\"rounded-xl border-2 border-red-200 bg-linear-to-r from-red-50 to-red-100 p-6\">\r\n          <div className=\"mb-6 text-center\">\r\n            <h3 className=\"mb-3 flex items-center justify-center gap-2 text-xl font-bold text-red-800\">\r\n              ðŸ›¡ï¸ ARMOR CLASS\r\n            </h3>\r\n            <div className=\"mb-2 text-5xl font-bold text-red-900\">\r\n              {calculateCharacterArmorClass(character)}\r\n            </div>\r\n            <div className=\"text-base font-medium text-red-700\">Total AC</div>\r\n          </div>\r\n\r\n          {/* AC Components - Row Layout with Better Alignment */}\r\n          <div className=\"mb-6 space-y-4\">\r\n            {/* Base AC Row */}\r\n            <div className=\"rounded-lg border-2 border-red-300 bg-white p-4 shadow-sm\">\r\n              <div className=\"flex items-center justify-between gap-3\">\r\n                <div className=\"flex min-w-[140px] items-center gap-1.5\">\r\n                  <div className=\"text-lg font-bold text-red-800\">Base AC</div>\r\n                  <Tooltip content=\"From armor & dexterity modifier\">\r\n                    <span className=\"cursor-help text-red-400 transition-colors hover:text-red-600\">\r\n                      <Info size={16} />\r\n                    </span>\r\n                  </Tooltip>\r\n                </div>\r\n                <Input\r\n                  type=\"number\"\r\n                  value={baseACInput}\r\n                  onChange={e => handleBaseACChange(e.target.value)}\r\n                  onBlur={handleBaseACBlur}\r\n                  onKeyDown={handleBaseACKeyDown}\r\n                  className=\"h-12 w-20 [appearance:textfield] border-2 border-red-300 bg-red-50 text-center text-2xl font-bold text-red-900 focus:border-red-500 [&::-webkit-inner-spin-button]:appearance-none [&::-webkit-outer-spin-button]:appearance-none\"\r\n                  min=\"0\"\r\n                  max=\"30\"\r\n                />\r\n              </div>\r\n            </div>\r\n\r\n            {/* Temporary AC Row */}\r\n            <div\r\n              className={`rounded-lg border-2 bg-white p-4 shadow-sm transition-all duration-200 ${\r\n                isTempACActive\r\n                  ? 'border-orange-500 bg-orange-50/50'\r\n                  : 'border-orange-300 hover:border-orange-400'\r\n              }`}\r\n            >\r\n              <div className=\"flex items-center justify-between gap-3\">\r\n                <div className=\"flex min-w-[140px] items-center gap-1.5\">\r\n                  <Tooltip\r\n                    content={`Click to ${isTempACActive ? 'deactivate and reset' : 'activate'} temporary AC`}\r\n                  >\r\n                    <button\r\n                      type=\"button\"\r\n                      onClick={handleToggleTempAC}\r\n                      className={`flex items-center gap-2 text-lg font-bold transition-opacity hover:opacity-80 ${\r\n                        isTempACActive ? 'text-orange-700' : 'text-orange-800'\r\n                      }`}\r\n                    >\r\n                      <span>Temp AC</span>\r\n                      {/* {isTempACActive && <span className=\"text-xl\">âœ¨</span>} */}\r\n                    </button>\r\n                  </Tooltip>\r\n                  <Tooltip content=\"Bonuses from spells & temporary magical effects\">\r\n                    <span className=\"cursor-help text-orange-400 transition-colors hover:text-orange-600\">\r\n                      <Info size={16} />\r\n                    </span>\r\n                  </Tooltip>\r\n                </div>\r\n                <Input\r\n                  type=\"number\"\r\n                  value={tempACInput}\r\n                  onChange={e => handleTempACChange(e.target.value)}\r\n                  onBlur={handleTempACBlur}\r\n                  onKeyDown={handleTempACKeyDown}\r\n                  disabled={!isTempACActive}\r\n                  className={`h-12 w-20 [appearance:textfield] border-2 text-center text-2xl font-bold focus:border-orange-500 [&::-webkit-inner-spin-button]:appearance-none [&::-webkit-outer-spin-button]:appearance-none ${\r\n                    isTempACActive\r\n                      ? 'border-orange-300 bg-orange-50 text-orange-900'\r\n                      : 'border-gray-200 bg-gray-50 text-gray-400'\r\n                  }`}\r\n                  min=\"0\"\r\n                  max=\"20\"\r\n                />\r\n              </div>\r\n            </div>\r\n\r\n            {/* Shield Row */}\r\n            <div\r\n              className={`rounded-lg border-2 bg-white p-4 shadow-sm transition-all duration-200 ${\r\n                character.isWearingShield\r\n                  ? 'border-blue-500 bg-blue-50/50'\r\n                  : 'border-blue-300 hover:border-blue-400'\r\n              }`}\r\n            >\r\n              <div className=\"flex items-center justify-between gap-3\">\r\n                <div className=\"flex min-w-[140px] items-center gap-1.5\">\r\n                  <Tooltip\r\n                    content={`Click to ${character.isWearingShield ? 'unequip' : 'equip'} shield`}\r\n                  >\r\n                    <button\r\n                      type=\"button\"\r\n                      onClick={onToggleShield}\r\n                      className={`flex items-center gap-2 text-lg font-bold transition-opacity hover:opacity-80 ${\r\n                        character.isWearingShield\r\n                          ? 'text-blue-700'\r\n                          : 'text-blue-800'\r\n                      }`}\r\n                    >\r\n                      <span>Shield +</span>\r\n                      {/* {character.isWearingShield && (\r\n                        <span className=\"text-2xl\">ðŸ›¡ï¸</span>\r\n                      )} */}\r\n                    </button>\r\n                  </Tooltip>\r\n                  <Tooltip content=\"Shield bonus to AC (typically +2, or more for magical shields)\">\r\n                    <span className=\"cursor-help text-blue-400 transition-colors hover:text-blue-600\">\r\n                      <Info size={16} />\r\n                    </span>\r\n                  </Tooltip>\r\n                </div>\r\n                <Input\r\n                  type=\"number\"\r\n                  value={shieldBonusInput}\r\n                  onChange={e => handleShieldBonusChange(e.target.value)}\r\n                  onBlur={handleShieldBonusBlur}\r\n                  onKeyDown={handleShieldBonusKeyDown}\r\n                  disabled={!character.isWearingShield}\r\n                  className={`h-12 w-20 [appearance:textfield] border-2 text-center text-2xl font-bold focus:border-blue-500 [&::-webkit-inner-spin-button]:appearance-none [&::-webkit-outer-spin-button]:appearance-none ${\r\n                    character.isWearingShield\r\n                      ? 'border-blue-300 bg-blue-50 text-blue-900'\r\n                      : 'border-gray-200 bg-gray-50 text-gray-400'\r\n                  }`}\r\n                  min=\"0\"\r\n                  max=\"5\"\r\n                />\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* AC Formula Display */}\r\n          <div className=\"text-center\">\r\n            <div className=\"inline-flex items-center gap-3 rounded-lg border-2 border-red-300 bg-white px-6 py-3 text-lg font-medium text-red-800 shadow-sm\">\r\n              <span className=\"text-xl font-bold\">{character.armorClass}</span>\r\n              <span className=\"text-lg text-red-600\">+</span>\r\n              <span className=\"text-xl font-bold\">\r\n                {character.tempArmorClass}\r\n              </span>\r\n              {character.isWearingShield && (\r\n                <>\r\n                  <span className=\"text-lg text-red-600\">+</span>\r\n                  <span className=\"text-xl font-bold\">\r\n                    {character.shieldBonus}\r\n                  </span>\r\n                </>\r\n              )}\r\n              <span className=\"text-lg text-red-600\">=</span>\r\n              <span className=\"text-2xl font-bold text-red-900\">\r\n                {calculateCharacterArmorClass(character)}\r\n              </span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </TooltipProvider>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAAA;AAEA;AACA;AACA;AAPA;;;;;;;AAiBe,SAAS,kBAAkB,EACxC,SAAS,EACT,kBAAkB,EAClB,sBAAsB,EACtB,cAAc,EACd,mBAAmB,EACI;IACvB,qEAAqE;IACrE,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,iNAAQ,EAC5C,UAAU,UAAU,CAAC,QAAQ;IAE/B,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,iNAAQ,EAC5C,UAAU,cAAc,CAAC,QAAQ;IAEnC,MAAM,CAAC,kBAAkB,oBAAoB,GAAG,IAAA,iNAAQ,EACtD,UAAU,WAAW,CAAC,QAAQ;IAEhC,MAAM,CAAC,gBAAgB,kBAAkB,GAAG,IAAA,iNAAQ,EAClD,UAAU,cAAc,GAAG;IAG7B,4DAA4D;IAC5D,IAAA,kNAAS,EAAC;QACR,eAAe,UAAU,UAAU,CAAC,QAAQ;IAC9C,GAAG;QAAC,UAAU,UAAU;KAAC;IAEzB,IAAA,kNAAS,EAAC;QACR,eAAe,UAAU,cAAc,CAAC,QAAQ;QAChD,kBAAkB,UAAU,cAAc,GAAG;IAC/C,GAAG;QAAC,UAAU,cAAc;KAAC;IAE7B,IAAA,kNAAS,EAAC;QACR,oBAAoB,UAAU,WAAW,CAAC,QAAQ;IACpD,GAAG;QAAC,UAAU,WAAW;KAAC;IAE1B,uBAAuB;IACvB,MAAM,qBAAqB,CAAC;QAC1B,eAAe;IACjB;IAEA,MAAM,mBAAmB;QACvB,MAAM,WAAW,SAAS;QAC1B,MAAM,aAAa,MAAM,YAAY,KAAK;QAC1C,MAAM,eAAe,KAAK,GAAG,CAAC,GAAG,KAAK,GAAG,CAAC,IAAI;QAC9C,eAAe,aAAa,QAAQ;QACpC,mBAAmB;IACrB;IAEA,MAAM,sBAAsB,CAAC;QAC3B,IAAI,EAAE,GAAG,KAAK,SAAS;YACrB,EAAE,aAAa,CAAC,IAAI;QACtB;IACF;IAEA,uBAAuB;IACvB,MAAM,qBAAqB,CAAC;QAC1B,eAAe;IACjB;IAEA,MAAM,mBAAmB;QACvB,MAAM,WAAW,SAAS;QAC1B,MAAM,aAAa,MAAM,YAAY,IAAI;QACzC,MAAM,eAAe,KAAK,GAAG,CAAC,GAAG,KAAK,GAAG,CAAC,IAAI;QAC9C,eAAe,aAAa,QAAQ;QACpC,uBAAuB;QACvB,IAAI,iBAAiB,GAAG;YACtB,kBAAkB;QACpB;IACF;IAEA,MAAM,sBAAsB,CAAC;QAC3B,IAAI,EAAE,GAAG,KAAK,SAAS;YACrB,EAAE,aAAa,CAAC,IAAI;QACtB;IACF;IAEA,MAAM,qBAAqB;QACzB,IAAI,gBAAgB;YAClB,4BAA4B;YAC5B,eAAe;YACf,uBAAuB;YACvB,kBAAkB;QACpB,OAAO;YACL,8CAA8C;YAC9C,MAAM,eAAe,SAAS,gBAAgB;YAC9C,IAAI,iBAAiB,GAAG;gBACtB,eAAe;gBACf,uBAAuB;YACzB;YACA,kBAAkB;QACpB;IACF;IAEA,4BAA4B;IAC5B,MAAM,0BAA0B,CAAC;QAC/B,oBAAoB;IACtB;IAEA,MAAM,wBAAwB;QAC5B,MAAM,WAAW,SAAS;QAC1B,MAAM,aAAa,MAAM,YAAY,IAAI;QACzC,MAAM,eAAe,KAAK,GAAG,CAAC,GAAG,KAAK,GAAG,CAAC,GAAG;QAC7C,oBAAoB,aAAa,QAAQ;QACzC,oBAAoB;IACtB;IAEA,MAAM,2BAA2B,CAC/B;QAEA,IAAI,EAAE,GAAG,KAAK,SAAS;YACrB,EAAE,aAAa,CAAC,IAAI;QACtB;IACF;IAEA,qBACE,8OAAC,mLAAe;kBACd,cAAA,8OAAC;YAAI,WAAU;sBACb,cAAA,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;gCAAG,WAAU;0CAA6E;;;;;;0CAG3F,8OAAC;gCAAI,WAAU;0CACZ,IAAA,2KAA4B,EAAC;;;;;;0CAEhC,8OAAC;gCAAI,WAAU;0CAAqC;;;;;;;;;;;;kCAItD,8OAAC;wBAAI,WAAU;;0CAEb,8OAAC;gCAAI,WAAU;0CACb,cAAA,8OAAC;oCAAI,WAAU;;sDACb,8OAAC;4CAAI,WAAU;;8DACb,8OAAC;oDAAI,WAAU;8DAAiC;;;;;;8DAChD,8OAAC,2KAAO;oDAAC,SAAQ;8DACf,cAAA,8OAAC;wDAAK,WAAU;kEACd,cAAA,8OAAC,0MAAI;4DAAC,MAAM;;;;;;;;;;;;;;;;;;;;;;sDAIlB,8OAAC,kKAAK;4CACJ,MAAK;4CACL,OAAO;4CACP,UAAU,CAAA,IAAK,mBAAmB,EAAE,MAAM,CAAC,KAAK;4CAChD,QAAQ;4CACR,WAAW;4CACX,WAAU;4CACV,KAAI;4CACJ,KAAI;;;;;;;;;;;;;;;;;0CAMV,8OAAC;gCACC,WAAW,CAAC,uEAAuE,EACjF,iBACI,sCACA,6CACJ;0CAEF,cAAA,8OAAC;oCAAI,WAAU;;sDACb,8OAAC;4CAAI,WAAU;;8DACb,8OAAC,2KAAO;oDACN,SAAS,CAAC,SAAS,EAAE,iBAAiB,yBAAyB,WAAW,aAAa,CAAC;8DAExF,cAAA,8OAAC;wDACC,MAAK;wDACL,SAAS;wDACT,WAAW,CAAC,8EAA8E,EACxF,iBAAiB,oBAAoB,mBACrC;kEAEF,cAAA,8OAAC;sEAAK;;;;;;;;;;;;;;;;8DAIV,8OAAC,2KAAO;oDAAC,SAAQ;8DACf,cAAA,8OAAC;wDAAK,WAAU;kEACd,cAAA,8OAAC,0MAAI;4DAAC,MAAM;;;;;;;;;;;;;;;;;;;;;;sDAIlB,8OAAC,kKAAK;4CACJ,MAAK;4CACL,OAAO;4CACP,UAAU,CAAA,IAAK,mBAAmB,EAAE,MAAM,CAAC,KAAK;4CAChD,QAAQ;4CACR,WAAW;4CACX,UAAU,CAAC;4CACX,WAAW,CAAC,+LAA+L,EACzM,iBACI,mDACA,4CACJ;4CACF,KAAI;4CACJ,KAAI;;;;;;;;;;;;;;;;;0CAMV,8OAAC;gCACC,WAAW,CAAC,uEAAuE,EACjF,UAAU,eAAe,GACrB,kCACA,yCACJ;0CAEF,cAAA,8OAAC;oCAAI,WAAU;;sDACb,8OAAC;4CAAI,WAAU;;8DACb,8OAAC,2KAAO;oDACN,SAAS,CAAC,SAAS,EAAE,UAAU,eAAe,GAAG,YAAY,QAAQ,OAAO,CAAC;8DAE7E,cAAA,8OAAC;wDACC,MAAK;wDACL,SAAS;wDACT,WAAW,CAAC,8EAA8E,EACxF,UAAU,eAAe,GACrB,kBACA,iBACJ;kEAEF,cAAA,8OAAC;sEAAK;;;;;;;;;;;;;;;;8DAMV,8OAAC,2KAAO;oDAAC,SAAQ;8DACf,cAAA,8OAAC;wDAAK,WAAU;kEACd,cAAA,8OAAC,0MAAI;4DAAC,MAAM;;;;;;;;;;;;;;;;;;;;;;sDAIlB,8OAAC,kKAAK;4CACJ,MAAK;4CACL,OAAO;4CACP,UAAU,CAAA,IAAK,wBAAwB,EAAE,MAAM,CAAC,KAAK;4CACrD,QAAQ;4CACR,WAAW;4CACX,UAAU,CAAC,UAAU,eAAe;4CACpC,WAAW,CAAC,6LAA6L,EACvM,UAAU,eAAe,GACrB,6CACA,4CACJ;4CACF,KAAI;4CACJ,KAAI;;;;;;;;;;;;;;;;;;;;;;;kCAOZ,8OAAC;wBAAI,WAAU;kCACb,cAAA,8OAAC;4BAAI,WAAU;;8CACb,8OAAC;oCAAK,WAAU;8CAAqB,UAAU,UAAU;;;;;;8CACzD,8OAAC;oCAAK,WAAU;8CAAuB;;;;;;8CACvC,8OAAC;oCAAK,WAAU;8CACb,UAAU,cAAc;;;;;;gCAE1B,UAAU,eAAe,kBACxB;;sDACE,8OAAC;4CAAK,WAAU;sDAAuB;;;;;;sDACvC,8OAAC;4CAAK,WAAU;sDACb,UAAU,WAAW;;;;;;;;8CAI5B,8OAAC;oCAAK,WAAU;8CAAuB;;;;;;8CACvC,8OAAC;oCAAK,WAAU;8CACb,IAAA,2KAA4B,EAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAQ9C","debugId":null}},
    {"offset": {"line": 5188, "column": 0}, "map": {"version":3,"sources":["file:///home/irakli/Projects/RollKeeper/apps/web/src/components/ui/character/SavingThrows.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { ABILITY_NAMES } from '@/utils/constants';\r\nimport { formatModifier } from '@/utils/calculations';\r\nimport { Button, Checkbox } from '@/components/ui/forms';\r\nimport { AbilityName, CharacterState } from '@/types/character';\r\n\r\ninterface SavingThrowsProps {\r\n  savingThrows: CharacterState['savingThrows'];\r\n  getSavingThrowModifier: (ability: AbilityName) => number;\r\n  onUpdateSavingThrowProficiency: (\r\n    ability: AbilityName,\r\n    proficient: boolean\r\n  ) => void;\r\n  onRollSavingThrow: (ability: AbilityName) => void;\r\n}\r\n\r\nexport default function SavingThrows({\r\n  savingThrows,\r\n  getSavingThrowModifier,\r\n  onUpdateSavingThrowProficiency,\r\n  onRollSavingThrow,\r\n}: SavingThrowsProps) {\r\n  return (\r\n    <div className=\"rounded-lg border border-amber-200 bg-white p-6 shadow-lg\">\r\n      <h2 className=\"mb-4 border-b border-gray-200 pb-2 text-lg font-bold text-gray-800\">\r\n        Saving Throws\r\n      </h2>\r\n      <div className=\"space-y-2\">\r\n        {(Object.keys(ABILITY_NAMES) as AbilityName[]).map(ability => (\r\n          <div\r\n            key={ability}\r\n            className=\"flex items-center gap-3 rounded p-2 transition-colors hover:bg-purple-50\"\r\n          >\r\n            <Checkbox\r\n              checked={savingThrows[ability].proficient}\r\n              onCheckedChange={checked =>\r\n                onUpdateSavingThrowProficiency(ability, checked)\r\n              }\r\n              size=\"sm\"\r\n              variant=\"primary\"\r\n            />\r\n            <span className=\"w-8 text-right font-mono text-sm font-semibold text-purple-800\">\r\n              {formatModifier(getSavingThrowModifier(ability))}\r\n            </span>\r\n            <Button\r\n              onClick={() => onRollSavingThrow(ability)}\r\n              variant=\"ghost\"\r\n              size=\"sm\"\r\n              className=\"hover:bg-purple-100 hover:text-purple-700\"\r\n              title={`Roll ${ABILITY_NAMES[ability]} saving throw (d20 + ${formatModifier(getSavingThrowModifier(ability))})`}\r\n            >\r\n              {ABILITY_NAMES[ability]}\r\n            </Button>\r\n          </div>\r\n        ))}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAAA;AAAA;AAJA;;;;;AAiBe,SAAS,aAAa,EACnC,YAAY,EACZ,sBAAsB,EACtB,8BAA8B,EAC9B,iBAAiB,EACC;IAClB,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBAAG,WAAU;0BAAqE;;;;;;0BAGnF,8OAAC;gBAAI,WAAU;0BACZ,AAAC,OAAO,IAAI,CAAC,yJAAa,EAAoB,GAAG,CAAC,CAAA,wBACjD,8OAAC;wBAEC,WAAU;;0CAEV,8OAAC,wKAAQ;gCACP,SAAS,YAAY,CAAC,QAAQ,CAAC,UAAU;gCACzC,iBAAiB,CAAA,UACf,+BAA+B,SAAS;gCAE1C,MAAK;gCACL,SAAQ;;;;;;0CAEV,8OAAC;gCAAK,WAAU;0CACb,IAAA,6JAAc,EAAC,uBAAuB;;;;;;0CAEzC,8OAAC,oLAAM;gCACL,SAAS,IAAM,kBAAkB;gCACjC,SAAQ;gCACR,MAAK;gCACL,WAAU;gCACV,OAAO,CAAC,KAAK,EAAE,yJAAa,CAAC,QAAQ,CAAC,qBAAqB,EAAE,IAAA,6JAAc,EAAC,uBAAuB,UAAU,CAAC,CAAC;0CAE9G,yJAAa,CAAC,QAAQ;;;;;;;uBArBpB;;;;;;;;;;;;;;;;AA4BjB","debugId":null}},
    {"offset": {"line": 5272, "column": 0}, "map": {"version":3,"sources":["file:///home/irakli/Projects/RollKeeper/apps/web/src/components/ui/character/Skills.tsx"],"sourcesContent":["'use client';\r\n\r\nimport {\r\n  SKILL_NAMES,\r\n  SKILL_ABILITY_MAP,\r\n  ABILITY_ABBREVIATIONS,\r\n} from '@/utils/constants';\r\nimport { formatModifier } from '@/utils/calculations';\r\nimport { Checkbox } from '@/components/ui/forms';\r\nimport { SkillName, CharacterState } from '@/types/character';\r\n\r\ninterface SkillsProps {\r\n  skills: CharacterState['skills'];\r\n  jackOfAllTrades: boolean;\r\n  proficiencyBonus: number;\r\n  getSkillModifier: (skillName: SkillName) => number;\r\n  onUpdateSkillProficiency: (skillName: SkillName, proficient: boolean) => void;\r\n  onUpdateSkillExpertise: (skillName: SkillName, expertise: boolean) => void;\r\n  onToggleJackOfAllTrades: () => void;\r\n  onRollSkillCheck: (skillName: SkillName) => void;\r\n}\r\n\r\nexport default function Skills({\r\n  skills,\r\n  jackOfAllTrades,\r\n  proficiencyBonus,\r\n  getSkillModifier,\r\n  onUpdateSkillProficiency,\r\n  onUpdateSkillExpertise,\r\n  onToggleJackOfAllTrades,\r\n  onRollSkillCheck,\r\n}: SkillsProps) {\r\n  return (\r\n    <div className=\"flex flex-col rounded-lg border border-amber-200 bg-white p-6 shadow-lg\">\r\n      <div className=\"mb-4 flex items-center justify-between border-b border-gray-200 pb-2\">\r\n        <h2 className=\"text-lg font-bold text-gray-800\">Skills</h2>\r\n\r\n        {/* Jack of All Trades Toggle */}\r\n        <div className=\"flex items-center space-x-2\">\r\n          <Checkbox\r\n            checked={jackOfAllTrades ?? false}\r\n            onCheckedChange={onToggleJackOfAllTrades}\r\n            label=\"Jack of All Trades\"\r\n            size=\"sm\"\r\n            variant=\"primary\"\r\n          />\r\n          <div className=\"group relative\">\r\n            <span className=\"cursor-help text-gray-400\">â“˜</span>\r\n            <div className=\"absolute top-6 right-0 z-10 w-64 rounded bg-gray-800 p-2 text-xs text-white opacity-0 shadow-lg transition-opacity group-hover:opacity-100\">\r\n              Bard feature: Add half proficiency bonus (rounded down) to ability\r\n              checks using skills you&apos;re not proficient in.\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Skills Legend */}\r\n      <div className=\"mb-3 flex items-center gap-4 rounded bg-gray-50 p-2 text-xs text-gray-600\">\r\n        <div className=\"flex items-center gap-1\">\r\n          <div className=\"h-3 w-3 rounded bg-green-600\"></div>\r\n          <span>P = Proficient ({formatModifier(proficiencyBonus)})</span>\r\n        </div>\r\n        <div className=\"flex items-center gap-1\">\r\n          <div className=\"h-3 w-3 rounded bg-yellow-600\"></div>\r\n          <span>E = Expertise ({formatModifier(proficiencyBonus * 2)})</span>\r\n        </div>\r\n        {jackOfAllTrades && (\r\n          <div className=\"flex items-center gap-1\">\r\n            <div className=\"h-3 w-3 rounded bg-blue-500\"></div>\r\n            <span>\r\n              J = Jack of All Trades (\r\n              {formatModifier(Math.floor(proficiencyBonus / 2))})\r\n            </span>\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      <div className=\"max-h-[40vh] min-h-0 flex-1 space-y-1 overflow-y-auto rounded-lg border border-gray-100 bg-gradient-to-b from-white to-gray-50 p-2 lg:max-h-[60vh] xl:max-h-none\">\r\n        {(Object.keys(SKILL_NAMES) as SkillName[]).map(skillName => {\r\n          const skill = skills[skillName];\r\n          const isProficient = skill.proficient;\r\n          const hasExpertise = skill.expertise;\r\n\r\n          return (\r\n            <div\r\n              key={skillName}\r\n              className=\"flex items-center gap-2 rounded p-1 text-sm transition-colors hover:bg-green-50\"\r\n            >\r\n              {/* Proficiency Checkbox */}\r\n              <div className=\"flex flex-col items-center\">\r\n                <Checkbox\r\n                  checked={isProficient}\r\n                  onCheckedChange={checked => {\r\n                    onUpdateSkillProficiency(skillName, checked);\r\n                    // Remove expertise if proficiency is removed\r\n                    if (!checked && hasExpertise) {\r\n                      onUpdateSkillExpertise(skillName, false);\r\n                    }\r\n                  }}\r\n                  size=\"sm\"\r\n                  variant=\"success\"\r\n                  title=\"Proficient\"\r\n                />\r\n                <span className=\"mt-0.5 text-xs text-gray-500\">P</span>\r\n              </div>\r\n\r\n              {/* Expertise Checkbox */}\r\n              <div className=\"flex flex-col items-center\">\r\n                <Checkbox\r\n                  checked={hasExpertise && isProficient}\r\n                  onCheckedChange={checked =>\r\n                    onUpdateSkillExpertise(skillName, checked)\r\n                  }\r\n                  disabled={!isProficient}\r\n                  size=\"sm\"\r\n                  variant=\"warning\"\r\n                  title=\"Expertise (Double Proficiency)\"\r\n                />\r\n                <span\r\n                  className={`mt-0.5 text-xs ${\r\n                    isProficient ? 'text-yellow-600' : 'text-gray-300'\r\n                  }`}\r\n                >\r\n                  E\r\n                </span>\r\n              </div>\r\n\r\n              {/* Skill Modifier */}\r\n              <span\r\n                className={`w-10 text-right font-mono font-semibold ${\r\n                  hasExpertise && isProficient\r\n                    ? 'text-yellow-700'\r\n                    : isProficient\r\n                      ? 'text-green-800'\r\n                      : jackOfAllTrades && !isProficient\r\n                        ? 'text-blue-600'\r\n                        : 'text-gray-600'\r\n                }`}\r\n              >\r\n                {formatModifier(getSkillModifier(skillName))}\r\n              </span>\r\n\r\n              {/* Skill Name */}\r\n              <button\r\n                onClick={() => onRollSkillCheck(skillName)}\r\n                className=\"flex-1 cursor-pointer rounded px-2 py-1 text-left font-medium text-gray-800 transition-colors hover:bg-green-100 hover:text-green-700\"\r\n                title={`Roll ${SKILL_NAMES[skillName]} check (d20 + ${formatModifier(getSkillModifier(skillName))})`}\r\n              >\r\n                {SKILL_NAMES[skillName]}\r\n              </button>\r\n\r\n              {/* Ability Abbreviation */}\r\n              <span className=\"w-8 text-xs text-gray-500\">\r\n                {ABILITY_ABBREVIATIONS[SKILL_ABILITY_MAP[skillName]]}\r\n              </span>\r\n            </div>\r\n          );\r\n        })}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AAKA;AACA;AAAA;AARA;;;;;AAsBe,SAAS,OAAO,EAC7B,MAAM,EACN,eAAe,EACf,gBAAgB,EAChB,gBAAgB,EAChB,wBAAwB,EACxB,sBAAsB,EACtB,uBAAuB,EACvB,gBAAgB,EACJ;IACZ,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAG,WAAU;kCAAkC;;;;;;kCAGhD,8OAAC;wBAAI,WAAU;;0CACb,8OAAC,wKAAQ;gCACP,SAAS,mBAAmB;gCAC5B,iBAAiB;gCACjB,OAAM;gCACN,MAAK;gCACL,SAAQ;;;;;;0CAEV,8OAAC;gCAAI,WAAU;;kDACb,8OAAC;wCAAK,WAAU;kDAA4B;;;;;;kDAC5C,8OAAC;wCAAI,WAAU;kDAA6I;;;;;;;;;;;;;;;;;;;;;;;;0BASlK,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;gCAAI,WAAU;;;;;;0CACf,8OAAC;;oCAAK;oCAAiB,IAAA,6JAAc,EAAC;oCAAkB;;;;;;;;;;;;;kCAE1D,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;gCAAI,WAAU;;;;;;0CACf,8OAAC;;oCAAK;oCAAgB,IAAA,6JAAc,EAAC,mBAAmB;oCAAG;;;;;;;;;;;;;oBAE5D,iCACC,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;gCAAI,WAAU;;;;;;0CACf,8OAAC;;oCAAK;oCAEH,IAAA,6JAAc,EAAC,KAAK,KAAK,CAAC,mBAAmB;oCAAI;;;;;;;;;;;;;;;;;;;0BAM1D,8OAAC;gBAAI,WAAU;0BACZ,AAAC,OAAO,IAAI,CAAC,uJAAW,EAAkB,GAAG,CAAC,CAAA;oBAC7C,MAAM,QAAQ,MAAM,CAAC,UAAU;oBAC/B,MAAM,eAAe,MAAM,UAAU;oBACrC,MAAM,eAAe,MAAM,SAAS;oBAEpC,qBACE,8OAAC;wBAEC,WAAU;;0CAGV,8OAAC;gCAAI,WAAU;;kDACb,8OAAC,wKAAQ;wCACP,SAAS;wCACT,iBAAiB,CAAA;4CACf,yBAAyB,WAAW;4CACpC,6CAA6C;4CAC7C,IAAI,CAAC,WAAW,cAAc;gDAC5B,uBAAuB,WAAW;4CACpC;wCACF;wCACA,MAAK;wCACL,SAAQ;wCACR,OAAM;;;;;;kDAER,8OAAC;wCAAK,WAAU;kDAA+B;;;;;;;;;;;;0CAIjD,8OAAC;gCAAI,WAAU;;kDACb,8OAAC,wKAAQ;wCACP,SAAS,gBAAgB;wCACzB,iBAAiB,CAAA,UACf,uBAAuB,WAAW;wCAEpC,UAAU,CAAC;wCACX,MAAK;wCACL,SAAQ;wCACR,OAAM;;;;;;kDAER,8OAAC;wCACC,WAAW,CAAC,eAAe,EACzB,eAAe,oBAAoB,iBACnC;kDACH;;;;;;;;;;;;0CAMH,8OAAC;gCACC,WAAW,CAAC,wCAAwC,EAClD,gBAAgB,eACZ,oBACA,eACE,mBACA,mBAAmB,CAAC,eAClB,kBACA,iBACR;0CAED,IAAA,6JAAc,EAAC,iBAAiB;;;;;;0CAInC,8OAAC;gCACC,SAAS,IAAM,iBAAiB;gCAChC,WAAU;gCACV,OAAO,CAAC,KAAK,EAAE,uJAAW,CAAC,UAAU,CAAC,cAAc,EAAE,IAAA,6JAAc,EAAC,iBAAiB,YAAY,CAAC,CAAC;0CAEnG,uJAAW,CAAC,UAAU;;;;;;0CAIzB,8OAAC;gCAAK,WAAU;0CACb,iKAAqB,CAAC,6JAAiB,CAAC,UAAU,CAAC;;;;;;;uBApEjD;;;;;gBAwEX;;;;;;;;;;;;AAIR","debugId":null}},
    {"offset": {"line": 5563, "column": 0}, "map": {"version":3,"sources":["file:///home/irakli/Projects/RollKeeper/apps/web/src/components/ui/character/CombatStats.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { RotateCcw } from 'lucide-react';\r\nimport { formatModifier } from '@/utils/calculations';\r\nimport { Button, Input, Switch } from '@/components/ui/forms';\r\nimport { CharacterState } from '@/types/character';\r\n\r\ninterface CombatStatsProps {\r\n  character: CharacterState;\r\n  getInitiativeModifier: () => number;\r\n  onUpdateInitiative: (value: number, isOverridden: boolean) => void;\r\n  onResetInitiativeToDefault: () => void;\r\n  onUpdateSpeed: (speed: number) => void;\r\n  onToggleReaction: () => void;\r\n  onResetReaction: () => void;\r\n  onRollInitiative: () => void;\r\n}\r\n\r\nexport default function CombatStats({\r\n  character,\r\n  getInitiativeModifier,\r\n  onUpdateInitiative,\r\n  onResetInitiativeToDefault,\r\n  onUpdateSpeed,\r\n  onToggleReaction,\r\n  onResetReaction,\r\n  onRollInitiative,\r\n}: CombatStatsProps) {\r\n  return (\r\n    <>\r\n      {/* Initiative and Speed Row */}\r\n      <div className=\"mb-6 grid grid-cols-2 gap-4\">\r\n        {/* Initiative */}\r\n        <div className=\"text-center\">\r\n          <div\r\n            className={`flex h-20 flex-col justify-center rounded-lg border-2 p-3 transition-colors ${\r\n              character.initiative.isOverridden\r\n                ? 'border-orange-300 bg-orange-50'\r\n                : 'border-yellow-200 bg-yellow-50'\r\n            }`}\r\n          >\r\n            <div className=\"mb-1 flex items-center justify-center gap-1 text-xs font-medium text-yellow-700\">\r\n              INITIATIVE\r\n              {character.initiative.isOverridden && (\r\n                <Button\r\n                  onClick={onResetInitiativeToDefault}\r\n                  variant=\"ghost\"\r\n                  size=\"xs\"\r\n                  className=\"h-4 w-4 p-0 text-orange-600 hover:text-orange-800\"\r\n                  title=\"Reset to DEX modifier\"\r\n                >\r\n                  <RotateCcw size={10} />\r\n                </Button>\r\n              )}\r\n              <Button\r\n                onClick={onRollInitiative}\r\n                variant=\"ghost\"\r\n                size=\"xs\"\r\n                className=\"ml-1 h-4 w-4 p-0 text-yellow-600 hover:text-yellow-800\"\r\n                title={`Roll initiative (d20 + ${formatModifier(getInitiativeModifier())})`}\r\n              >\r\n                ðŸŽ²\r\n              </Button>\r\n            </div>\r\n            <Input\r\n              type=\"number\"\r\n              value={getInitiativeModifier().toString()}\r\n              onChange={e =>\r\n                onUpdateInitiative(parseInt(e.target.value) || 0, true)\r\n              }\r\n              className={`border-none bg-transparent text-center text-xl font-bold [appearance:textfield] [&::-webkit-inner-spin-button]:appearance-none [&::-webkit-outer-spin-button]:appearance-none ${\r\n                character.initiative.isOverridden\r\n                  ? 'text-orange-800'\r\n                  : 'text-yellow-800'\r\n              }`}\r\n              title={\r\n                character.initiative.isOverridden\r\n                  ? 'Custom initiative (overridden)'\r\n                  : 'DEX modifier (auto-calculated)'\r\n              }\r\n            />\r\n          </div>\r\n        </div>\r\n\r\n        {/* Speed */}\r\n        <div className=\"text-center\">\r\n          <div className=\"flex h-20 flex-col justify-center rounded-lg border-2 border-green-200 bg-green-50 p-3\">\r\n            <div className=\"mb-1 text-xs font-medium text-green-700\">SPEED</div>\r\n            <Input\r\n              type=\"number\"\r\n              value={character.speed.toString()}\r\n              onChange={e => onUpdateSpeed(parseInt(e.target.value) || 30)}\r\n              className=\"border-none bg-transparent text-center text-xl font-bold text-green-800 [appearance:textfield] [&::-webkit-inner-spin-button]:appearance-none [&::-webkit-outer-spin-button]:appearance-none\"\r\n            />\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Reaction Tracking */}\r\n      <div className=\"mb-6\">\r\n        <div className=\"rounded-lg border-2 border-purple-200 bg-purple-50 p-4\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <div className=\"flex items-center gap-3\">\r\n              <div className=\"text-sm font-bold text-purple-800\">REACTION</div>\r\n              <div className=\"text-xs text-purple-600\">\r\n                {character.reaction.hasUsedReaction\r\n                  ? 'Used this turn'\r\n                  : 'Available'}\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"flex items-center gap-2\">\r\n              <Switch\r\n                checked={!character.reaction.hasUsedReaction}\r\n                onCheckedChange={() => onToggleReaction()}\r\n                size=\"sm\"\r\n                variant=\"success\"\r\n                title={\r\n                  character.reaction.hasUsedReaction\r\n                    ? 'Mark reaction as available'\r\n                    : 'Mark reaction as used'\r\n                }\r\n              />\r\n\r\n              <Button\r\n                onClick={onResetReaction}\r\n                variant=\"ghost\"\r\n                size=\"xs\"\r\n                className=\"p-1 text-purple-600 hover:bg-purple-100\"\r\n                title=\"Reset reaction to available\"\r\n              >\r\n                <RotateCcw size={14} />\r\n              </Button>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"mt-2 rounded bg-purple-100 p-2 text-xs text-purple-700\">\r\n            <strong>Reaction:</strong> One reaction per turn - used for\r\n            opportunity attacks, spells like Shield, or other triggered\r\n            abilities.\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAAA;AAAA;AAAA;AAJA;;;;;AAkBe,SAAS,YAAY,EAClC,SAAS,EACT,qBAAqB,EACrB,kBAAkB,EAClB,0BAA0B,EAC1B,aAAa,EACb,gBAAgB,EAChB,eAAe,EACf,gBAAgB,EACC;IACjB,qBACE;;0BAEE,8OAAC;gBAAI,WAAU;;kCAEb,8OAAC;wBAAI,WAAU;kCACb,cAAA,8OAAC;4BACC,WAAW,CAAC,4EAA4E,EACtF,UAAU,UAAU,CAAC,YAAY,GAC7B,mCACA,kCACJ;;8CAEF,8OAAC;oCAAI,WAAU;;wCAAkF;wCAE9F,UAAU,UAAU,CAAC,YAAY,kBAChC,8OAAC,oLAAM;4CACL,SAAS;4CACT,SAAQ;4CACR,MAAK;4CACL,WAAU;4CACV,OAAM;sDAEN,cAAA,8OAAC,6NAAS;gDAAC,MAAM;;;;;;;;;;;sDAGrB,8OAAC,oLAAM;4CACL,SAAS;4CACT,SAAQ;4CACR,MAAK;4CACL,WAAU;4CACV,OAAO,CAAC,uBAAuB,EAAE,IAAA,6JAAc,EAAC,yBAAyB,CAAC,CAAC;sDAC5E;;;;;;;;;;;;8CAIH,8OAAC,kKAAK;oCACJ,MAAK;oCACL,OAAO,wBAAwB,QAAQ;oCACvC,UAAU,CAAA,IACR,mBAAmB,SAAS,EAAE,MAAM,CAAC,KAAK,KAAK,GAAG;oCAEpD,WAAW,CAAC,8KAA8K,EACxL,UAAU,UAAU,CAAC,YAAY,GAC7B,oBACA,mBACJ;oCACF,OACE,UAAU,UAAU,CAAC,YAAY,GAC7B,mCACA;;;;;;;;;;;;;;;;;kCAOZ,8OAAC;wBAAI,WAAU;kCACb,cAAA,8OAAC;4BAAI,WAAU;;8CACb,8OAAC;oCAAI,WAAU;8CAA0C;;;;;;8CACzD,8OAAC,kKAAK;oCACJ,MAAK;oCACL,OAAO,UAAU,KAAK,CAAC,QAAQ;oCAC/B,UAAU,CAAA,IAAK,cAAc,SAAS,EAAE,MAAM,CAAC,KAAK,KAAK;oCACzD,WAAU;;;;;;;;;;;;;;;;;;;;;;;0BAOlB,8OAAC;gBAAI,WAAU;0BACb,cAAA,8OAAC;oBAAI,WAAU;;sCACb,8OAAC;4BAAI,WAAU;;8CACb,8OAAC;oCAAI,WAAU;;sDACb,8OAAC;4CAAI,WAAU;sDAAoC;;;;;;sDACnD,8OAAC;4CAAI,WAAU;sDACZ,UAAU,QAAQ,CAAC,eAAe,GAC/B,mBACA;;;;;;;;;;;;8CAIR,8OAAC;oCAAI,WAAU;;sDACb,8OAAC,oKAAM;4CACL,SAAS,CAAC,UAAU,QAAQ,CAAC,eAAe;4CAC5C,iBAAiB,IAAM;4CACvB,MAAK;4CACL,SAAQ;4CACR,OACE,UAAU,QAAQ,CAAC,eAAe,GAC9B,+BACA;;;;;;sDAIR,8OAAC,oLAAM;4CACL,SAAS;4CACT,SAAQ;4CACR,MAAK;4CACL,WAAU;4CACV,OAAM;sDAEN,cAAA,8OAAC,6NAAS;gDAAC,MAAM;;;;;;;;;;;;;;;;;;;;;;;sCAKvB,8OAAC;4BAAI,WAAU;;8CACb,8OAAC;8CAAO;;;;;;gCAAkB;;;;;;;;;;;;;;;;;;;;AAQtC","debugId":null}},
    {"offset": {"line": 5804, "column": 0}, "map": {"version":3,"sources":["file:///home/irakli/Projects/RollKeeper/apps/web/src/components/ui/character/CharacterBackgroundEditor.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React, { useState } from 'react';\r\nimport { User, Heart, Star, Link, AlertTriangle } from 'lucide-react';\r\nimport { CharacterBackground } from '@/types/character';\r\nimport { RichTextEditor } from '@/components/ui/forms';\r\n\r\ninterface CharacterBackgroundEditorProps {\r\n  background: CharacterBackground;\r\n  onChange: (updates: Partial<CharacterBackground>) => void;\r\n  className?: string;\r\n}\r\n\r\ntype BackgroundTab = 'backstory' | 'personality' | 'ideals' | 'bonds' | 'flaws';\r\n\r\ninterface TabConfig {\r\n  id: BackgroundTab;\r\n  label: string;\r\n  icon: React.ReactNode;\r\n  placeholder: string;\r\n  description: string;\r\n  color: string;\r\n}\r\n\r\nconst BACKGROUND_TABS: TabConfig[] = [\r\n  {\r\n    id: 'backstory',\r\n    label: 'Backstory',\r\n    icon: <User size={16} />,\r\n    placeholder: \"Tell your character's story...\",\r\n    description:\r\n      \"Your character's history, origins, and important life events.\",\r\n    color: 'blue',\r\n  },\r\n  {\r\n    id: 'personality',\r\n    label: 'Personality',\r\n    icon: <Star size={16} />,\r\n    placeholder: \"Describe your character's personality...\",\r\n    description: 'Personality traits, mannerisms, and behavioral quirks.',\r\n    color: 'purple',\r\n  },\r\n  {\r\n    id: 'ideals',\r\n    label: 'Ideals',\r\n    icon: <Heart size={16} />,\r\n    placeholder: 'What drives your character...',\r\n    description:\r\n      'Principles, values, and beliefs that motivate your character.',\r\n    color: 'rose',\r\n  },\r\n  {\r\n    id: 'bonds',\r\n    label: 'Bonds',\r\n    icon: <Link size={16} />,\r\n    placeholder: 'Who or what matters to your character...',\r\n    description:\r\n      'Important people, places, or things your character cares about.',\r\n    color: 'green',\r\n  },\r\n  {\r\n    id: 'flaws',\r\n    label: 'Flaws',\r\n    icon: <AlertTriangle size={16} />,\r\n    placeholder: \"Your character's weaknesses...\",\r\n    description:\r\n      'Weaknesses, fears, or negative traits that create interesting roleplay.',\r\n    color: 'orange',\r\n  },\r\n];\r\n\r\nexport default function CharacterBackgroundEditor({\r\n  background,\r\n  onChange,\r\n  className = '',\r\n}: CharacterBackgroundEditorProps) {\r\n  const [activeTab, setActiveTab] = useState<BackgroundTab>('backstory');\r\n\r\n  const activeTabConfig = BACKGROUND_TABS.find(tab => tab.id === activeTab)!;\r\n\r\n  const handleContentChange = (field: BackgroundTab, content: string) => {\r\n    onChange({ [field]: content });\r\n  };\r\n\r\n  return (\r\n    <div\r\n      className={`rounded-lg border border-gray-200 bg-white shadow-lg ${className}`}\r\n    >\r\n      <div className=\"border-b border-gray-200\">\r\n        <div className=\"p-4\">\r\n          <h2 className=\"mb-4 text-lg font-bold text-gray-800\">\r\n            Character Background\r\n          </h2>\r\n\r\n          {/* Tab Navigation */}\r\n          <div className=\"flex flex-wrap gap-2\">\r\n            {BACKGROUND_TABS.map(tab => (\r\n              <button\r\n                key={tab.id}\r\n                onClick={() => setActiveTab(tab.id)}\r\n                className={`flex items-center space-x-2 rounded-md px-3 py-2 text-sm font-medium transition-colors ${\r\n                  activeTab === tab.id\r\n                    ? `bg-${tab.color}-100 text-${tab.color}-700 border border-${tab.color}-300`\r\n                    : 'text-gray-600 hover:bg-gray-100 hover:text-gray-800'\r\n                }`}\r\n              >\r\n                {tab.icon}\r\n                <span>{tab.label}</span>\r\n              </button>\r\n            ))}\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Active Tab Content */}\r\n      <div className=\"p-4\">\r\n        <div className=\"mb-4\">\r\n          <div className=\"mb-2 flex items-center space-x-2\">\r\n            <div className={`text-${activeTabConfig.color}-600`}>\r\n              {activeTabConfig.icon}\r\n            </div>\r\n            <h3 className={`font-semibold text-${activeTabConfig.color}-800`}>\r\n              {activeTabConfig.label}\r\n            </h3>\r\n          </div>\r\n          <p className=\"mb-4 text-sm text-gray-600\">\r\n            {activeTabConfig.description}\r\n          </p>\r\n        </div>\r\n\r\n        <RichTextEditor\r\n          key={activeTab} // Force re-render when tab changes\r\n          content={background[activeTab]}\r\n          onChange={content => handleContentChange(activeTab, content)}\r\n          placeholder={activeTabConfig.placeholder}\r\n          minHeight=\"200px\"\r\n        />\r\n\r\n        {/* Character Count & Tips */}\r\n        <div className=\"mt-4 flex items-start justify-between\">\r\n          <div className=\"text-xs text-gray-500\">\r\n            {background[activeTab] && (\r\n              <span>\r\n                {background[activeTab].replace(/<[^>]*>/g, '').length}{' '}\r\n                characters\r\n              </span>\r\n            )}\r\n          </div>\r\n\r\n          <div className=\"max-w-sm text-xs text-gray-500\">\r\n            <details className=\"cursor-pointer\">\r\n              <summary className=\"font-medium hover:text-gray-700\">\r\n                ðŸ’¡ Tips for {activeTabConfig.label}\r\n              </summary>\r\n              <div className=\"mt-2 space-y-1\">\r\n                {activeTab === 'backstory' && (\r\n                  <>\r\n                    <p>â€¢ Include your character&apos;s origins and family</p>\r\n                    <p>â€¢ Mention key events that shaped them</p>\r\n                    <p>â€¢ Explain how they got their class abilities</p>\r\n                  </>\r\n                )}\r\n                {activeTab === 'personality' && (\r\n                  <>\r\n                    <p>â€¢ Describe how they interact with others</p>\r\n                    <p>â€¢ Include speech patterns or mannerisms</p>\r\n                    <p>â€¢ Mention what makes them laugh or angry</p>\r\n                  </>\r\n                )}\r\n                {activeTab === 'ideals' && (\r\n                  <>\r\n                    <p>â€¢ What principles guide their decisions?</p>\r\n                    <p>â€¢ What do they believe is most important?</p>\r\n                    <p>â€¢ What would they die for?</p>\r\n                  </>\r\n                )}\r\n                {activeTab === 'bonds' && (\r\n                  <>\r\n                    <p>â€¢ Important people in their life</p>\r\n                    <p>â€¢ Meaningful possessions or locations</p>\r\n                    <p>â€¢ Goals or promises they&apos;ve made</p>\r\n                  </>\r\n                )}\r\n                {activeTab === 'flaws' && (\r\n                  <>\r\n                    <p>â€¢ Fears or phobias they struggle with</p>\r\n                    <p>â€¢ Bad habits or vices</p>\r\n                    <p>â€¢ Ways they might betray the party</p>\r\n                  </>\r\n                )}\r\n              </div>\r\n            </details>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 6214, "column": 0}, "map": {"version":3,"sources":["file:///home/irakli/Projects/RollKeeper/apps/web/src/components/ui/character/CharacterHeaderSection.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React from 'react';\r\nimport { useCharacterStore } from '@/store/characterStore';\r\nimport { useAutoSave } from '@/hooks/useAutoSave';\r\nimport { SaveIndicator } from '@/components/ui/feedback/SaveIndicator';\r\nimport { Button } from '@/components/ui/forms';\r\nimport { Save, Download, Upload, RotateCcw } from 'lucide-react';\r\n\r\nexport default function CharacterHeaderSection() {\r\n  const {\r\n    character,\r\n    updateCharacter,\r\n    exportCharacter,\r\n    importCharacter,\r\n    resetCharacter,\r\n  } = useCharacterStore();\r\n\r\n  const { saveStatus, hasUnsavedChanges, manualSave } = useAutoSave();\r\n\r\n  const handleImport = (event: React.ChangeEvent<HTMLInputElement>) => {\r\n    const file = event.target.files?.[0];\r\n    if (file) {\r\n      const reader = new FileReader();\r\n      reader.onload = e => {\r\n        try {\r\n          const characterData = JSON.parse(e.target?.result as string);\r\n          importCharacter(characterData);\r\n        } catch (error) {\r\n          console.error('Error importing character:', error);\r\n          alert(\r\n            'Error importing character file. Please check the file format.'\r\n          );\r\n        }\r\n      };\r\n      reader.readAsText(file);\r\n    }\r\n  };\r\n\r\n  const handleExport = () => {\r\n    exportCharacter();\r\n  };\r\n\r\n  const handleReset = () => {\r\n    if (\r\n      confirm(\r\n        'Are you sure you want to reset your character? This action cannot be undone.'\r\n      )\r\n    ) {\r\n      resetCharacter();\r\n    }\r\n  };\r\n\r\n  return (\r\n    <header className=\"relative overflow-hidden rounded-xl border border-slate-600 bg-gradient-to-r from-slate-800 via-slate-900 to-slate-800 p-6 text-white shadow-xl\">\r\n      {/* Background decoration */}\r\n      <div className=\"absolute top-0 right-0 h-32 w-32 rounded-full bg-gradient-to-br from-blue-500/10 to-purple-500/10 blur-2xl\"></div>\r\n      <div className=\"absolute bottom-0 left-0 h-24 w-24 rounded-full bg-gradient-to-tr from-green-500/10 to-blue-500/10 blur-xl\"></div>\r\n\r\n      <div className=\"relative\">\r\n        <div className=\"flex flex-col justify-between gap-6 lg:flex-row lg:items-center\">\r\n          {/* Character Info */}\r\n          <div className=\"flex-1\">\r\n            <div className=\"grid grid-cols-1 gap-4 md:grid-cols-3\">\r\n              {/* Character Name */}\r\n              <div>\r\n                <label className=\"mb-2 block text-sm font-medium text-slate-300\">\r\n                  Character Name\r\n                </label>\r\n                <input\r\n                  type=\"text\"\r\n                  value={character.name}\r\n                  onChange={e => updateCharacter({ name: e.target.value })}\r\n                  className=\"w-full rounded-lg border border-slate-600 bg-slate-700 px-3 py-2 text-white placeholder-slate-400 focus:border-transparent focus:ring-2 focus:ring-blue-500 focus:outline-none\"\r\n                  placeholder=\"Enter character name\"\r\n                />\r\n              </div>\r\n\r\n              {/* Level */}\r\n              <div>\r\n                <label className=\"mb-2 block text-sm font-medium text-slate-300\">\r\n                  Level\r\n                </label>\r\n                <input\r\n                  type=\"number\"\r\n                  min=\"1\"\r\n                  max=\"20\"\r\n                  value={character.level}\r\n                  onChange={e =>\r\n                    updateCharacter({ level: parseInt(e.target.value) || 1 })\r\n                  }\r\n                  className=\"w-full rounded-lg border border-slate-600 bg-slate-700 px-3 py-2 text-white placeholder-slate-400 focus:border-transparent focus:ring-2 focus:ring-blue-500 focus:outline-none\"\r\n                />\r\n              </div>\r\n\r\n              {/* Class */}\r\n              <div>\r\n                <label className=\"mb-2 block text-sm font-medium text-slate-300\">\r\n                  Class\r\n                </label>\r\n                <div className=\"relative\">\r\n                  <input\r\n                    type=\"text\"\r\n                    value={character.class?.name || ''}\r\n                    onChange={e =>\r\n                      updateCharacter({\r\n                        class: {\r\n                          ...character.class,\r\n                          name: e.target.value,\r\n                          isCustom: true,\r\n                        },\r\n                      })\r\n                    }\r\n                    className=\"w-full rounded-lg border border-slate-600 bg-slate-700 px-3 py-2 text-white placeholder-slate-400 focus:border-transparent focus:ring-2 focus:ring-blue-500 focus:outline-none\"\r\n                    placeholder=\"Enter class name\"\r\n                  />\r\n                  {character.class?.isCustom && (\r\n                    <span className=\"absolute top-2 right-2 text-xs text-amber-400\">\r\n                      Custom\r\n                    </span>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Save Indicator & Actions */}\r\n          <div className=\"flex flex-col items-end gap-4\">\r\n            {/* Save Status */}\r\n            <SaveIndicator status={saveStatus} />\r\n\r\n            <div className=\"flex gap-2\">\r\n              <Button\r\n                onClick={manualSave}\r\n                disabled={!hasUnsavedChanges}\r\n                variant=\"primary\"\r\n                size=\"sm\"\r\n                leftIcon={<Save className=\"h-4 w-4\" />}\r\n              >\r\n                Save\r\n              </Button>\r\n\r\n              <Button\r\n                onClick={handleExport}\r\n                variant=\"outline\"\r\n                size=\"sm\"\r\n                leftIcon={<Download className=\"h-4 w-4\" />}\r\n              >\r\n                Export\r\n              </Button>\r\n\r\n              <Button\r\n                asChild\r\n                variant=\"outline\"\r\n                size=\"sm\"\r\n              >\r\n                <label className=\"cursor-pointer\">\r\n                  <span className=\"flex items-center gap-2\">\r\n                    <Upload className=\"h-4 w-4\" />\r\n                    Import\r\n                  </span>\r\n                  <input\r\n                    type=\"file\"\r\n                    accept=\".json\"\r\n                    onChange={handleImport}\r\n                    className=\"hidden\"\r\n                  />\r\n                </label>\r\n              </Button>\r\n\r\n              <Button\r\n                onClick={handleReset}\r\n                variant=\"danger\"\r\n                size=\"sm\"\r\n                leftIcon={<RotateCcw className=\"h-4 w-4\" />}\r\n              >\r\n                Reset\r\n              </Button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </header>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AAGA;AACA;AACA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AAPA;;;;;;;AASe,SAAS;IACtB,MAAM,EACJ,SAAS,EACT,eAAe,EACf,eAAe,EACf,eAAe,EACf,cAAc,EACf,GAAG,IAAA,kKAAiB;IAErB,MAAM,EAAE,UAAU,EAAE,iBAAiB,EAAE,UAAU,EAAE,GAAG,IAAA,yJAAW;IAEjE,MAAM,eAAe,CAAC;QACpB,MAAM,OAAO,MAAM,MAAM,CAAC,KAAK,EAAE,CAAC,EAAE;QACpC,IAAI,MAAM;YACR,MAAM,SAAS,IAAI;YACnB,OAAO,MAAM,GAAG,CAAA;gBACd,IAAI;oBACF,MAAM,gBAAgB,KAAK,KAAK,CAAC,EAAE,MAAM,EAAE;oBAC3C,gBAAgB;gBAClB,EAAE,OAAO,OAAO;oBACd,QAAQ,KAAK,CAAC,8BAA8B;oBAC5C,MACE;gBAEJ;YACF;YACA,OAAO,UAAU,CAAC;QACpB;IACF;IAEA,MAAM,eAAe;QACnB;IACF;IAEA,MAAM,cAAc;QAClB,IACE,QACE,iFAEF;YACA;QACF;IACF;IAEA,qBACE,8OAAC;QAAO,WAAU;;0BAEhB,8OAAC;gBAAI,WAAU;;;;;;0BACf,8OAAC;gBAAI,WAAU;;;;;;0BAEf,8OAAC;gBAAI,WAAU;0BACb,cAAA,8OAAC;oBAAI,WAAU;;sCAEb,8OAAC;4BAAI,WAAU;sCACb,cAAA,8OAAC;gCAAI,WAAU;;kDAEb,8OAAC;;0DACC,8OAAC;gDAAM,WAAU;0DAAgD;;;;;;0DAGjE,8OAAC;gDACC,MAAK;gDACL,OAAO,UAAU,IAAI;gDACrB,UAAU,CAAA,IAAK,gBAAgB;wDAAE,MAAM,EAAE,MAAM,CAAC,KAAK;oDAAC;gDACtD,WAAU;gDACV,aAAY;;;;;;;;;;;;kDAKhB,8OAAC;;0DACC,8OAAC;gDAAM,WAAU;0DAAgD;;;;;;0DAGjE,8OAAC;gDACC,MAAK;gDACL,KAAI;gDACJ,KAAI;gDACJ,OAAO,UAAU,KAAK;gDACtB,UAAU,CAAA,IACR,gBAAgB;wDAAE,OAAO,SAAS,EAAE,MAAM,CAAC,KAAK,KAAK;oDAAE;gDAEzD,WAAU;;;;;;;;;;;;kDAKd,8OAAC;;0DACC,8OAAC;gDAAM,WAAU;0DAAgD;;;;;;0DAGjE,8OAAC;gDAAI,WAAU;;kEACb,8OAAC;wDACC,MAAK;wDACL,OAAO,UAAU,KAAK,EAAE,QAAQ;wDAChC,UAAU,CAAA,IACR,gBAAgB;gEACd,OAAO;oEACL,GAAG,UAAU,KAAK;oEAClB,MAAM,EAAE,MAAM,CAAC,KAAK;oEACpB,UAAU;gEACZ;4DACF;wDAEF,WAAU;wDACV,aAAY;;;;;;oDAEb,UAAU,KAAK,EAAE,0BAChB,8OAAC;wDAAK,WAAU;kEAAgD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;sCAU1E,8OAAC;4BAAI,WAAU;;8CAEb,8OAAC,qLAAa;oCAAC,QAAQ;;;;;;8CAEvB,8OAAC;oCAAI,WAAU;;sDACb,8OAAC,oLAAM;4CACL,SAAS;4CACT,UAAU,CAAC;4CACX,SAAQ;4CACR,MAAK;4CACL,wBAAU,8OAAC,0MAAI;gDAAC,WAAU;;;;;;sDAC3B;;;;;;sDAID,8OAAC,oLAAM;4CACL,SAAS;4CACT,SAAQ;4CACR,MAAK;4CACL,wBAAU,8OAAC,sNAAQ;gDAAC,WAAU;;;;;;sDAC/B;;;;;;sDAID,8OAAC,oLAAM;4CACL,OAAO;4CACP,SAAQ;4CACR,MAAK;sDAEL,cAAA,8OAAC;gDAAM,WAAU;;kEACf,8OAAC;wDAAK,WAAU;;0EACd,8OAAC,gNAAM;gEAAC,WAAU;;;;;;4DAAY;;;;;;;kEAGhC,8OAAC;wDACC,MAAK;wDACL,QAAO;wDACP,UAAU;wDACV,WAAU;;;;;;;;;;;;;;;;;sDAKhB,8OAAC,oLAAM;4CACL,SAAS;4CACT,SAAQ;4CACR,MAAK;4CACL,wBAAU,8OAAC,6NAAS;gDAAC,WAAU;;;;;;sDAChC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AASf","debugId":null}},
    {"offset": {"line": 6553, "column": 0}, "map": {"version":3,"sources":["file:///home/irakli/Projects/RollKeeper/apps/web/src/components/ui/character/ClassSelector.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React, { useState } from 'react';\r\nimport { ClassInfo } from '@/types/character';\r\nimport { COMMON_CLASSES } from '@/utils/constants';\r\nimport { CustomSwitcher } from '@/components/ui';\r\nimport { FancySelect } from '@/components/ui/forms/FancySelect';\r\n\r\ninterface ClassSelectorProps {\r\n  value: ClassInfo;\r\n  onChange: (classInfo: ClassInfo) => void;\r\n  className?: string;\r\n}\r\n\r\nexport default function ClassSelector({\r\n  value,\r\n  onChange,\r\n  className = '',\r\n}: ClassSelectorProps) {\r\n  const [isCustom, setIsCustom] = useState(value.isCustom);\r\n  const [customName, setCustomName] = useState(\r\n    value.isCustom ? value.name : ''\r\n  );\r\n\r\n  const handleStandardClassChange = (className: string) => {\r\n    const classData = COMMON_CLASSES.find(c => c.name === className);\r\n    if (classData) {\r\n      setIsCustom(false);\r\n      onChange({\r\n        name: classData.name,\r\n        isCustom: false,\r\n        spellcaster: classData.spellcaster,\r\n        hitDie: classData.hitDie,\r\n      });\r\n    }\r\n  };\r\n\r\n  const handleCustomClassChange = (customName: string) => {\r\n    setCustomName(customName);\r\n    onChange({\r\n      name: customName,\r\n      isCustom: true,\r\n      spellcaster: 'none', // Default for custom classes\r\n      hitDie: 8, // Default hit die for custom classes\r\n    });\r\n  };\r\n\r\n  const handleCustomToggle = (custom: boolean) => {\r\n    setIsCustom(custom);\r\n    if (custom) {\r\n      onChange({\r\n        name: customName,\r\n        isCustom: true,\r\n        spellcaster: 'none',\r\n        hitDie: 8, // Default hit die for custom classes\r\n      });\r\n    } else {\r\n      // Reset to first standard class if switching from custom\r\n      const firstClass = COMMON_CLASSES[0];\r\n      onChange({\r\n        name: firstClass.name,\r\n        isCustom: false,\r\n        spellcaster: firstClass.spellcaster,\r\n        hitDie: firstClass.hitDie,\r\n      });\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className={`space-y-3 ${className}`}>\r\n      <div className=\"space-y-2\">\r\n        <label className=\"text-sm font-medium text-gray-700\">Class</label>\r\n\r\n        {/* Toggle between standard and custom */}\r\n        <CustomSwitcher\r\n          leftLabel=\"Standard\"\r\n          rightLabel=\"Custom\"\r\n          leftValue={false}\r\n          rightValue={true}\r\n          currentValue={isCustom}\r\n          onChange={value => handleCustomToggle(value as boolean)}\r\n          color=\"amber\"\r\n          size=\"sm\"\r\n          className=\"w-fit\"\r\n        />\r\n      </div>\r\n\r\n      {/* Class selection */}\r\n      {isCustom ? (\r\n        <div className=\"space-y-2\">\r\n          <input\r\n            type=\"text\"\r\n            value={customName}\r\n            onChange={e => handleCustomClassChange(e.target.value)}\r\n            placeholder=\"Enter custom class name...\"\r\n            className=\"w-full rounded-md border border-gray-300 px-3 py-2 text-gray-800 shadow-sm focus:border-blue-500 focus:ring-blue-500 focus:outline-none\"\r\n          />\r\n          <p className=\"text-xs text-gray-500\">\r\n            Custom classes default to non-spellcasters. You can adjust spell\r\n            slots manually if needed.\r\n          </p>\r\n        </div>\r\n      ) : (\r\n        <div className=\"space-y-2\">\r\n          <FancySelect\r\n            options={[\r\n              { value: '', label: 'Select a class...' },\r\n              ...COMMON_CLASSES.map(classData => ({\r\n                value: classData.name,\r\n                label: classData.name,\r\n                description:\r\n                  classData.spellcaster !== 'none'\r\n                    ? `${\r\n                        classData.spellcaster === 'full'\r\n                          ? 'Full'\r\n                          : classData.spellcaster === 'half'\r\n                            ? 'Half'\r\n                            : classData.spellcaster === 'third'\r\n                              ? '1/3'\r\n                              : 'Pact'\r\n                      } Caster`\r\n                    : 'Non-spellcaster',\r\n              })),\r\n            ]}\r\n            value={value.isCustom ? '' : value.name}\r\n            onChange={selectedValue =>\r\n              handleStandardClassChange(selectedValue as string)\r\n            }\r\n            placeholder=\"Select a class...\"\r\n            color=\"blue\"\r\n          />\r\n\r\n          {/* Show spellcaster info for selected class */}\r\n          {value.name && !value.isCustom && (\r\n            <div className=\"text-xs text-gray-600\">\r\n              {value.spellcaster === 'none' && 'â€¢ Non-spellcaster'}\r\n              {value.spellcaster === 'full' &&\r\n                'â€¢ Full spellcaster (Spell slots by class level)'}\r\n              {value.spellcaster === 'half' &&\r\n                'â€¢ Half caster (Spell slots by half class level)'}\r\n              {value.spellcaster === 'third' &&\r\n                'â€¢ Third caster (Limited spell slots)'}\r\n              {value.spellcaster === 'warlock' &&\r\n                'â€¢ Warlock (Pact Magic - short rest recovery)'}\r\n            </div>\r\n          )}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AAEA;AACA;AAAA;AACA;AANA;;;;;;AAce,SAAS,cAAc,EACpC,KAAK,EACL,QAAQ,EACR,YAAY,EAAE,EACK;IACnB,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,iNAAQ,EAAC,MAAM,QAAQ;IACvD,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,iNAAQ,EAC1C,MAAM,QAAQ,GAAG,MAAM,IAAI,GAAG;IAGhC,MAAM,4BAA4B,CAAC;QACjC,MAAM,YAAY,0JAAc,CAAC,IAAI,CAAC,CAAA,IAAK,EAAE,IAAI,KAAK;QACtD,IAAI,WAAW;YACb,YAAY;YACZ,SAAS;gBACP,MAAM,UAAU,IAAI;gBACpB,UAAU;gBACV,aAAa,UAAU,WAAW;gBAClC,QAAQ,UAAU,MAAM;YAC1B;QACF;IACF;IAEA,MAAM,0BAA0B,CAAC;QAC/B,cAAc;QACd,SAAS;YACP,MAAM;YACN,UAAU;YACV,aAAa;YACb,QAAQ;QACV;IACF;IAEA,MAAM,qBAAqB,CAAC;QAC1B,YAAY;QACZ,IAAI,QAAQ;YACV,SAAS;gBACP,MAAM;gBACN,UAAU;gBACV,aAAa;gBACb,QAAQ;YACV;QACF,OAAO;YACL,yDAAyD;YACzD,MAAM,aAAa,0JAAc,CAAC,EAAE;YACpC,SAAS;gBACP,MAAM,WAAW,IAAI;gBACrB,UAAU;gBACV,aAAa,WAAW,WAAW;gBACnC,QAAQ,WAAW,MAAM;YAC3B;QACF;IACF;IAEA,qBACE,8OAAC;QAAI,WAAW,CAAC,UAAU,EAAE,WAAW;;0BACtC,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAM,WAAU;kCAAoC;;;;;;kCAGrD,8OAAC,0KAAc;wBACb,WAAU;wBACV,YAAW;wBACX,WAAW;wBACX,YAAY;wBACZ,cAAc;wBACd,UAAU,CAAA,QAAS,mBAAmB;wBACtC,OAAM;wBACN,MAAK;wBACL,WAAU;;;;;;;;;;;;YAKb,yBACC,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBACC,MAAK;wBACL,OAAO;wBACP,UAAU,CAAA,IAAK,wBAAwB,EAAE,MAAM,CAAC,KAAK;wBACrD,aAAY;wBACZ,WAAU;;;;;;kCAEZ,8OAAC;wBAAE,WAAU;kCAAwB;;;;;;;;;;;qCAMvC,8OAAC;gBAAI,WAAU;;kCACb,8OAAC,8KAAW;wBACV,SAAS;4BACP;gCAAE,OAAO;gCAAI,OAAO;4BAAoB;+BACrC,0JAAc,CAAC,GAAG,CAAC,CAAA,YAAa,CAAC;oCAClC,OAAO,UAAU,IAAI;oCACrB,OAAO,UAAU,IAAI;oCACrB,aACE,UAAU,WAAW,KAAK,SACtB,GACE,UAAU,WAAW,KAAK,SACtB,SACA,UAAU,WAAW,KAAK,SACxB,SACA,UAAU,WAAW,KAAK,UACxB,QACA,OACT,OAAO,CAAC,GACT;gCACR,CAAC;yBACF;wBACD,OAAO,MAAM,QAAQ,GAAG,KAAK,MAAM,IAAI;wBACvC,UAAU,CAAA,gBACR,0BAA0B;wBAE5B,aAAY;wBACZ,OAAM;;;;;;oBAIP,MAAM,IAAI,IAAI,CAAC,MAAM,QAAQ,kBAC5B,8OAAC;wBAAI,WAAU;;4BACZ,MAAM,WAAW,KAAK,UAAU;4BAChC,MAAM,WAAW,KAAK,UACrB;4BACD,MAAM,WAAW,KAAK,UACrB;4BACD,MAAM,WAAW,KAAK,WACrB;4BACD,MAAM,WAAW,KAAK,aACrB;;;;;;;;;;;;;;;;;;;AAOhB","debugId":null}},
    {"offset": {"line": 6730, "column": 0}, "map": {"version":3,"sources":["file:///home/irakli/Projects/RollKeeper/apps/web/src/components/ui/character/ConcentrationTracker.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React from 'react';\r\nimport { Eye, X, Clock } from 'lucide-react';\r\nimport { ConcentrationState } from '@/types/character';\r\n\r\ninterface ConcentrationTrackerProps {\r\n  concentration: ConcentrationState;\r\n  onStopConcentration: () => void;\r\n  className?: string;\r\n}\r\n\r\nexport default function ConcentrationTracker({\r\n  concentration,\r\n  onStopConcentration,\r\n  className = '',\r\n}: ConcentrationTrackerProps) {\r\n  if (!concentration.isConcentrating) {\r\n    return null;\r\n  }\r\n\r\n  // Calculate duration if startedAt is available\r\n  const getDuration = () => {\r\n    if (!concentration.startedAt) return '';\r\n\r\n    const start = new Date(concentration.startedAt);\r\n    const now = new Date();\r\n    const diffMs = now.getTime() - start.getTime();\r\n    const diffMinutes = Math.floor(diffMs / (1000 * 60));\r\n    const diffSeconds = Math.floor((diffMs % (1000 * 60)) / 1000);\r\n\r\n    if (diffMinutes > 0) {\r\n      return `${diffMinutes}m ${diffSeconds}s`;\r\n    }\r\n    return `${diffSeconds}s`;\r\n  };\r\n\r\n  return (\r\n    <div\r\n      className={`rounded-lg border border-orange-200 bg-gradient-to-r from-orange-50 to-amber-50 p-4 ${className}`}\r\n    >\r\n      <div className=\"flex items-center justify-between\">\r\n        <div className=\"flex items-center gap-3\">\r\n          <div className=\"flex items-center gap-2\">\r\n            <Eye className=\"text-orange-600\" size={20} />\r\n            <div>\r\n              <h3 className=\"font-semibold text-orange-900\">Concentrating</h3>\r\n              <div className=\"flex items-center gap-2 text-sm text-orange-700\">\r\n                <span className=\"font-medium\">{concentration.spellName}</span>\r\n                {concentration.castAt && concentration.castAt > 0 && (\r\n                  <>\r\n                    <span>â€¢</span>\r\n                    <span>Level {concentration.castAt}</span>\r\n                  </>\r\n                )}\r\n                {concentration.startedAt && (\r\n                  <>\r\n                    <span>â€¢</span>\r\n                    <div className=\"flex items-center gap-1\">\r\n                      <Clock size={12} />\r\n                      <span>{getDuration()}</span>\r\n                    </div>\r\n                  </>\r\n                )}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <button\r\n          onClick={onStopConcentration}\r\n          className=\"flex items-center gap-2 rounded-lg border border-orange-300 bg-orange-100 px-3 py-2 text-sm font-medium text-orange-700 transition-colors hover:bg-orange-200\"\r\n          title=\"End concentration\"\r\n        >\r\n          <X size={14} />\r\n          End\r\n        </button>\r\n      </div>\r\n\r\n      <div className=\"mt-3 rounded-md bg-orange-100 px-3 py-2 text-xs text-orange-600\">\r\n        <p className=\"mb-1 font-medium\">Concentration Rules:</p>\r\n        <ul className=\"space-y-1 text-orange-700\">\r\n          <li>â€¢ Taking damage may require a Constitution saving throw</li>\r\n          <li>â€¢ Casting another concentration spell ends this one</li>\r\n          <li>â€¢ Being incapacitated or killed ends concentration</li>\r\n        </ul>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AAGA;AAAA;AAAA;AAHA;;;AAYe,SAAS,qBAAqB,EAC3C,aAAa,EACb,mBAAmB,EACnB,YAAY,EAAE,EACY;IAC1B,IAAI,CAAC,cAAc,eAAe,EAAE;QAClC,OAAO;IACT;IAEA,+CAA+C;IAC/C,MAAM,cAAc;QAClB,IAAI,CAAC,cAAc,SAAS,EAAE,OAAO;QAErC,MAAM,QAAQ,IAAI,KAAK,cAAc,SAAS;QAC9C,MAAM,MAAM,IAAI;QAChB,MAAM,SAAS,IAAI,OAAO,KAAK,MAAM,OAAO;QAC5C,MAAM,cAAc,KAAK,KAAK,CAAC,SAAS,CAAC,OAAO,EAAE;QAClD,MAAM,cAAc,KAAK,KAAK,CAAC,AAAC,SAAS,CAAC,OAAO,EAAE,IAAK;QAExD,IAAI,cAAc,GAAG;YACnB,OAAO,GAAG,YAAY,EAAE,EAAE,YAAY,CAAC,CAAC;QAC1C;QACA,OAAO,GAAG,YAAY,CAAC,CAAC;IAC1B;IAEA,qBACE,8OAAC;QACC,WAAW,CAAC,oFAAoF,EAAE,WAAW;;0BAE7G,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAI,WAAU;kCACb,cAAA,8OAAC;4BAAI,WAAU;;8CACb,8OAAC,uMAAG;oCAAC,WAAU;oCAAkB,MAAM;;;;;;8CACvC,8OAAC;;sDACC,8OAAC;4CAAG,WAAU;sDAAgC;;;;;;sDAC9C,8OAAC;4CAAI,WAAU;;8DACb,8OAAC;oDAAK,WAAU;8DAAe,cAAc,SAAS;;;;;;gDACrD,cAAc,MAAM,IAAI,cAAc,MAAM,GAAG,mBAC9C;;sEACE,8OAAC;sEAAK;;;;;;sEACN,8OAAC;;gEAAK;gEAAO,cAAc,MAAM;;;;;;;;;gDAGpC,cAAc,SAAS,kBACtB;;sEACE,8OAAC;sEAAK;;;;;;sEACN,8OAAC;4DAAI,WAAU;;8EACb,8OAAC,6MAAK;oEAAC,MAAM;;;;;;8EACb,8OAAC;8EAAM;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;kCASrB,8OAAC;wBACC,SAAS;wBACT,WAAU;wBACV,OAAM;;0CAEN,8OAAC,iMAAC;gCAAC,MAAM;;;;;;4BAAM;;;;;;;;;;;;;0BAKnB,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAE,WAAU;kCAAmB;;;;;;kCAChC,8OAAC;wBAAG,WAAU;;0CACZ,8OAAC;0CAAG;;;;;;0CACJ,8OAAC;0CAAG;;;;;;0CACJ,8OAAC;0CAAG;;;;;;;;;;;;;;;;;;;;;;;;AAKd","debugId":null}},
    {"offset": {"line": 6959, "column": 0}, "map": {"version":3,"sources":["file:///home/irakli/Projects/RollKeeper/apps/web/src/components/ui/character/HitDiceManager.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React from 'react';\r\nimport { Dice6, Info } from 'lucide-react';\r\nimport { ClassInfo } from '@/types/character';\r\nimport { CLASS_HIT_DICE } from '@/utils/constants';\r\nimport { FancySelect } from '../forms/FancySelect';\r\n\r\ninterface HitDiceManagerProps {\r\n  classInfo: ClassInfo;\r\n  level: number;\r\n  hitDice: string;\r\n  onUpdateClass: (classInfo: ClassInfo) => void;\r\n  onUpdateHitDice: (hitDice: string) => void;\r\n  className?: string;\r\n}\r\n\r\nconst HIT_DIE_OPTIONS = [\r\n  { value: 6, label: 'd6' },\r\n  { value: 8, label: 'd8' },\r\n  { value: 10, label: 'd10' },\r\n  { value: 12, label: 'd12' },\r\n];\r\n\r\nexport default function HitDiceManager({\r\n  classInfo,\r\n  level,\r\n  hitDice,\r\n  onUpdateClass,\r\n  onUpdateHitDice,\r\n  className = '',\r\n}: HitDiceManagerProps) {\r\n  const getHitDieForClass = (className: string): number => {\r\n    return CLASS_HIT_DICE[className] || 8; // Default to d8\r\n  };\r\n\r\n  const getCurrentHitDie = (): number => {\r\n    if (!classInfo.isCustom) {\r\n      return getHitDieForClass(classInfo.name);\r\n    }\r\n    return classInfo.hitDie || 8;\r\n  };\r\n\r\n  const getDisplayHitDice = (): string => {\r\n    const hitDie = getCurrentHitDie();\r\n    return `${level}d${hitDie}`;\r\n  };\r\n\r\n  const handleCustomHitDieChange = (newHitDie: number) => {\r\n    if (classInfo.isCustom) {\r\n      onUpdateClass({\r\n        ...classInfo,\r\n        hitDie: newHitDie,\r\n      });\r\n      // Also update the character's hitDice string\r\n      onUpdateHitDice(`${level}d${newHitDie}`);\r\n    }\r\n  };\r\n\r\n  // Update hitDice string when level or class changes\r\n  React.useEffect(() => {\r\n    let hitDie: number;\r\n    if (!classInfo.isCustom) {\r\n      hitDie = CLASS_HIT_DICE[classInfo.name] || 8;\r\n    } else {\r\n      hitDie = classInfo.hitDie || 8;\r\n    }\r\n\r\n    const expectedHitDice = `${level}d${hitDie}`;\r\n    if (hitDice !== expectedHitDice) {\r\n      onUpdateHitDice(expectedHitDice);\r\n    }\r\n  }, [\r\n    level,\r\n    classInfo.name,\r\n    classInfo.hitDie,\r\n    classInfo.isCustom,\r\n    hitDice,\r\n    onUpdateHitDice,\r\n  ]);\r\n\r\n  return (\r\n    <div\r\n      className={`rounded-lg border border-purple-200 bg-white p-4 shadow ${className}`}\r\n    >\r\n      <div className=\"mb-3 flex items-center gap-2\">\r\n        <Dice6 size={18} className=\"text-purple-600\" />\r\n        <h3 className=\"text-sm font-medium text-gray-700\">Hit Dice</h3>\r\n      </div>\r\n\r\n      {/* Hit Dice Display */}\r\n      <div className=\"mb-4 text-center\">\r\n        <div className=\"rounded-lg border-2 border-purple-200 bg-purple-50 p-4\">\r\n          <div className=\"text-2xl font-bold text-purple-800\">\r\n            {getDisplayHitDice()}\r\n          </div>\r\n          <div className=\"mt-1 text-xs text-purple-600\">\r\n            Level {level} â€¢ d{getCurrentHitDie()} hit die\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Custom Class Hit Die Selection */}\r\n      {classInfo.isCustom && (\r\n        <div className=\"space-y-2\">\r\n          <label className=\"block text-sm font-medium text-gray-700\">\r\n            Select Hit Die for Custom Class\r\n          </label>\r\n          <FancySelect\r\n            options={HIT_DIE_OPTIONS.map(option => ({\r\n              value: option.value,\r\n              label: option.label,\r\n              description:\r\n                option.value === 6\r\n                  ? 'Wizard, Sorcerer'\r\n                  : option.value === 8\r\n                    ? 'Most classes'\r\n                    : option.value === 10\r\n                      ? 'Fighter, Paladin, Ranger'\r\n                      : 'Barbarian',\r\n            }))}\r\n            value={getCurrentHitDie()}\r\n            onChange={value => handleCustomHitDieChange(value as number)}\r\n            color=\"purple\"\r\n          />\r\n        </div>\r\n      )}\r\n\r\n      {/* Standard Class Info */}\r\n      {!classInfo.isCustom && classInfo.name && (\r\n        <div className=\"text-center\">\r\n          <div className=\"inline-flex items-center gap-1 rounded-full bg-purple-100 px-3 py-1 text-xs text-purple-700\">\r\n            <Info size={12} />\r\n            <span>Auto-set for {classInfo.name}</span>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Help Text */}\r\n      <div className=\"mt-3 text-center text-xs text-gray-500\">\r\n        <p>Hit dice are used for healing during short rests</p>\r\n        <p>Roll your hit die + CON modifier to regain HP</p>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAAA;AAEA;AACA;AANA;;;;;;AAiBA,MAAM,kBAAkB;IACtB;QAAE,OAAO;QAAG,OAAO;IAAK;IACxB;QAAE,OAAO;QAAG,OAAO;IAAK;IACxB;QAAE,OAAO;QAAI,OAAO;IAAM;IAC1B;QAAE,OAAO;QAAI,OAAO;IAAM;CAC3B;AAEc,SAAS,eAAe,EACrC,SAAS,EACT,KAAK,EACL,OAAO,EACP,aAAa,EACb,eAAe,EACf,YAAY,EAAE,EACM;IACpB,MAAM,oBAAoB,CAAC;QACzB,OAAO,0JAAc,CAAC,UAAU,IAAI,GAAG,gBAAgB;IACzD;IAEA,MAAM,mBAAmB;QACvB,IAAI,CAAC,UAAU,QAAQ,EAAE;YACvB,OAAO,kBAAkB,UAAU,IAAI;QACzC;QACA,OAAO,UAAU,MAAM,IAAI;IAC7B;IAEA,MAAM,oBAAoB;QACxB,MAAM,SAAS;QACf,OAAO,GAAG,MAAM,CAAC,EAAE,QAAQ;IAC7B;IAEA,MAAM,2BAA2B,CAAC;QAChC,IAAI,UAAU,QAAQ,EAAE;YACtB,cAAc;gBACZ,GAAG,SAAS;gBACZ,QAAQ;YACV;YACA,6CAA6C;YAC7C,gBAAgB,GAAG,MAAM,CAAC,EAAE,WAAW;QACzC;IACF;IAEA,oDAAoD;IACpD,gNAAK,CAAC,SAAS,CAAC;QACd,IAAI;QACJ,IAAI,CAAC,UAAU,QAAQ,EAAE;YACvB,SAAS,0JAAc,CAAC,UAAU,IAAI,CAAC,IAAI;QAC7C,OAAO;YACL,SAAS,UAAU,MAAM,IAAI;QAC/B;QAEA,MAAM,kBAAkB,GAAG,MAAM,CAAC,EAAE,QAAQ;QAC5C,IAAI,YAAY,iBAAiB;YAC/B,gBAAgB;QAClB;IACF,GAAG;QACD;QACA,UAAU,IAAI;QACd,UAAU,MAAM;QAChB,UAAU,QAAQ;QAClB;QACA;KACD;IAED,qBACE,8OAAC;QACC,WAAW,CAAC,wDAAwD,EAAE,WAAW;;0BAEjF,8OAAC;gBAAI,WAAU;;kCACb,8OAAC,iNAAK;wBAAC,MAAM;wBAAI,WAAU;;;;;;kCAC3B,8OAAC;wBAAG,WAAU;kCAAoC;;;;;;;;;;;;0BAIpD,8OAAC;gBAAI,WAAU;0BACb,cAAA,8OAAC;oBAAI,WAAU;;sCACb,8OAAC;4BAAI,WAAU;sCACZ;;;;;;sCAEH,8OAAC;4BAAI,WAAU;;gCAA+B;gCACrC;gCAAM;gCAAK;gCAAmB;;;;;;;;;;;;;;;;;;YAM1C,UAAU,QAAQ,kBACjB,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAM,WAAU;kCAA0C;;;;;;kCAG3D,8OAAC,8KAAW;wBACV,SAAS,gBAAgB,GAAG,CAAC,CAAA,SAAU,CAAC;gCACtC,OAAO,OAAO,KAAK;gCACnB,OAAO,OAAO,KAAK;gCACnB,aACE,OAAO,KAAK,KAAK,IACb,qBACA,OAAO,KAAK,KAAK,IACf,iBACA,OAAO,KAAK,KAAK,KACf,6BACA;4BACZ,CAAC;wBACD,OAAO;wBACP,UAAU,CAAA,QAAS,yBAAyB;wBAC5C,OAAM;;;;;;;;;;;;YAMX,CAAC,UAAU,QAAQ,IAAI,UAAU,IAAI,kBACpC,8OAAC;gBAAI,WAAU;0BACb,cAAA,8OAAC;oBAAI,WAAU;;sCACb,8OAAC,0MAAI;4BAAC,MAAM;;;;;;sCACZ,8OAAC;;gCAAK;gCAAc,UAAU,IAAI;;;;;;;;;;;;;;;;;;0BAMxC,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;kCAAE;;;;;;kCACH,8OAAC;kCAAE;;;;;;;;;;;;;;;;;;AAIX","debugId":null}},
    {"offset": {"line": 7201, "column": 0}, "map": {"version":3,"sources":["file:///home/irakli/Projects/RollKeeper/apps/web/src/components/ui/character/QuickStats.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { formatModifier } from '@/utils/calculations';\r\n\r\ninterface QuickStatsProps {\r\n  passivePerception: number;\r\n  proficiencyBonus: number;\r\n}\r\n\r\nexport default function QuickStats({\r\n  passivePerception,\r\n  proficiencyBonus,\r\n}: QuickStatsProps) {\r\n  return (\r\n    <div className=\"rounded-lg border border-amber-200 bg-white p-6 shadow-lg\">\r\n      <h2 className=\"mb-4 border-b border-gray-200 pb-2 text-lg font-bold text-gray-800\">\r\n        Quick Stats\r\n      </h2>\r\n      <div className=\"space-y-2 text-sm\">\r\n        <div className=\"flex justify-between\">\r\n          <span className=\"text-gray-600\">Passive Perception</span>\r\n          <span className=\"font-semibold text-gray-800\">\r\n            {passivePerception}\r\n          </span>\r\n        </div>\r\n        <div className=\"flex justify-between\">\r\n          <span className=\"text-gray-600\">Proficiency Bonus</span>\r\n          <span className=\"font-semibold text-gray-800\">\r\n            {formatModifier(proficiencyBonus)}\r\n          </span>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AAFA;;;AASe,SAAS,WAAW,EACjC,iBAAiB,EACjB,gBAAgB,EACA;IAChB,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBAAG,WAAU;0BAAqE;;;;;;0BAGnF,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;gCAAK,WAAU;0CAAgB;;;;;;0CAChC,8OAAC;gCAAK,WAAU;0CACb;;;;;;;;;;;;kCAGL,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;gCAAK,WAAU;0CAAgB;;;;;;0CAChC,8OAAC;gCAAK,WAAU;0CACb,IAAA,6JAAc,EAAC;;;;;;;;;;;;;;;;;;;;;;;;AAM5B","debugId":null}},
    {"offset": {"line": 7292, "column": 0}, "map": {"version":3,"sources":["file:///home/irakli/Projects/RollKeeper/apps/web/src/components/ui/character/index.ts"],"sourcesContent":["// Character Sheet Components\r\nexport { default as AbilityScores } from './AbilityScores';\r\nexport { default as ActionsSection } from './ActionsSection';\r\nexport { default as ArmorClassManager } from './ArmorClassManager';\r\nexport { default as CharacterBackgroundEditor } from './CharacterBackgroundEditor';\r\nexport { default as CharacterBasicInfo } from './CharacterBasicInfo';\r\nexport { default as CharacterHeaderSection } from './CharacterHeaderSection';\r\nexport { default as CharacterSheetHeader } from './CharacterSheetHeader';\r\nexport { default as ClassSelector } from './ClassSelector';\r\nexport { default as CombatStats } from './CombatStats';\r\nexport { default as ConcentrationTracker } from './ConcentrationTracker';\r\nexport { default as HeroicInspirationTracker } from './HeroicInspirationTracker';\r\nexport { default as HitDiceManager } from './HitDiceManager';\r\nexport { default as HitPointManager } from './HitPointManager';\r\nexport { default as QuickStats } from './QuickStats';\r\nexport { default as SavingThrows } from './SavingThrows';\r\nexport { default as Skills } from './Skills';\r\nexport { default as SpellSlotTracker } from './SpellSlotTracker';\r\nexport { default as TraitTracker } from './TraitTracker';\r\nexport { default as XPTracker } from './XPTracker';\r\n"],"names":[],"mappings":"AAAA,6BAA6B;;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","debugId":null}},
    {"offset": {"line": 7345, "column": 0}, "map": {"version":3,"sources":["file:///home/irakli/Projects/RollKeeper/apps/web/src/components/ui/character/ActionsSection.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React, { useState, useEffect } from 'react';\r\nimport { ChevronDown, ChevronRight } from 'lucide-react';\r\nimport ErrorBoundary from '@/components/ui/feedback/ErrorBoundary';\r\nimport { EquippedWeapons } from '@/components/EquippedWeapons';\r\nimport { EnhancedQuickSpells } from '@/components/EnhancedQuickSpells';\r\nimport { ConcentrationTracker } from '@/components/ui/character';\r\nimport { Button } from '@/components/ui/forms';\r\nimport { Badge } from '@/components/ui/layout';\r\nimport { CharacterState } from '@/types/character';\r\n\r\ninterface ActionsSectionProps {\r\n  character: CharacterState;\r\n  showAttackRoll: (\r\n    name: string,\r\n    roll: number,\r\n    modifier: number,\r\n    isCrit: boolean\r\n  ) => void;\r\n  showSavingThrow: (\r\n    spellName: string,\r\n    saveDC: number,\r\n    saveType?: string,\r\n    damage?: string,\r\n    damageType?: string\r\n  ) => void;\r\n  showDamageRoll: (\r\n    weaponName: string,\r\n    damageRoll: string,\r\n    damageType?: string,\r\n    versatile?: boolean\r\n  ) => void;\r\n  animateRoll?: (notation: string) => Promise<unknown>;\r\n  switchToTab: (tabId: string) => void;\r\n  onStopConcentration: () => void;\r\n}\r\n\r\n// Simple collapsible component for subsections\r\ninterface CollapsibleSubsectionProps {\r\n  title: string;\r\n  icon: string;\r\n  children: React.ReactNode;\r\n  defaultExpanded?: boolean;\r\n  persistKey: string;\r\n  badge?: React.ReactNode;\r\n  extraContent?: React.ReactNode;\r\n}\r\n\r\nconst CollapsibleSubsection: React.FC<CollapsibleSubsectionProps> = ({\r\n  title,\r\n  icon,\r\n  children,\r\n  defaultExpanded = true,\r\n  persistKey,\r\n  badge,\r\n  extraContent,\r\n}) => {\r\n  const [isExpanded, setIsExpanded] = useState(defaultExpanded);\r\n\r\n  useEffect(() => {\r\n    const savedState = localStorage.getItem(`subsection-${persistKey}`);\r\n    if (savedState !== null) {\r\n      setIsExpanded(JSON.parse(savedState));\r\n    }\r\n  }, [persistKey]);\r\n\r\n  const toggleExpanded = () => {\r\n    const newState = !isExpanded;\r\n    setIsExpanded(newState);\r\n    localStorage.setItem(`subsection-${persistKey}`, JSON.stringify(newState));\r\n  };\r\n\r\n  return (\r\n    <div className=\"rounded-lg border border-gray-200 bg-white shadow\">\r\n      <div className=\"flex w-full items-center justify-between p-4\">\r\n        <button\r\n          onClick={toggleExpanded}\r\n          className=\"flex flex-1 items-center gap-2 text-left transition-colors hover:opacity-80\"\r\n          aria-expanded={isExpanded}\r\n        >\r\n          <span className=\"text-lg\">{icon}</span>\r\n          <h3 className=\"text-lg font-bold text-gray-800\">{title}</h3>\r\n          {isExpanded ? <ChevronDown size={20} className=\"ml-2\" /> : <ChevronRight size={20} className=\"ml-2\" />}\r\n        </button>\r\n        <div className=\"flex items-center gap-2 ml-4\">\r\n          {badge}\r\n          {extraContent}\r\n        </div>\r\n      </div>\r\n      \r\n      {isExpanded && (\r\n        <div className=\"border-t border-gray-200 p-4\">\r\n          {children}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default function ActionsSection({\r\n  character,\r\n  showAttackRoll,\r\n  showSavingThrow,\r\n  showDamageRoll,\r\n  animateRoll,\r\n  switchToTab,\r\n  onStopConcentration,\r\n}: ActionsSectionProps) {\r\n  const equippedWeapons = character.weapons.filter(weapon => weapon.isEquipped);\r\n  const actionSpells = character.spells.filter(spell =>\r\n    (spell.level === 0 && spell.isPrepared) || // Only prepared cantrips\r\n    (spell.level > 0 && spell.isPrepared) || // Prepared spells\r\n    spell.isAlwaysPrepared // Always prepared spells\r\n  );\r\n  \r\n  // Calculate prepared spells count (excluding cantrips)\r\n  const preparedSpellsCount = character.spells.filter(spell =>\r\n    spell.level > 0 && (spell.isPrepared || spell.isAlwaysPrepared)\r\n  ).length;\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n        {/* Ready Weapons - Collapsible */}\r\n        <CollapsibleSubsection\r\n          title=\"Ready Weapons\"\r\n          icon=\"âš”ï¸\"\r\n          persistKey=\"ready-weapons\"\r\n          defaultExpanded={true}\r\n          badge={\r\n            equippedWeapons.length > 0 && (\r\n              <span className=\"rounded-full bg-blue-100 px-2 py-1 text-sm font-medium text-blue-800\">\r\n                {equippedWeapons.length} equipped\r\n              </span>\r\n            )\r\n          }\r\n        >\r\n          <ErrorBoundary\r\n            fallback={\r\n              <div className=\"rounded-lg border border-red-200 bg-red-50 p-4\">\r\n                <p className=\"text-red-600\">Unable to load equipped weapons</p>\r\n              </div>\r\n            }\r\n          >\r\n            <EquippedWeapons\r\n              showAttackRoll={showAttackRoll}\r\n              showDamageRoll={showDamageRoll}\r\n              animateRoll={animateRoll}\r\n            />\r\n          </ErrorBoundary>\r\n        </CollapsibleSubsection>\r\n\r\n        {/* Quick Spells - Collapsible */}\r\n        <CollapsibleSubsection\r\n          title=\"Quick Spells\"\r\n          icon=\"âœ¨\"\r\n          persistKey=\"quick-spells\"\r\n          defaultExpanded={true}\r\n          badge={\r\n            <div className=\"flex items-center gap-2\">\r\n              {actionSpells.length > 0 && (\r\n                <span className=\"rounded-full bg-purple-100 px-2 py-1 text-sm font-medium text-purple-800\">\r\n                  {actionSpells.length} ready\r\n                </span>\r\n              )}\r\n              {preparedSpellsCount > 0 && (\r\n                <Badge variant=\"success\" size=\"sm\" className=\"bg-green-100 text-green-800\">\r\n                  {preparedSpellsCount} prepared\r\n                </Badge>\r\n              )}\r\n            </div>\r\n          }\r\n          extraContent={\r\n            <Button\r\n              onClick={(e) => {\r\n                e.stopPropagation();\r\n                switchToTab('spellcasting');\r\n              }}\r\n              variant=\"ghost\"\r\n              size=\"xs\"\r\n              className=\"bg-purple-100 text-purple-700 hover:bg-purple-200 hover:text-purple-800\"\r\n            >\r\n              Manage\r\n            </Button>\r\n          }\r\n        >\r\n          <ErrorBoundary\r\n            fallback={\r\n              <div className=\"rounded-lg border border-red-200 bg-red-50 p-4\">\r\n                <p className=\"text-red-600\">Unable to load quick spells</p>\r\n              </div>\r\n            }\r\n          >\r\n            <EnhancedQuickSpells\r\n              showAttackRoll={showAttackRoll}\r\n              showSavingThrow={showSavingThrow}\r\n              showDamageRoll={showDamageRoll}\r\n              animateRoll={animateRoll}\r\n            />\r\n          </ErrorBoundary>\r\n        </CollapsibleSubsection>\r\n\r\n        {/* Concentration Tracker */}\r\n        {character.concentration.isConcentrating && (\r\n          <ConcentrationTracker\r\n            concentration={character.concentration}\r\n            onStopConcentration={onStopConcentration}\r\n          />\r\n        )}\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 7635, "column": 0}, "map": {"version":3,"sources":["file:///home/irakli/Projects/RollKeeper/apps/web/src/components/ui/character/LanguagesAndProficiencies.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React, { useState } from 'react';\r\nimport { Plus, X, Languages as LanguagesIcon, Wrench } from 'lucide-react';\r\nimport { Button, Input } from '@/components/ui/forms';\r\nimport { Language, ToolProficiency, ToolProficiencyLevel } from '@/types/character';\r\n\r\ninterface LanguagesAndProficienciesProps {\r\n  languages: Language[];\r\n  toolProficiencies: ToolProficiency[];\r\n  proficiencyBonus: number;\r\n  onAddLanguage: (language: Omit<Language, 'id' | 'createdAt' | 'updatedAt'>) => void;\r\n  onDeleteLanguage: (id: string) => void;\r\n  onAddToolProficiency: (tool: Omit<ToolProficiency, 'id' | 'createdAt' | 'updatedAt'>) => void;\r\n  onUpdateToolProficiency: (id: string, updates: Partial<ToolProficiency>) => void;\r\n  onDeleteToolProficiency: (id: string) => void;\r\n}\r\n\r\nexport default function LanguagesAndProficiencies({\r\n  languages,\r\n  toolProficiencies,\r\n  proficiencyBonus,\r\n  onAddLanguage,\r\n  onDeleteLanguage,\r\n  onAddToolProficiency,\r\n  onUpdateToolProficiency,\r\n  onDeleteToolProficiency,\r\n}: LanguagesAndProficienciesProps) {\r\n  const [isAddingLanguage, setIsAddingLanguage] = useState(false);\r\n  const [isAddingTool, setIsAddingTool] = useState(false);\r\n  const [newLanguageName, setNewLanguageName] = useState('');\r\n  const [newToolName, setNewToolName] = useState('');\r\n\r\n  const handleAddLanguage = () => {\r\n    if (newLanguageName.trim()) {\r\n      onAddLanguage({ name: newLanguageName.trim() });\r\n      setNewLanguageName('');\r\n      setIsAddingLanguage(false);\r\n    }\r\n  };\r\n\r\n  const handleAddTool = () => {\r\n    if (newToolName.trim()) {\r\n      onAddToolProficiency({\r\n        name: newToolName.trim(),\r\n        proficiencyLevel: 'proficient',\r\n      });\r\n      setNewToolName('');\r\n      setIsAddingTool(false);\r\n    }\r\n  };\r\n\r\n  const cycleProficiencyLevel = (tool: ToolProficiency) => {\r\n    const levels: ToolProficiencyLevel[] = ['proficient', 'expertise', 'none'];\r\n    const currentIndex = levels.indexOf(tool.proficiencyLevel);\r\n    const nextIndex = (currentIndex + 1) % levels.length;\r\n    onUpdateToolProficiency(tool.id, { proficiencyLevel: levels[nextIndex] });\r\n  };\r\n\r\n  const getProficiencyModifier = (level: ToolProficiencyLevel): string => {\r\n    if (level === 'expertise') return `+${proficiencyBonus * 2}`;\r\n    if (level === 'proficient') return `+${proficiencyBonus}`;\r\n    return '+0';\r\n  };\r\n\r\n  const getProficiencyColor = (level: ToolProficiencyLevel): string => {\r\n    if (level === 'expertise') return 'bg-gradient-to-r from-purple-500 to-pink-500 text-white border-purple-600 shadow-md';\r\n    if (level === 'proficient') return 'bg-gradient-to-r from-blue-500 to-indigo-500 text-white border-blue-600 shadow-md';\r\n    return 'bg-gray-200 text-gray-600 border-gray-400';\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-4 rounded-lg border border-indigo-200 bg-gradient-to-br from-indigo-50 to-purple-50 p-4 shadow-md mt-4\">\r\n      {/* Languages Section */}\r\n      <div>\r\n        <div className=\"mb-3 flex items-center justify-between\">\r\n          <h3 className=\"flex items-center gap-2 text-lg font-semibold text-indigo-900\">\r\n            <LanguagesIcon size={18} className=\"text-indigo-600\" />\r\n            Languages\r\n          </h3>\r\n          {!isAddingLanguage && (\r\n            <Button\r\n              onClick={() => setIsAddingLanguage(true)}\r\n              variant=\"primary\"\r\n              size=\"xs\"\r\n              leftIcon={<Plus size={16} />}\r\n              className=\"bg-indigo-600 hover:bg-indigo-700\"\r\n              title=\"Add language\"\r\n            />\r\n          )}\r\n        </div>\r\n\r\n        {isAddingLanguage && (\r\n          <div className=\"mb-3 flex items-center gap-2\">\r\n            <Input\r\n              type=\"text\"\r\n              value={newLanguageName}\r\n              onChange={(e) => setNewLanguageName(e.target.value)}\r\n              onKeyDown={(e) => {\r\n                if (e.key === 'Enter') handleAddLanguage();\r\n                if (e.key === 'Escape') {\r\n                  setIsAddingLanguage(false);\r\n                  setNewLanguageName('');\r\n                }\r\n              }}\r\n              placeholder=\"e.g., Elvish\"\r\n              className=\"flex-1\"\r\n              autoFocus\r\n            />\r\n            <Button\r\n              onClick={handleAddLanguage}\r\n              variant=\"primary\"\r\n              size=\"sm\"\r\n              className=\"bg-indigo-600 hover:bg-indigo-700\"\r\n            >\r\n              Add\r\n            </Button>\r\n            <Button\r\n              onClick={() => {\r\n                setIsAddingLanguage(false);\r\n                setNewLanguageName('');\r\n              }}\r\n              variant=\"ghost\"\r\n              size=\"sm\"\r\n              className=\"bg-gray-300 hover:bg-gray-400\"\r\n            >\r\n              Cancel\r\n            </Button>\r\n          </div>\r\n        )}\r\n\r\n        <div className=\"flex flex-wrap gap-2\">\r\n          {languages.length === 0 && !isAddingLanguage && (\r\n            <p className=\"text-sm italic text-indigo-400\">No languages added yet</p>\r\n          )}\r\n          {languages.map((lang) => (\r\n            <div\r\n              key={lang.id}\r\n              className=\"group flex items-center gap-2 rounded-full border-2 border-indigo-300 bg-gradient-to-r from-indigo-100 to-purple-100 px-4 py-1.5 text-sm font-medium text-indigo-900 shadow-sm transition-all hover:shadow-md\"\r\n            >\r\n              <span>{lang.name}</span>\r\n              <Button\r\n                onClick={() => onDeleteLanguage(lang.id)}\r\n                variant=\"ghost\"\r\n                size=\"xs\"\r\n                className=\"h-5 w-5 rounded-full p-0.5 opacity-0 hover:bg-red-100 group-hover:opacity-100\"\r\n                title=\"Remove language\"\r\n              >\r\n                <X size={14} className=\"text-red-600\" />\r\n              </Button>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Tool Proficiencies Section */}\r\n      <div className=\"border-t-2 border-indigo-200 pt-4\">\r\n        <div className=\"mb-3 flex items-center justify-between\">\r\n          <h3 className=\"flex items-center gap-2 text-lg font-semibold text-indigo-900\">\r\n            <Wrench size={18} className=\"text-indigo-600\" />\r\n            Tool Proficiencies\r\n          </h3>\r\n          {!isAddingTool && (\r\n            <Button\r\n              onClick={() => setIsAddingTool(true)}\r\n              variant=\"primary\"\r\n              size=\"xs\"\r\n              leftIcon={<Plus size={16} />}\r\n              className=\"bg-indigo-600 hover:bg-indigo-700\"\r\n              title=\"Add tool proficiency\"\r\n            />\r\n          )}\r\n        </div>\r\n\r\n        {isAddingTool && (\r\n          <div className=\"mb-3 flex items-center gap-2\">\r\n            <Input\r\n              type=\"text\"\r\n              value={newToolName}\r\n              onChange={(e) => setNewToolName(e.target.value)}\r\n              onKeyDown={(e) => {\r\n                if (e.key === 'Enter') handleAddTool();\r\n                if (e.key === 'Escape') {\r\n                  setIsAddingTool(false);\r\n                  setNewToolName('');\r\n                }\r\n              }}\r\n              placeholder=\"e.g., Thieves' Tools\"\r\n              className=\"flex-1\"\r\n              autoFocus\r\n            />\r\n            <Button\r\n              onClick={handleAddTool}\r\n              variant=\"primary\"\r\n              size=\"sm\"\r\n              className=\"bg-indigo-600 hover:bg-indigo-700\"\r\n            >\r\n              Add\r\n            </Button>\r\n            <Button\r\n              onClick={() => {\r\n                setIsAddingTool(false);\r\n                setNewToolName('');\r\n              }}\r\n              variant=\"ghost\"\r\n              size=\"sm\"\r\n              className=\"bg-gray-300 hover:bg-gray-400\"\r\n            >\r\n              Cancel\r\n            </Button>\r\n          </div>\r\n        )}\r\n\r\n        <div className=\"space-y-2\">\r\n          {toolProficiencies.length === 0 && !isAddingTool && (\r\n            <p className=\"text-sm italic text-indigo-400\">No tool proficiencies added yet</p>\r\n          )}\r\n          {toolProficiencies.map((tool) => (\r\n            <div\r\n              key={tool.id}\r\n              className=\"group flex items-center justify-between rounded-lg border-2 border-indigo-200 bg-white p-3 shadow-sm transition-all hover:shadow-md\"\r\n            >\r\n              <div className=\"flex items-center gap-3\">\r\n                <span className=\"text-sm font-semibold text-gray-800\">{tool.name}</span>\r\n                <Button\r\n                  onClick={() => cycleProficiencyLevel(tool)}\r\n                  variant=\"ghost\"\r\n                  size=\"xs\"\r\n                  className={`cursor-pointer rounded-full border-2 px-3 py-1 text-xs font-bold transition-all hover:scale-105 hover:shadow-md ${getProficiencyColor(tool.proficiencyLevel)}`}\r\n                  title=\"Click to cycle proficiency level\"\r\n                >\r\n                  {tool.proficiencyLevel === 'expertise' && 'â­ Expert'}\r\n                  {tool.proficiencyLevel === 'proficient' && 'âœ“ Proficient'}\r\n                  {tool.proficiencyLevel === 'none' && 'â—‹ None'}\r\n                  {tool.proficiencyLevel !== 'none' && (\r\n                    <span className=\"ml-1.5 font-mono\">{getProficiencyModifier(tool.proficiencyLevel)}</span>\r\n                  )}\r\n                </Button>\r\n              </div>\r\n              <Button\r\n                onClick={() => onDeleteToolProficiency(tool.id)}\r\n                variant=\"ghost\"\r\n                size=\"xs\"\r\n                className=\"rounded-full p-1.5 opacity-0 hover:bg-red-100 group-hover:opacity-100\"\r\n                title=\"Remove tool\"\r\n              >\r\n                <X size={16} className=\"text-red-600\" />\r\n              </Button>\r\n            </div>\r\n          ))}\r\n        </div>\r\n\r\n        {toolProficiencies.length > 0 && (\r\n          <div className=\"mt-3 rounded-lg border-2 border-indigo-300 bg-indigo-100 p-3 text-xs text-indigo-800 shadow-sm\">\r\n            <p className=\"font-semibold\">ðŸ’¡ Tip: Click on the proficiency badge to cycle levels</p>\r\n            <p className=\"mt-1\">âœ“ Proficient â†’ â­ Expert â†’ â—‹ None â†’ âœ“ Proficient...</p>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 8089, "column": 0}, "map": {"version":3,"sources":["file:///home/irakli/Projects/RollKeeper/apps/web/src/components/ui/character/ExtendedFeatures/UnifiedFeatureModal.tsx"],"sourcesContent":["/**\r\n * UnifiedFeatureModal Component\r\n * Handles both adding and editing features with WYSIWYG editor and autocomplete\r\n */\r\n\r\n'use client';\r\n\r\nimport React, { useState, useEffect, useMemo } from 'react';\r\nimport {\r\n  ExtendedFeature,\r\n  FeatureSourceType,\r\n  FEATURE_SOURCE_LABELS,\r\n  createDefaultExtendedFeature,\r\n  CharacterState,\r\n} from '@/types/character';\r\nimport { calculateTraitMaxUses } from '@/utils/calculations';\r\nimport { FeatureAutocompleteItem, FeatureSourceFilter } from '@/types/features';\r\nimport {\r\n  convertBackgroundFeatureToExtendedFeature,\r\n  convertFeatToExtendedFeature,\r\n  convertClassFeatureToExtendedFeature,\r\n  partialFeatureToFormData,\r\n  FeatureFormData,\r\n} from '@/utils/featureConversion';\r\nimport { useFeatureSourcesData } from '@/hooks/useFeatureSourcesData';\r\nimport { FeatureAutocomplete } from '@/components/ui/forms/FeatureAutocomplete';\r\nimport RichTextEditor from '@/components/ui/forms/RichTextEditor';\r\nimport { Input } from '@/components/ui/forms/input';\r\nimport { SelectField, SelectItem } from '@/components/ui/forms/select';\r\nimport { Modal } from '@/components/ui/feedback';\r\nimport {\r\n  Plus,\r\n  Save,\r\n  Trash2,\r\n  Zap,\r\n  Clock,\r\n  Settings,\r\n  AlertTriangle,\r\n  Edit3,\r\n  Filter,\r\n} from 'lucide-react';\r\n\r\ninterface UnifiedFeatureModalProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  onSave: (\r\n    feature: Omit<ExtendedFeature, 'id' | 'createdAt' | 'updatedAt'>\r\n  ) => void;\r\n  onDelete?: () => void;\r\n  onUse?: () => void;\r\n  existingFeatures: ExtendedFeature[];\r\n  feature?: ExtendedFeature; // If provided, opens in edit mode\r\n  character: CharacterState;\r\n  readonly?: boolean;\r\n}\r\n\r\nexport default function UnifiedFeatureModal({\r\n  isOpen,\r\n  onClose,\r\n  onSave,\r\n  onDelete,\r\n  onUse,\r\n  existingFeatures,\r\n  feature: existingFeature,\r\n  character,\r\n  readonly = false,\r\n}: UnifiedFeatureModalProps) {\r\n  const isEditMode = !!existingFeature;\r\n  const [mode, setMode] = useState<'view' | 'edit'>(\r\n    isEditMode && !readonly ? 'view' : 'edit'\r\n  );\r\n  const [showDeleteConfirm, setShowDeleteConfirm] = useState(false);\r\n\r\n  // Load feature sources data\r\n  const {\r\n    allFeatures,\r\n    loading: featuresLoading,\r\n    filterBySourceType,\r\n    filterByClass,\r\n    filterBySubclass,\r\n  } = useFeatureSourcesData(character);\r\n\r\n  // Form state\r\n  const [formData, setFormData] = useState<FeatureFormData>(() =>\r\n    existingFeature\r\n      ? partialFeatureToFormData(existingFeature)\r\n      : partialFeatureToFormData(createDefaultExtendedFeature())\r\n  );\r\n\r\n  // Filter states for advanced search\r\n  const [sourceFilter, setSourceFilter] = useState<FeatureSourceFilter>('all');\r\n  const [classFilter, setClassFilter] = useState<string>('all');\r\n  const [subclassFilter, setSubclassFilter] = useState<string>('all');\r\n\r\n  // Get filtered features based on dropdowns\r\n  const filteredFeatures = useMemo(() => {\r\n    let features = allFeatures;\r\n\r\n    // Apply source type filter\r\n    if (sourceFilter !== 'all') {\r\n      features = filterBySourceType(sourceFilter);\r\n    }\r\n\r\n    // Apply class filter\r\n    if (sourceFilter === 'class' && classFilter && classFilter !== 'all') {\r\n      features = filterByClass(classFilter);\r\n    }\r\n\r\n    // Apply subclass filter\r\n    if (sourceFilter === 'subclass' && classFilter && classFilter !== 'all') {\r\n      features = filterBySubclass(\r\n        classFilter,\r\n        subclassFilter !== 'all' ? subclassFilter : ''\r\n      );\r\n    }\r\n\r\n    return features;\r\n  }, [\r\n    allFeatures,\r\n    sourceFilter,\r\n    classFilter,\r\n    subclassFilter,\r\n    filterBySourceType,\r\n    filterByClass,\r\n    filterBySubclass,\r\n  ]);\r\n\r\n  // Get unique class names for dropdown\r\n  const availableClasses = useMemo(() => {\r\n    const classNames = new Set<string>();\r\n    allFeatures.forEach(f => {\r\n      if (f.metadata.className) {\r\n        classNames.add(f.metadata.className);\r\n      }\r\n    });\r\n    return Array.from(classNames).sort();\r\n  }, [allFeatures]);\r\n\r\n  // Get unique subclass names for selected class\r\n  const availableSubclasses = useMemo(() => {\r\n    if (!classFilter || classFilter === 'all') return [];\r\n    const subclassNames = new Set<string>();\r\n    allFeatures.forEach(f => {\r\n      if (\r\n        f.metadata.className?.toLowerCase() === classFilter.toLowerCase() &&\r\n        f.metadata.subclassShortName\r\n      ) {\r\n        subclassNames.add(f.metadata.subclassShortName);\r\n      }\r\n    });\r\n    return Array.from(subclassNames).sort();\r\n  }, [allFeatures, classFilter]);\r\n\r\n  // Reset form when modal opens/closes or feature changes\r\n  useEffect(() => {\r\n    if (isOpen) {\r\n      if (existingFeature) {\r\n        setFormData(partialFeatureToFormData(existingFeature));\r\n        setMode(readonly ? 'view' : 'view');\r\n      } else {\r\n        setFormData(partialFeatureToFormData(createDefaultExtendedFeature()));\r\n        setMode('edit');\r\n      }\r\n      setShowDeleteConfirm(false);\r\n      setSourceFilter('all');\r\n      setClassFilter('all');\r\n      setSubclassFilter('all');\r\n    }\r\n  }, [isOpen, existingFeature, readonly]);\r\n\r\n  // Handle autocomplete selection\r\n  const handleFeatureSelect = (selectedFeature: FeatureAutocompleteItem) => {\r\n    let partialFeature: Partial<ExtendedFeature>;\r\n\r\n    // Convert based on source type\r\n    if (\r\n      selectedFeature.sourceType === 'background' &&\r\n      selectedFeature.metadata.backgroundName\r\n    ) {\r\n      // It's a background feature - cast the metadata\r\n      partialFeature = convertBackgroundFeatureToExtendedFeature({\r\n        id: selectedFeature.id,\r\n        name: selectedFeature.name,\r\n        source: selectedFeature.source,\r\n        description: selectedFeature.description,\r\n        backgroundName: selectedFeature.metadata.backgroundName,\r\n        skills: selectedFeature.metadata.skills || [],\r\n        isSrd: false,\r\n      });\r\n    } else if (\r\n      selectedFeature.sourceType === 'feat' &&\r\n      selectedFeature.metadata.prerequisites\r\n    ) {\r\n      // It's a feat - cast the metadata\r\n      partialFeature = convertFeatToExtendedFeature({\r\n        id: selectedFeature.id,\r\n        name: selectedFeature.name,\r\n        source: selectedFeature.source,\r\n        description: selectedFeature.description,\r\n        prerequisites: selectedFeature.metadata.prerequisites,\r\n        abilityIncreases: selectedFeature.metadata.abilityIncreases || '',\r\n        repeatable: selectedFeature.metadata.repeatable || false,\r\n        grantsSpells: false,\r\n        isSrd: false,\r\n        tags: selectedFeature.tags,\r\n      });\r\n    } else {\r\n      // Class or subclass feature - cast the metadata\r\n      partialFeature = convertClassFeatureToExtendedFeature({\r\n        name: selectedFeature.name,\r\n        level: selectedFeature.metadata.level || 1,\r\n        className: selectedFeature.metadata.className || '',\r\n        source: selectedFeature.source,\r\n        isSubclassFeature: selectedFeature.metadata.isSubclassFeature || false,\r\n        subclassShortName: selectedFeature.metadata.subclassShortName,\r\n        entries: [selectedFeature.description],\r\n        original: selectedFeature.name, // Required by ClassFeature interface\r\n      });\r\n    }\r\n\r\n    // Update form with converted data\r\n    setFormData(partialFeatureToFormData(partialFeature));\r\n  };\r\n\r\n  // Handle save\r\n  const handleSave = () => {\r\n    if (!formData.name.trim()) return;\r\n\r\n    // Calculate display order for new features\r\n    let displayOrder = 0;\r\n    if (!isEditMode) {\r\n      const featuresOfSameType = existingFeatures.filter(\r\n        f => f.sourceType === formData.sourceType\r\n      );\r\n      const maxOrder =\r\n        featuresOfSameType.length > 0\r\n          ? Math.max(...featuresOfSameType.map(f => f.displayOrder))\r\n          : -1;\r\n      displayOrder = maxOrder + 1;\r\n    } else {\r\n      displayOrder = existingFeature.displayOrder;\r\n    }\r\n\r\n    onSave({\r\n      ...formData,\r\n      name: formData.name.trim(),\r\n      description: formData.description?.trim() || undefined,\r\n      sourceDetail: formData.sourceDetail?.trim() || undefined,\r\n      category: formData.category?.trim() || undefined,\r\n      displayOrder,\r\n      usedUses: existingFeature?.usedUses || 0, // Preserve existing or default to 0\r\n      proficiencyMultiplier: formData.scaleWithProficiency\r\n        ? formData.proficiencyMultiplier\r\n        : undefined,\r\n    });\r\n\r\n    onClose();\r\n  };\r\n\r\n  // Handle delete\r\n  const handleDelete = () => {\r\n    if (onDelete) {\r\n      onDelete();\r\n      onClose();\r\n    }\r\n  };\r\n\r\n  // Handle cancel\r\n  const handleCancel = () => {\r\n    if (isEditMode) {\r\n      setMode('view');\r\n      if (existingFeature) {\r\n        setFormData(partialFeatureToFormData(existingFeature));\r\n      }\r\n    } else {\r\n      onClose();\r\n    }\r\n  };\r\n\r\n  // Calculate usage info for view mode\r\n  const maxUses = existingFeature\r\n    ? calculateTraitMaxUses(existingFeature, character.level)\r\n    : 0;\r\n  const usesRemaining = existingFeature\r\n    ? maxUses - existingFeature.usedUses\r\n    : 0;\r\n  const isExhausted =\r\n    existingFeature && !existingFeature.isPassive && usesRemaining <= 0;\r\n  const hasUses = existingFeature && !existingFeature.isPassive && maxUses > 0;\r\n\r\n  return (\r\n    <Modal\r\n      isOpen={isOpen}\r\n      onClose={onClose}\r\n      title={\r\n        mode === 'view'\r\n          ? existingFeature?.name || 'Feature Details'\r\n          : isEditMode\r\n            ? 'Edit Feature'\r\n            : 'Add New Feature'\r\n      }\r\n      size=\"xl\"\r\n    >\r\n      <div className=\"space-y-6\">\r\n        {/* View Mode - Header with Actions */}\r\n        {isEditMode && mode === 'view' && (\r\n          <div className=\"flex items-center justify-between border-b border-gray-200 pb-4\">\r\n            <div className=\"flex items-center gap-3\">\r\n              <span className=\"rounded-lg bg-indigo-100 px-3 py-1.5 text-sm font-semibold text-indigo-800\">\r\n                {FEATURE_SOURCE_LABELS[existingFeature!.sourceType]}\r\n              </span>\r\n              {existingFeature!.sourceDetail && (\r\n                <span className=\"rounded bg-gray-100 px-2 py-1 text-sm font-medium text-gray-600\">\r\n                  {existingFeature!.sourceDetail}\r\n                </span>\r\n              )}\r\n            </div>\r\n\r\n            {!readonly && (\r\n              <div className=\"flex gap-3\">\r\n                {hasUses && !isExhausted && onUse && (\r\n                  <button\r\n                    onClick={onUse}\r\n                    className=\"flex items-center gap-2 rounded-lg bg-indigo-600 px-4 py-2 text-sm font-medium text-white shadow-sm transition-colors hover:bg-indigo-700\"\r\n                  >\r\n                    <Zap className=\"h-4 w-4\" />\r\n                    Use Feature\r\n                  </button>\r\n                )}\r\n                <button\r\n                  onClick={() => setMode('edit')}\r\n                  className=\"flex items-center gap-2 rounded-lg bg-blue-600 px-4 py-2 text-sm font-medium text-white shadow-sm transition-colors hover:bg-blue-700\"\r\n                >\r\n                  <Edit3 className=\"h-4 w-4\" />\r\n                  Edit\r\n                </button>\r\n                {onDelete && (\r\n                  <button\r\n                    onClick={() => setShowDeleteConfirm(true)}\r\n                    className=\"flex items-center gap-2 rounded-lg bg-red-600 px-4 py-2 text-sm font-medium text-white shadow-sm transition-colors hover:bg-red-700\"\r\n                  >\r\n                    <Trash2 className=\"h-4 w-4\" />\r\n                    Delete\r\n                  </button>\r\n                )}\r\n              </div>\r\n            )}\r\n          </div>\r\n        )}\r\n\r\n        {/* View Mode - Content */}\r\n        {isEditMode && mode === 'view' && existingFeature && (\r\n          <div className=\"space-y-6\">\r\n            {/* Usage Info */}\r\n            <div className=\"rounded-xl border border-blue-200 bg-gradient-to-br from-blue-50 to-indigo-50 p-6\">\r\n              <div className=\"flex items-center justify-between\">\r\n                <div>\r\n                  <h4 className=\"mb-2 text-lg font-semibold text-gray-900\">\r\n                    Usage Information\r\n                  </h4>\r\n                  {existingFeature.isPassive ? (\r\n                    <div className=\"flex items-center gap-2\">\r\n                      <div className=\"h-2 w-2 rounded-full bg-blue-500\"></div>\r\n                      <p className=\"text-sm font-medium text-blue-700\">\r\n                        Passive ability - always active\r\n                      </p>\r\n                    </div>\r\n                  ) : hasUses ? (\r\n                    <div className=\"flex items-center gap-2\">\r\n                      <div\r\n                        className={`h-2 w-2 rounded-full ${isExhausted ? 'bg-red-500' : usesRemaining <= 1 ? 'bg-orange-500' : 'bg-green-500'}`}\r\n                      ></div>\r\n                      <p className=\"text-sm font-medium text-gray-700\">\r\n                        <span\r\n                          className={`${isExhausted ? 'text-red-600' : usesRemaining <= 1 ? 'text-orange-600' : 'text-green-600'}`}\r\n                        >\r\n                          {usesRemaining}\r\n                        </span>{' '}\r\n                        of {maxUses} uses remaining\r\n                      </p>\r\n                    </div>\r\n                  ) : (\r\n                    <div className=\"flex items-center gap-2\">\r\n                      <div className=\"h-2 w-2 rounded-full bg-green-500\"></div>\r\n                      <p className=\"text-sm font-medium text-green-700\">\r\n                        Unlimited uses\r\n                      </p>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n                {hasUses && (\r\n                  <div className=\"flex items-center gap-2 rounded-lg border bg-white px-3 py-2 text-sm font-medium text-gray-600\">\r\n                    <Clock className=\"h-4 w-4\" />\r\n                    <span className=\"capitalize\">\r\n                      {existingFeature.restType} rest\r\n                    </span>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n\r\n            {/* Description */}\r\n            {existingFeature.description && (\r\n              <div className=\"rounded-lg border border-gray-200 bg-white p-6\">\r\n                <h4 className=\"mb-4 text-lg font-semibold text-gray-900\">\r\n                  Description\r\n                </h4>\r\n                <div\r\n                  className=\"prose prose-sm max-w-none leading-relaxed text-gray-700\"\r\n                  dangerouslySetInnerHTML={{\r\n                    __html: existingFeature.description,\r\n                  }}\r\n                />\r\n              </div>\r\n            )}\r\n\r\n            {/* Additional Info */}\r\n            {(existingFeature.scaleWithProficiency ||\r\n              existingFeature.category) && (\r\n              <div className=\"rounded-lg border border-gray-200 bg-gray-50 p-6\">\r\n                <h4 className=\"mb-4 text-lg font-semibold text-gray-900\">\r\n                  Additional Details\r\n                </h4>\r\n                <div className=\"grid grid-cols-1 gap-4 sm:grid-cols-2\">\r\n                  {existingFeature.scaleWithProficiency && (\r\n                    <div className=\"flex items-center gap-3 rounded-lg border bg-white p-3\">\r\n                      <div className=\"h-2 w-2 shrink-0 rounded-full bg-purple-500\"></div>\r\n                      <div>\r\n                        <span className=\"text-sm font-medium text-gray-700\">\r\n                          Scaling:\r\n                        </span>\r\n                        <span className=\"ml-2 text-sm text-gray-600\">\r\n                          Proficiency Ã—{' '}\r\n                          {existingFeature.proficiencyMultiplier || 1}\r\n                        </span>\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n                  {existingFeature.category && (\r\n                    <div className=\"flex items-center gap-3 rounded-lg border bg-white p-3\">\r\n                      <div className=\"h-2 w-2 shrink-0 rounded-full bg-green-500\"></div>\r\n                      <div>\r\n                        <span className=\"text-sm font-medium text-gray-700\">\r\n                          Category:\r\n                        </span>\r\n                        <span className=\"ml-2 text-sm text-gray-600\">\r\n                          {existingFeature.category}\r\n                        </span>\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            )}\r\n          </div>\r\n        )}\r\n\r\n        {/* Edit Mode - Autocomplete & Form */}\r\n        {mode === 'edit' && (\r\n          <div className=\"space-y-6\">\r\n            {/* Autocomplete Section - Only show for new features */}\r\n            {!isEditMode && (\r\n              <div className=\"rounded-lg border-2 border-indigo-200 bg-indigo-50 p-6\">\r\n                <h3 className=\"mb-4 flex items-center gap-2 text-lg font-semibold text-indigo-900\">\r\n                  <Filter className=\"h-5 w-5\" />\r\n                  Search Feature Database\r\n                </h3>\r\n\r\n                {/* Filter Dropdowns */}\r\n                <div className=\"mb-4 grid grid-cols-1 gap-3 sm:grid-cols-3\">\r\n                  <SelectField\r\n                    label=\"Source Type\"\r\n                    value={sourceFilter}\r\n                    onValueChange={value => {\r\n                      setSourceFilter(value as FeatureSourceFilter);\r\n                      setClassFilter('all');\r\n                      setSubclassFilter('all');\r\n                    }}\r\n                    triggerProps={{ size: 'sm' }}\r\n                  >\r\n                    <SelectItem value=\"all\">All Sources</SelectItem>\r\n                    <SelectItem value=\"class\">Class Features</SelectItem>\r\n                    <SelectItem value=\"subclass\">Subclass Features</SelectItem>\r\n                    <SelectItem value=\"background\">\r\n                      Background Features\r\n                    </SelectItem>\r\n                    <SelectItem value=\"feat\">Feats</SelectItem>\r\n                  </SelectField>\r\n\r\n                  {(sourceFilter === 'class' ||\r\n                    sourceFilter === 'subclass') && (\r\n                    <SelectField\r\n                      label=\"Class\"\r\n                      value={classFilter}\r\n                      onValueChange={value => {\r\n                        setClassFilter(value);\r\n                        setSubclassFilter('all');\r\n                      }}\r\n                      triggerProps={{ size: 'sm' }}\r\n                    >\r\n                      <SelectItem value=\"all\">All Classes</SelectItem>\r\n                      {availableClasses.map(className => (\r\n                        <SelectItem key={className} value={className}>\r\n                          {className}\r\n                        </SelectItem>\r\n                      ))}\r\n                    </SelectField>\r\n                  )}\r\n\r\n                  {sourceFilter === 'subclass' &&\r\n                    classFilter &&\r\n                    classFilter !== 'all' && (\r\n                      <SelectField\r\n                        label=\"Subclass\"\r\n                        value={subclassFilter}\r\n                        onValueChange={value => setSubclassFilter(value)}\r\n                        triggerProps={{ size: 'sm' }}\r\n                      >\r\n                        <SelectItem value=\"all\">All Subclasses</SelectItem>\r\n                        {availableSubclasses.map(subclass => (\r\n                          <SelectItem key={subclass} value={subclass}>\r\n                            {subclass}\r\n                          </SelectItem>\r\n                        ))}\r\n                      </SelectField>\r\n                    )}\r\n                </div>\r\n\r\n                {/* Autocomplete */}\r\n                <FeatureAutocomplete\r\n                  features={filteredFeatures}\r\n                  onSelect={handleFeatureSelect}\r\n                  loading={featuresLoading}\r\n                  sourceFilter={sourceFilter}\r\n                  placeholder=\"Type to search features, backgrounds, or feats...\"\r\n                />\r\n              </div>\r\n            )}\r\n\r\n            {/* Form Fields */}\r\n            <div className=\"space-y-6\">\r\n              {/* Basic Information */}\r\n              <div className=\"rounded-lg border border-gray-200 bg-white p-6\">\r\n                <h4 className=\"mb-4 text-lg font-semibold text-gray-900\">\r\n                  Basic Information\r\n                </h4>\r\n\r\n                <div className=\"space-y-4\">\r\n                  <Input\r\n                    label=\"Feature Name\"\r\n                    value={formData.name}\r\n                    onChange={e =>\r\n                      setFormData({ ...formData, name: e.target.value })\r\n                    }\r\n                    placeholder=\"e.g., Action Surge, Darkvision, Lucky\"\r\n                    required\r\n                  />\r\n\r\n                  <div className=\"grid grid-cols-2 gap-4\">\r\n                    <SelectField\r\n                      label=\"Source Type\"\r\n                      value={formData.sourceType}\r\n                      onValueChange={value =>\r\n                        setFormData({\r\n                          ...formData,\r\n                          sourceType: value as FeatureSourceType,\r\n                        })\r\n                      }\r\n                      required\r\n                    >\r\n                      {Object.entries(FEATURE_SOURCE_LABELS).map(\r\n                        ([value, label]) => (\r\n                          <SelectItem key={value} value={value}>\r\n                            {label}\r\n                          </SelectItem>\r\n                        )\r\n                      )}\r\n                    </SelectField>\r\n\r\n                    <Input\r\n                      label=\"Source Detail\"\r\n                      value={formData.sourceDetail || ''}\r\n                      onChange={e =>\r\n                        setFormData({\r\n                          ...formData,\r\n                          sourceDetail: e.target.value,\r\n                        })\r\n                      }\r\n                      placeholder=\"e.g., Fighter Level 2, Hill Dwarf\"\r\n                    />\r\n                  </div>\r\n\r\n                  <Input\r\n                    label=\"Category (Optional)\"\r\n                    value={formData.category || ''}\r\n                    onChange={e =>\r\n                      setFormData({ ...formData, category: e.target.value })\r\n                    }\r\n                    placeholder=\"e.g., Combat, Utility, Social\"\r\n                  />\r\n\r\n                  <div>\r\n                    <label className=\"mb-1 block text-sm font-medium text-gray-700\">\r\n                      Description\r\n                    </label>\r\n                    <RichTextEditor\r\n                      content={formData.description}\r\n                      onChange={content =>\r\n                        setFormData({ ...formData, description: content })\r\n                      }\r\n                      placeholder=\"Describe what this feature does, how it works, and any important details...\"\r\n                      minHeight=\"150px\"\r\n                    />\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Usage Configuration */}\r\n              <div className=\"rounded-lg border border-gray-200 p-4\">\r\n                <h4 className=\"mb-3 flex items-center gap-2 font-medium text-gray-900\">\r\n                  <Settings className=\"h-4 w-4\" />\r\n                  Usage Configuration\r\n                </h4>\r\n\r\n                <div className=\"space-y-4\">\r\n                  <label className=\"flex items-center gap-2\">\r\n                    <input\r\n                      type=\"checkbox\"\r\n                      checked={formData.isPassive || false}\r\n                      onChange={e =>\r\n                        setFormData({\r\n                          ...formData,\r\n                          isPassive: e.target.checked,\r\n                        })\r\n                      }\r\n                      className=\"rounded border-gray-300\"\r\n                    />\r\n                    <span className=\"text-sm text-gray-700\">\r\n                      Passive ability (always active, no usage tracking)\r\n                    </span>\r\n                  </label>\r\n\r\n                  {!formData.isPassive && (\r\n                    <div className=\"space-y-3 border-l-2 border-gray-200 pl-6\">\r\n                      <div className=\"grid grid-cols-2 gap-4\">\r\n                        <Input\r\n                          label=\"Maximum Uses\"\r\n                          type=\"number\"\r\n                          min=\"0\"\r\n                          value={formData.maxUses.toString()}\r\n                          onChange={e =>\r\n                            setFormData({\r\n                              ...formData,\r\n                              maxUses: parseInt(e.target.value) || 0,\r\n                            })\r\n                          }\r\n                          helperText=\"Set to 0 for unlimited uses\"\r\n                        />\r\n\r\n                        <SelectField\r\n                          label=\"Recharges On\"\r\n                          value={formData.restType}\r\n                          onValueChange={value =>\r\n                            setFormData({\r\n                              ...formData,\r\n                              restType: value as 'short' | 'long',\r\n                            })\r\n                          }\r\n                        >\r\n                          <SelectItem value=\"short\">Short Rest</SelectItem>\r\n                          <SelectItem value=\"long\">Long Rest</SelectItem>\r\n                        </SelectField>\r\n                      </div>\r\n\r\n                      <div>\r\n                        <label className=\"mb-2 flex items-center gap-2\">\r\n                          <input\r\n                            type=\"checkbox\"\r\n                            checked={formData.scaleWithProficiency || false}\r\n                            onChange={e =>\r\n                              setFormData({\r\n                                ...formData,\r\n                                scaleWithProficiency: e.target.checked,\r\n                              })\r\n                            }\r\n                            className=\"rounded border-gray-300\"\r\n                          />\r\n                          <span className=\"text-sm text-gray-700\">\r\n                            Scale uses with proficiency bonus\r\n                          </span>\r\n                        </label>\r\n\r\n                        {formData.scaleWithProficiency && (\r\n                          <div className=\"pl-6\">\r\n                            <Input\r\n                              label=\"Proficiency Multiplier\"\r\n                              type=\"number\"\r\n                              min=\"0.5\"\r\n                              step=\"0.5\"\r\n                              value={\r\n                                formData.proficiencyMultiplier?.toString() ||\r\n                                '1'\r\n                              }\r\n                              onChange={e =>\r\n                                setFormData({\r\n                                  ...formData,\r\n                                  proficiencyMultiplier:\r\n                                    parseFloat(e.target.value) || 1,\r\n                                })\r\n                              }\r\n                              helperText=\"Maximum uses = base uses + (proficiency Ã— multiplier)\"\r\n                              wrapperClassName=\"w-48\"\r\n                            />\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Action Buttons */}\r\n            <div className=\"flex justify-end gap-3 border-t border-gray-200 pt-4\">\r\n              <button\r\n                type=\"button\"\r\n                onClick={handleCancel}\r\n                className=\"rounded-lg border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50\"\r\n              >\r\n                Cancel\r\n              </button>\r\n              <button\r\n                type=\"button\"\r\n                onClick={handleSave}\r\n                disabled={!formData.name.trim()}\r\n                className=\"flex items-center gap-2 rounded-lg bg-indigo-600 px-4 py-2 text-sm font-medium text-white hover:bg-indigo-700 disabled:cursor-not-allowed disabled:opacity-50\"\r\n              >\r\n                {isEditMode ? (\r\n                  <>\r\n                    <Save className=\"h-4 w-4\" />\r\n                    Save Changes\r\n                  </>\r\n                ) : (\r\n                  <>\r\n                    <Plus className=\"h-4 w-4\" />\r\n                    Add Feature\r\n                  </>\r\n                )}\r\n              </button>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Delete Confirmation */}\r\n        {showDeleteConfirm && (\r\n          <div className=\"rounded-lg border-2 border-red-200 bg-red-50 p-6\">\r\n            <div className=\"flex items-start gap-4\">\r\n              <div className=\"shrink-0\">\r\n                <AlertTriangle className=\"h-6 w-6 text-red-600\" />\r\n              </div>\r\n              <div className=\"flex-1\">\r\n                <h4 className=\"mb-2 text-lg font-semibold text-red-900\">\r\n                  Delete this feature?\r\n                </h4>\r\n                <p className=\"mb-4 text-sm text-red-700\">\r\n                  This action cannot be undone. The feature &quot;\r\n                  {existingFeature?.name}\r\n                  &quot; will be permanently removed.\r\n                </p>\r\n                <div className=\"flex gap-3\">\r\n                  <button\r\n                    onClick={handleDelete}\r\n                    className=\"flex items-center gap-2 rounded-lg bg-red-600 px-4 py-2 text-sm font-medium text-white shadow-sm transition-colors hover:bg-red-700\"\r\n                  >\r\n                    <Trash2 className=\"h-4 w-4\" />\r\n                    Delete Feature\r\n                  </button>\r\n                  <button\r\n                    onClick={() => setShowDeleteConfirm(false)}\r\n                    className=\"rounded-lg border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 shadow-sm transition-colors hover:bg-gray-50\"\r\n                  >\r\n                    Cancel\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </Modal>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 9363, "column": 0}, "map": {"version":3,"sources":["file:///home/irakli/Projects/RollKeeper/apps/web/src/components/ui/character/ExtendedFeatures/FeatureCard.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React, { useState } from 'react';\r\nimport { ExtendedFeature, CharacterState } from '@/types/character';\r\nimport { calculateTraitMaxUses } from '@/utils/calculations';\r\nimport {\r\n  Eye,\r\n  Edit3,\r\n  Trash2,\r\n  Zap,\r\n  Clock,\r\n  AlertCircle,\r\n  CheckCircle2,\r\n} from 'lucide-react';\r\nimport UnifiedFeatureModal from '@/components/ui/character/ExtendedFeatures/UnifiedFeatureModal';\r\nimport { Button } from '@/components/ui/forms';\r\n\r\ninterface FeatureCardProps {\r\n  feature: ExtendedFeature;\r\n  character: CharacterState;\r\n  onUpdate: (updates: Partial<ExtendedFeature>) => void;\r\n  onDelete: () => void;\r\n  onUse: () => void;\r\n  readonly?: boolean;\r\n  isDragging?: boolean;\r\n}\r\n\r\nexport default function FeatureCard({\r\n  feature,\r\n  character,\r\n  onUpdate,\r\n  onDelete,\r\n  onUse,\r\n  readonly = false,\r\n  isDragging = false,\r\n}: FeatureCardProps) {\r\n  const [isModalOpen, setIsModalOpen] = useState(false);\r\n\r\n  const maxUses = calculateTraitMaxUses(feature, character.level);\r\n  const usesRemaining = maxUses - feature.usedUses;\r\n  const isExhausted = !feature.isPassive && usesRemaining <= 0;\r\n  const hasUses = !feature.isPassive && maxUses > 0;\r\n\r\n  const handleViewClick = () => {\r\n    setIsModalOpen(true);\r\n  };\r\n\r\n  const handleEditClick = () => {\r\n    setIsModalOpen(true);\r\n  };\r\n\r\n  const getUsageColor = () => {\r\n    if (feature.isPassive) return 'text-blue-600';\r\n    if (isExhausted) return 'text-red-600';\r\n    if (usesRemaining <= 1) return 'text-orange-600';\r\n    return 'text-green-600';\r\n  };\r\n\r\n  const getUsageIcon = () => {\r\n    if (feature.isPassive) return <CheckCircle2 className=\"h-4 w-4\" />;\r\n    if (isExhausted) return <AlertCircle className=\"h-4 w-4\" />;\r\n    return <Zap className=\"h-4 w-4\" />;\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <div\r\n        className={`group flex h-full min-h-[140px] flex-col rounded-lg border-2 bg-white p-4 shadow-sm transition-all duration-200 hover:shadow-md ${\r\n          isDragging ? 'scale-95 opacity-50' : ''\r\n        } ${isExhausted ? 'border-red-200 bg-red-50' : 'border-gray-200 hover:border-indigo-300'}`}\r\n      >\r\n        {/* Feature Header */}\r\n        <div className=\"mb-3 flex items-start justify-between gap-2\">\r\n          <div className=\"min-w-0 flex-1\">\r\n            <h4 className=\"truncate text-sm leading-tight font-semibold text-gray-900\">\r\n              {feature.name}\r\n            </h4>\r\n            {feature.sourceDetail && (\r\n              <span className=\"mt-1 inline-block rounded bg-gray-100 px-2 py-0.5 text-xs text-gray-500\">\r\n                {feature.sourceDetail}\r\n              </span>\r\n            )}\r\n          </div>\r\n\r\n          {/* Action Buttons */}\r\n          <div className=\"flex flex-shrink-0 items-center gap-1 opacity-0 transition-opacity group-hover:opacity-100\">\r\n            {/* Use Button */}\r\n            {!readonly && hasUses && !isExhausted && (\r\n              <Button\r\n                onClick={onUse}\r\n                variant=\"ghost\"\r\n                size=\"xs\"\r\n                className=\"text-indigo-600 hover:bg-indigo-100\"\r\n                title=\"Use feature\"\r\n              >\r\n                <Zap className=\"h-5 w-5\" />\r\n              </Button>\r\n            )}\r\n\r\n            {/* View Button */}\r\n            <Button\r\n              onClick={handleViewClick}\r\n              variant=\"ghost\"\r\n              size=\"xs\"\r\n              className=\"text-gray-600 hover:bg-gray-100\"\r\n              title=\"View details\"\r\n            >\r\n              <Eye className=\"h-5 w-5\" />\r\n            </Button>\r\n\r\n            {/* Edit Button */}\r\n            {!readonly && (\r\n              <Button\r\n                onClick={handleEditClick}\r\n                variant=\"ghost\"\r\n                size=\"xs\"\r\n                className=\"text-blue-600 hover:bg-blue-100\"\r\n                title=\"Edit feature\"\r\n              >\r\n                <Edit3 className=\"h-5 w-5\" />\r\n              </Button>\r\n            )}\r\n\r\n            {/* Delete Button */}\r\n            {!readonly && (\r\n              <Button\r\n                onClick={onDelete}\r\n                variant=\"ghost\"\r\n                size=\"xs\"\r\n                className=\"text-red-600 hover:bg-red-100\"\r\n                title=\"Delete feature\"\r\n              >\r\n                <Trash2 className=\"h-5 w-5\" />\r\n              </Button>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Description */}\r\n        <div className=\"mb-3 flex-1\">\r\n          {feature.description && (\r\n            <div\r\n              className=\"line-clamp-3 text-xs text-gray-600\"\r\n              dangerouslySetInnerHTML={{ __html: feature.description }}\r\n            />\r\n          )}\r\n        </div>\r\n\r\n        {/* Usage Info */}\r\n        <div className=\"mt-auto\">\r\n          <div className=\"flex items-center justify-between text-xs\">\r\n            <div className={`flex items-center gap-1 ${getUsageColor()}`}>\r\n              {getUsageIcon()}\r\n              {feature.isPassive ? (\r\n                <span>Passive</span>\r\n              ) : hasUses ? (\r\n                <span>\r\n                  {usesRemaining}/{maxUses}\r\n                </span>\r\n              ) : (\r\n                <span>Unlimited</span>\r\n              )}\r\n            </div>\r\n\r\n            {hasUses && (\r\n              <div className=\"flex items-center gap-1 text-gray-500\">\r\n                <Clock className=\"h-3 w-3\" />\r\n                <span className=\"text-xs capitalize\">{feature.restType}</span>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Usage Progress Bar */}\r\n        {hasUses && maxUses > 1 && (\r\n          <div className=\"mt-2\">\r\n            <div className=\"h-1 w-full rounded-full bg-gray-200\">\r\n              <div\r\n                className={`h-1 rounded-full transition-all duration-300 ${\r\n                  isExhausted\r\n                    ? 'bg-red-500'\r\n                    : usesRemaining <= 1\r\n                      ? 'bg-orange-500'\r\n                      : 'bg-green-500'\r\n                }`}\r\n                style={{ width: `${(usesRemaining / maxUses) * 100}%` }}\r\n              />\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Feature Modal */}\r\n      <UnifiedFeatureModal\r\n        feature={feature}\r\n        isOpen={isModalOpen}\r\n        onClose={() => setIsModalOpen(false)}\r\n        onSave={onUpdate}\r\n        onDelete={onDelete}\r\n        onUse={onUse}\r\n        existingFeatures={[]}\r\n        character={character}\r\n        readonly={readonly}\r\n      />\r\n    </>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 9690, "column": 0}, "map": {"version":3,"sources":["file:///home/irakli/Projects/RollKeeper/apps/web/src/components/ui/character/ExtendedFeatures/FeatureCategorySection.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React from 'react';\r\nimport {\r\n  ExtendedFeature,\r\n  FeatureCategory,\r\n  CharacterState,\r\n} from '@/types/character';\r\nimport { ChevronDown, ChevronRight } from 'lucide-react';\r\nimport DragDropList from '@/components/ui/layout/DragDropList';\r\nimport FeatureCard from './FeatureCard';\r\n\r\ninterface FeatureCategorySectionProps {\r\n  category: FeatureCategory;\r\n  character: CharacterState;\r\n  isCollapsed: boolean;\r\n  onToggleCollapse: () => void;\r\n  onUpdateFeature: (\r\n    id: string,\r\n    updates: Partial<FeatureCategory['features'][0]>\r\n  ) => void;\r\n  onDeleteFeature: (id: string) => void;\r\n  onUseFeature: (id: string) => void;\r\n  onReorderFeatures: (sourceIndex: number, destinationIndex: number) => void;\r\n  readonly?: boolean;\r\n}\r\n\r\nexport default function FeatureCategorySection({\r\n  category,\r\n  character,\r\n  isCollapsed,\r\n  onToggleCollapse,\r\n  onUpdateFeature,\r\n  onDeleteFeature,\r\n  onUseFeature,\r\n  onReorderFeatures,\r\n  readonly = false,\r\n}: FeatureCategorySectionProps) {\r\n  const { features, label, description } = category;\r\n  const usedCount = features.filter(f => f.usedUses > 0).length;\r\n\r\n  if (features.length === 0) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <div className=\"rounded-lg border border-gray-200 bg-white shadow-sm\">\r\n      {/* Category Header */}\r\n      <button\r\n        onClick={onToggleCollapse}\r\n        className=\"flex w-full items-center justify-between p-4 text-left transition-colors hover:bg-gray-50\"\r\n      >\r\n        <div className=\"flex items-center gap-3\">\r\n          {isCollapsed ? (\r\n            <ChevronRight className=\"h-5 w-5 text-gray-400\" />\r\n          ) : (\r\n            <ChevronDown className=\"h-5 w-5 text-gray-400\" />\r\n          )}\r\n          <div>\r\n            <h3 className=\"font-semibold text-gray-900\">{label}</h3>\r\n            <p className=\"text-sm text-gray-500\">{description}</p>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"flex items-center gap-2\">\r\n          <span className=\"rounded-full bg-blue-100 px-2 py-1 text-xs font-medium text-blue-800\">\r\n            {features.length} feature{features.length !== 1 ? 's' : ''}\r\n          </span>\r\n          {usedCount > 0 && (\r\n            <span className=\"rounded-full bg-orange-100 px-2 py-1 text-xs font-medium text-orange-800\">\r\n              {usedCount} used\r\n            </span>\r\n          )}\r\n        </div>\r\n      </button>\r\n\r\n      {/* Category Content */}\r\n      {!isCollapsed && (\r\n        <div className=\"border-t border-gray-100 p-6\">\r\n          <DragDropList\r\n            items={features}\r\n            onReorder={onReorderFeatures}\r\n            keyExtractor={feature => feature.id}\r\n            disabled={readonly}\r\n            className=\"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3\"\r\n            showDragHandle={!readonly}\r\n            renderItem={(feature, index, isDragging) => (\r\n              <FeatureCard\r\n                feature={feature}\r\n                character={character}\r\n                onUpdate={(updates: Partial<ExtendedFeature>) =>\r\n                  onUpdateFeature(feature.id, updates)\r\n                }\r\n                onDelete={() => onDeleteFeature(feature.id)}\r\n                onUse={() => onUseFeature(feature.id)}\r\n                readonly={readonly}\r\n                isDragging={isDragging}\r\n              />\r\n            )}\r\n          />\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AAQA;AAAA;AACA;AACA;AAVA;;;;;AA2Be,SAAS,uBAAuB,EAC7C,QAAQ,EACR,SAAS,EACT,WAAW,EACX,gBAAgB,EAChB,eAAe,EACf,eAAe,EACf,YAAY,EACZ,iBAAiB,EACjB,WAAW,KAAK,EACY;IAC5B,MAAM,EAAE,QAAQ,EAAE,KAAK,EAAE,WAAW,EAAE,GAAG;IACzC,MAAM,YAAY,SAAS,MAAM,CAAC,CAAA,IAAK,EAAE,QAAQ,GAAG,GAAG,MAAM;IAE7D,IAAI,SAAS,MAAM,KAAK,GAAG;QACzB,OAAO;IACT;IAEA,qBACE,8OAAC;QAAI,WAAU;;0BAEb,8OAAC;gBACC,SAAS;gBACT,WAAU;;kCAEV,8OAAC;wBAAI,WAAU;;4BACZ,4BACC,8OAAC,sOAAY;gCAAC,WAAU;;;;;qDAExB,8OAAC,mOAAW;gCAAC,WAAU;;;;;;0CAEzB,8OAAC;;kDACC,8OAAC;wCAAG,WAAU;kDAA+B;;;;;;kDAC7C,8OAAC;wCAAE,WAAU;kDAAyB;;;;;;;;;;;;;;;;;;kCAI1C,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;gCAAK,WAAU;;oCACb,SAAS,MAAM;oCAAC;oCAAS,SAAS,MAAM,KAAK,IAAI,MAAM;;;;;;;4BAEzD,YAAY,mBACX,8OAAC;gCAAK,WAAU;;oCACb;oCAAU;;;;;;;;;;;;;;;;;;;YAOlB,CAAC,6BACA,8OAAC;gBAAI,WAAU;0BACb,cAAA,8OAAC,4KAAY;oBACX,OAAO;oBACP,WAAW;oBACX,cAAc,CAAA,UAAW,QAAQ,EAAE;oBACnC,UAAU;oBACV,WAAU;oBACV,gBAAgB,CAAC;oBACjB,YAAY,CAAC,SAAS,OAAO,2BAC3B,8OAAC,kMAAW;4BACV,SAAS;4BACT,WAAW;4BACX,UAAU,CAAC,UACT,gBAAgB,QAAQ,EAAE,EAAE;4BAE9B,UAAU,IAAM,gBAAgB,QAAQ,EAAE;4BAC1C,OAAO,IAAM,aAAa,QAAQ,EAAE;4BACpC,UAAU;4BACV,YAAY;;;;;;;;;;;;;;;;;;;;;;AAQ5B","debugId":null}},
    {"offset": {"line": 9844, "column": 0}, "map": {"version":3,"sources":["file:///home/irakli/Projects/RollKeeper/apps/web/src/components/ui/character/ExtendedFeatures/ExtendedFeaturesSection.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React, { useState } from 'react';\r\nimport {\r\n  ExtendedFeature,\r\n  FeatureCategory,\r\n  groupFeaturesBySource,\r\n  CharacterState,\r\n} from '@/types/character';\r\nimport { ChevronDown, ChevronRight, Plus, Settings } from 'lucide-react';\r\nimport FeatureCategorySection from '@/components/ui/character/ExtendedFeatures/FeatureCategorySection';\r\nimport UnifiedFeatureModal from '@/components/ui/character/ExtendedFeatures/UnifiedFeatureModal';\r\nimport { Button } from '@/components/ui/forms';\r\n\r\ninterface ExtendedFeaturesSectionProps {\r\n  features: ExtendedFeature[];\r\n  character: CharacterState;\r\n  onAddFeature: (\r\n    feature: Omit<ExtendedFeature, 'id' | 'createdAt' | 'updatedAt'>\r\n  ) => void;\r\n  onUpdateFeature: (id: string, updates: Partial<ExtendedFeature>) => void;\r\n  onDeleteFeature: (id: string) => void;\r\n  onUseFeature: (id: string) => void;\r\n  onResetFeatures: (restType: 'short' | 'long') => void;\r\n  onReorderFeatures: (\r\n    sourceIndex: number,\r\n    destinationIndex: number,\r\n    sourceType?: string\r\n  ) => void;\r\n  readonly?: boolean;\r\n  className?: string;\r\n}\r\n\r\nexport default function ExtendedFeaturesSection({\r\n  features,\r\n  character,\r\n  onAddFeature,\r\n  onUpdateFeature,\r\n  onDeleteFeature,\r\n  onUseFeature,\r\n  onResetFeatures,\r\n  onReorderFeatures,\r\n  readonly = false,\r\n  className = '',\r\n}: ExtendedFeaturesSectionProps) {\r\n  const [isCollapsed, setIsCollapsed] = useState(false);\r\n  const [isAddModalOpen, setIsAddModalOpen] = useState(false);\r\n  const [collapsedCategories, setCollapsedCategories] = useState<Set<string>>(\r\n    new Set()\r\n  );\r\n\r\n  // Group features by source type\r\n  const categories: FeatureCategory[] = groupFeaturesBySource(features);\r\n  const totalFeatures = features.length;\r\n  const usedFeatures = features.filter(f => f.usedUses > 0).length;\r\n\r\n  const toggleCategoryCollapse = (sourceType: string) => {\r\n    const newCollapsed = new Set(collapsedCategories);\r\n    if (newCollapsed.has(sourceType)) {\r\n      newCollapsed.delete(sourceType);\r\n    } else {\r\n      newCollapsed.add(sourceType);\r\n    }\r\n    setCollapsedCategories(newCollapsed);\r\n  };\r\n\r\n  return (\r\n    <section\r\n      className={`rounded-xl border-2 border-indigo-200 bg-gradient-to-br from-indigo-50 to-purple-50 p-6 shadow-lg transition-all duration-300 ${className}`}\r\n    >\r\n      {/* Header */}\r\n      <div className=\"mb-4 flex items-center justify-between\">\r\n        <button\r\n          onClick={() => setIsCollapsed(!isCollapsed)}\r\n          className=\"flex items-center gap-2 text-xl font-bold text-indigo-900 transition-colors hover:text-indigo-700\"\r\n        >\r\n          {isCollapsed ? (\r\n            <ChevronRight className=\"h-6 w-6\" />\r\n          ) : (\r\n            <ChevronDown className=\"h-6 w-6\" />\r\n          )}\r\n          Character Features\r\n          {totalFeatures > 0 && (\r\n            <span className=\"rounded-full bg-indigo-200 px-2 py-1 text-sm font-medium text-indigo-800\">\r\n              {totalFeatures}\r\n            </span>\r\n          )}\r\n        </button>\r\n\r\n        <div className=\"flex items-center gap-2\">\r\n          {/* Usage summary */}\r\n          {totalFeatures > 0 && !isCollapsed && (\r\n            <div className=\"text-sm text-indigo-600\">\r\n              {usedFeatures > 0 && (\r\n                <span className=\"rounded bg-orange-100 px-2 py-1 text-orange-700\">\r\n                  {usedFeatures} used\r\n                </span>\r\n              )}\r\n            </div>\r\n          )}\r\n\r\n          {/* Action buttons */}\r\n          {!readonly && !isCollapsed && (\r\n            <div className=\"flex gap-2\">\r\n              <Button\r\n                onClick={() => setIsAddModalOpen(true)}\r\n                variant=\"primary\"\r\n                size=\"sm\"\r\n                leftIcon={<Plus className=\"h-4 w-4\" />}\r\n                className=\"bg-indigo-600 hover:bg-indigo-700\"\r\n                title=\"Add new feature\"\r\n              >\r\n                Add Feature\r\n              </Button>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Content */}\r\n      {!isCollapsed && (\r\n        <div className=\"space-y-4\">\r\n          {categories.length === 0 ? (\r\n            <div className=\"rounded-lg border-2 border-dashed border-gray-300 p-8 text-center\">\r\n              <div className=\"text-gray-500\">\r\n                <Settings className=\"mx-auto mb-4 h-12 w-12 opacity-50\" />\r\n                <p className=\"mb-2 text-lg font-medium\">No features yet</p>\r\n                <p className=\"text-sm\">\r\n                  Add class features, racial abilities, feats, and more to\r\n                  organize your character&apos;s capabilities.\r\n                </p>\r\n                {!readonly && (\r\n                  <Button\r\n                    onClick={() => setIsAddModalOpen(true)}\r\n                    variant=\"primary\"\r\n                    size=\"sm\"\r\n                    leftIcon={<Plus className=\"h-4 w-4\" />}\r\n                    className=\"mt-4 bg-indigo-600 hover:bg-indigo-700\"\r\n                  >\r\n                    Add Your First Feature\r\n                  </Button>\r\n                )}\r\n              </div>\r\n            </div>\r\n          ) : (\r\n            <div className=\"space-y-3\">\r\n              {categories.map(category => (\r\n                <FeatureCategorySection\r\n                  key={category.sourceType}\r\n                  category={category}\r\n                  character={character}\r\n                  isCollapsed={collapsedCategories.has(category.sourceType)}\r\n                  onToggleCollapse={() =>\r\n                    toggleCategoryCollapse(category.sourceType)\r\n                  }\r\n                  onUpdateFeature={onUpdateFeature}\r\n                  onDeleteFeature={onDeleteFeature}\r\n                  onUseFeature={onUseFeature}\r\n                  onReorderFeatures={(\r\n                    sourceIndex: number,\r\n                    destinationIndex: number\r\n                  ) =>\r\n                    onReorderFeatures(\r\n                      sourceIndex,\r\n                      destinationIndex,\r\n                      category.sourceType\r\n                    )\r\n                  }\r\n                  readonly={readonly}\r\n                />\r\n              ))}\r\n            </div>\r\n          )}\r\n\r\n          {/* Reset buttons */}\r\n          {!readonly && features.some(f => f.usedUses > 0) && (\r\n            <div className=\"mt-4 flex gap-2 border-t border-indigo-200 pt-4\">\r\n              <Button\r\n                onClick={() => onResetFeatures('short')}\r\n                variant=\"success\"\r\n                size=\"sm\"\r\n              >\r\n                Short Rest Reset\r\n              </Button>\r\n              <Button\r\n                onClick={() => onResetFeatures('long')}\r\n                variant=\"primary\"\r\n                size=\"sm\"\r\n                className=\"bg-blue-600 hover:bg-blue-700\"\r\n              >\r\n                Long Rest Reset\r\n              </Button>\r\n            </div>\r\n          )}\r\n        </div>\r\n      )}\r\n\r\n      {/* Add Feature Modal */}\r\n      <UnifiedFeatureModal\r\n        isOpen={isAddModalOpen}\r\n        onClose={() => setIsAddModalOpen(false)}\r\n        onSave={onAddFeature}\r\n        existingFeatures={features}\r\n        character={character}\r\n      />\r\n    </section>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 10120, "column": 0}, "map": {"version":3,"sources":["file:///home/irakli/Projects/RollKeeper/apps/web/src/components/ui/character/ExtendedFeatures/AddFeatureModal.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React, { useState } from 'react';\r\nimport { ExtendedFeature, FeatureSourceType, FEATURE_SOURCE_LABELS, createDefaultExtendedFeature } from '@/types/character';\r\nimport { Plus, Settings } from 'lucide-react';\r\nimport { Modal } from '@/components/ui/feedback';\r\n\r\ninterface AddFeatureModalProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  onAdd: (feature: Omit<ExtendedFeature, 'id' | 'createdAt' | 'updatedAt'>) => void;\r\n  existingFeatures: ExtendedFeature[];\r\n}\r\n\r\nexport default function AddFeatureModal({\r\n  isOpen,\r\n  onClose,\r\n  onAdd,\r\n  existingFeatures,\r\n}: AddFeatureModalProps) {\r\n  const [newFeature, setNewFeature] = useState(() => createDefaultExtendedFeature());\r\n\r\n  const handleSubmit = (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    \r\n    if (!newFeature.name.trim()) return;\r\n\r\n    // Calculate display order for the new feature\r\n    const featuresOfSameType = existingFeatures.filter(f => f.sourceType === newFeature.sourceType);\r\n    const maxOrder = featuresOfSameType.length > 0 \r\n      ? Math.max(...featuresOfSameType.map(f => f.displayOrder))\r\n      : -1;\r\n\r\n    onAdd({\r\n      ...newFeature,\r\n      name: newFeature.name.trim(),\r\n      description: newFeature.description?.trim() || undefined,\r\n      sourceDetail: newFeature.sourceDetail?.trim() || undefined,\r\n      category: newFeature.category?.trim() || undefined,\r\n      displayOrder: maxOrder + 1,\r\n      proficiencyMultiplier: newFeature.scaleWithProficiency ? newFeature.proficiencyMultiplier : undefined,\r\n    });\r\n\r\n    // Reset form\r\n    setNewFeature(createDefaultExtendedFeature());\r\n    onClose();\r\n  };\r\n\r\n  const handleCancel = () => {\r\n    setNewFeature(createDefaultExtendedFeature());\r\n    onClose();\r\n  };\r\n\r\n  return (\r\n    <Modal\r\n      isOpen={isOpen}\r\n      onClose={handleCancel}\r\n      title=\"Add New Feature\"\r\n      size=\"lg\"\r\n    >\r\n      <form onSubmit={handleSubmit} className=\"space-y-6\">\r\n        {/* Basic Information */}\r\n        <div className=\"space-y-4\">\r\n          <div>\r\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n              Feature Name *\r\n            </label>\r\n            <input\r\n              type=\"text\"\r\n              value={newFeature.name}\r\n              onChange={(e) => setNewFeature({ ...newFeature, name: e.target.value })}\r\n              className=\"w-full rounded-lg border border-gray-300 px-3 py-2 focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500\"\r\n              placeholder=\"e.g., Action Surge, Darkvision, Lucky\"\r\n              required\r\n              autoFocus\r\n            />\r\n          </div>\r\n\r\n          <div className=\"grid grid-cols-2 gap-4\">\r\n            <div>\r\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                Source Type *\r\n              </label>\r\n              <select\r\n                value={newFeature.sourceType}\r\n                onChange={(e) => setNewFeature({ ...newFeature, sourceType: e.target.value as FeatureSourceType })}\r\n                className=\"w-full rounded-lg border border-gray-300 px-3 py-2 focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500\"\r\n                required\r\n              >\r\n                {Object.entries(FEATURE_SOURCE_LABELS).map(([value, label]) => (\r\n                  <option key={value} value={value}>\r\n                    {label}\r\n                  </option>\r\n                ))}\r\n              </select>\r\n            </div>\r\n\r\n            <div>\r\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                Source Detail\r\n              </label>\r\n              <input\r\n                type=\"text\"\r\n                value={newFeature.sourceDetail || ''}\r\n                onChange={(e) => setNewFeature({ ...newFeature, sourceDetail: e.target.value })}\r\n                className=\"w-full rounded-lg border border-gray-300 px-3 py-2 focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500\"\r\n                placeholder=\"e.g., Fighter Level 2, Hill Dwarf, +1 Sword\"\r\n              />\r\n            </div>\r\n          </div>\r\n\r\n          <div>\r\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n              Category (Optional)\r\n            </label>\r\n            <input\r\n              type=\"text\"\r\n              value={newFeature.category || ''}\r\n              onChange={(e) => setNewFeature({ ...newFeature, category: e.target.value })}\r\n              className=\"w-full rounded-lg border border-gray-300 px-3 py-2 focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500\"\r\n              placeholder=\"e.g., Combat, Utility, Social\"\r\n            />\r\n          </div>\r\n\r\n          <div>\r\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n              Description\r\n            </label>\r\n            <textarea\r\n              value={newFeature.description || ''}\r\n              onChange={(e) => setNewFeature({ ...newFeature, description: e.target.value })}\r\n              rows={3}\r\n              className=\"w-full rounded-lg border border-gray-300 px-3 py-2 focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500\"\r\n              placeholder=\"Describe what this feature does, how it works, and any important details...\"\r\n            />\r\n          </div>\r\n        </div>\r\n\r\n        {/* Usage Configuration */}\r\n        <div className=\"rounded-lg border border-gray-200 p-4\">\r\n          <h4 className=\"font-medium text-gray-900 mb-3 flex items-center gap-2\">\r\n            <Settings className=\"h-4 w-4\" />\r\n            Usage Configuration\r\n          </h4>\r\n\r\n          <div className=\"space-y-4\">\r\n            <label className=\"flex items-center gap-2\">\r\n              <input\r\n                type=\"checkbox\"\r\n                checked={newFeature.isPassive || false}\r\n                onChange={(e) => setNewFeature({ ...newFeature, isPassive: e.target.checked })}\r\n                className=\"rounded border-gray-300\"\r\n              />\r\n              <span className=\"text-sm text-gray-700\">\r\n                Passive ability (always active, no usage tracking)\r\n              </span>\r\n            </label>\r\n\r\n            {!newFeature.isPassive && (\r\n              <div className=\"space-y-3 pl-6 border-l-2 border-gray-200\">\r\n                <div className=\"grid grid-cols-2 gap-4\">\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                      Maximum Uses\r\n                    </label>\r\n                    <input\r\n                      type=\"number\"\r\n                      min=\"0\"\r\n                      value={newFeature.maxUses}\r\n                      onChange={(e) => setNewFeature({ ...newFeature, maxUses: parseInt(e.target.value) || 0 })}\r\n                      className=\"w-full rounded-lg border border-gray-300 px-3 py-2 focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500\"\r\n                    />\r\n                    <p className=\"text-xs text-gray-500 mt-1\">\r\n                      Set to 0 for unlimited uses\r\n                    </p>\r\n                  </div>\r\n\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                      Recharges On\r\n                    </label>\r\n                    <select\r\n                      value={newFeature.restType}\r\n                      onChange={(e) => setNewFeature({ ...newFeature, restType: e.target.value as 'short' | 'long' })}\r\n                      className=\"w-full rounded-lg border border-gray-300 px-3 py-2 focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500\"\r\n                    >\r\n                      <option value=\"short\">Short Rest</option>\r\n                      <option value=\"long\">Long Rest</option>\r\n                    </select>\r\n                  </div>\r\n                </div>\r\n\r\n                <div>\r\n                  <label className=\"flex items-center gap-2 mb-2\">\r\n                    <input\r\n                      type=\"checkbox\"\r\n                      checked={newFeature.scaleWithProficiency || false}\r\n                      onChange={(e) => setNewFeature({ ...newFeature, scaleWithProficiency: e.target.checked })}\r\n                      className=\"rounded border-gray-300\"\r\n                    />\r\n                    <span className=\"text-sm text-gray-700\">\r\n                      Scale uses with proficiency bonus\r\n                    </span>\r\n                  </label>\r\n\r\n                  {newFeature.scaleWithProficiency && (\r\n                    <div className=\"pl-6\">\r\n                      <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                        Proficiency Multiplier\r\n                      </label>\r\n                      <input\r\n                        type=\"number\"\r\n                        min=\"0.5\"\r\n                        step=\"0.5\"\r\n                        value={newFeature.proficiencyMultiplier || 1}\r\n                        onChange={(e) => setNewFeature({ \r\n                          ...newFeature, \r\n                          proficiencyMultiplier: parseFloat(e.target.value) || 1 \r\n                        })}\r\n                        className=\"w-32 rounded-lg border border-gray-300 px-3 py-2 focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500\"\r\n                      />\r\n                      <p className=\"text-xs text-gray-500 mt-1\">\r\n                        Maximum uses = base uses + (proficiency Ã— multiplier)\r\n                      </p>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Action Buttons */}\r\n        <div className=\"flex justify-end gap-3 pt-4 border-t border-gray-200\">\r\n          <button\r\n            type=\"button\"\r\n            onClick={handleCancel}\r\n            className=\"rounded-lg border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50\"\r\n          >\r\n            Cancel\r\n          </button>\r\n          <button\r\n            type=\"submit\"\r\n            disabled={!newFeature.name.trim()}\r\n            className=\"flex items-center gap-2 rounded-lg bg-indigo-600 px-4 py-2 text-sm font-medium text-white hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n          >\r\n            <Plus className=\"h-4 w-4\" />\r\n            Add Feature\r\n          </button>\r\n        </div>\r\n      </form>\r\n    </Modal>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 10647, "column": 0}, "map": {"version":3,"sources":["file:///home/irakli/Projects/RollKeeper/apps/web/src/components/ui/character/ExtendedFeatures/index.ts"],"sourcesContent":["export { default as ExtendedFeaturesSection } from './ExtendedFeaturesSection';\r\nexport { default as FeatureCategorySection } from './FeatureCategorySection';\r\nexport { default as FeatureCard } from './FeatureCard';\r\nexport { default as FeatureModal } from './FeatureModal';\r\nexport { default as AddFeatureModal } from './AddFeatureModal';\r\n"],"names":[],"mappings":";AAAA;AACA;AACA;AACA;AACA","debugId":null}},
    {"offset": {"line": 10671, "column": 0}, "map": {"version":3,"sources":["file:///home/irakli/Projects/RollKeeper/apps/web/src/components/ui/character/EquipmentSection.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React, { useState, useEffect } from 'react';\r\nimport { ChevronDown, ChevronRight } from 'lucide-react';\r\nimport ErrorBoundary from '@/components/ui/feedback/ErrorBoundary';\r\nimport { WeaponInventory } from '@/components/WeaponInventory';\r\nimport ArmorDefenseManager from '@/components/ArmorDefenseManager';\r\nimport { Badge } from '@/components/ui/layout/badge';\r\nimport { CharacterState } from '@/types/character';\r\n\r\ninterface EquipmentSectionProps {\r\n  character: CharacterState;\r\n}\r\n\r\n// Simple collapsible component for subsections\r\ninterface CollapsibleSubsectionProps {\r\n  title: string;\r\n  icon: string;\r\n  children: React.ReactNode;\r\n  defaultExpanded?: boolean;\r\n  persistKey: string;\r\n  badge?: React.ReactNode;\r\n}\r\n\r\nconst CollapsibleSubsection: React.FC<CollapsibleSubsectionProps> = ({\r\n  title,\r\n  icon,\r\n  children,\r\n  defaultExpanded = true,\r\n  persistKey,\r\n  badge,\r\n}) => {\r\n  const [isExpanded, setIsExpanded] = useState(defaultExpanded);\r\n\r\n  useEffect(() => {\r\n    const savedState = localStorage.getItem(`equipment-subsection-${persistKey}`);\r\n    if (savedState !== null) {\r\n      setIsExpanded(JSON.parse(savedState));\r\n    }\r\n  }, [persistKey]);\r\n\r\n  const toggleExpanded = () => {\r\n    const newState = !isExpanded;\r\n    setIsExpanded(newState);\r\n    localStorage.setItem(`equipment-subsection-${persistKey}`, JSON.stringify(newState));\r\n  };\r\n\r\n  return (\r\n    <div className=\"rounded-lg border border-gray-200 bg-white shadow\">\r\n      <button\r\n        onClick={toggleExpanded}\r\n        className=\"flex w-full items-center justify-between p-4 text-left transition-colors hover:bg-gray-50\"\r\n        aria-expanded={isExpanded}\r\n      >\r\n        <div className=\"flex items-center gap-2\">\r\n          <span className=\"text-lg\">{icon}</span>\r\n          <h3 className=\"text-lg font-bold text-gray-800\">{title}</h3>\r\n        </div>\r\n        <div className=\"flex items-center gap-2\">\r\n          {badge}\r\n          {isExpanded ? <ChevronDown size={20} /> : <ChevronRight size={20} />}\r\n        </div>\r\n      </button>\r\n      \r\n      {isExpanded && (\r\n        <div className=\"border-t border-gray-200 p-6\">\r\n          {children}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default function EquipmentSection({\r\n  character,\r\n}: EquipmentSectionProps) {\r\n  const equippedArmor = character.armorItems.filter(armor => armor.isEquipped);\r\n  const attunedItems = character.magicItems.filter(item => item.isAttuned).length +\r\n    character.weapons.filter(weapon => weapon.isAttuned).length;\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Equipment & Magic Items - Collapsible */}\r\n      <CollapsibleSubsection\r\n        title=\"Equipment & Magic Items\"\r\n        icon=\"âš”ï¸\"\r\n        persistKey=\"equipment-magic-items\"\r\n        defaultExpanded={true}\r\n        badge={\r\n          <div className=\"flex items-center gap-2\">\r\n            {character.weapons.length > 0 && (\r\n              <Badge variant=\"primary\" size=\"sm\">\r\n                {character.weapons.length} weapons\r\n              </Badge>\r\n            )}\r\n            {character.magicItems.length > 0 && (\r\n              <Badge variant=\"info\" size=\"sm\">\r\n                {character.magicItems.length} items\r\n              </Badge>\r\n            )}\r\n            {attunedItems > 0 && (\r\n              <Badge variant=\"warning\" size=\"sm\">\r\n                {attunedItems} attuned\r\n              </Badge>\r\n            )}\r\n          </div>\r\n        }\r\n      >\r\n        <ErrorBoundary\r\n          fallback={\r\n            <div className=\"rounded-lg border border-red-200 bg-red-50 p-4\">\r\n              <p className=\"text-red-600\">Unable to load equipment inventory</p>\r\n            </div>\r\n          }\r\n        >\r\n          <WeaponInventory />\r\n        </ErrorBoundary>\r\n      </CollapsibleSubsection>\r\n\r\n      {/* Armor & Defense - Collapsible */}\r\n      <CollapsibleSubsection\r\n        title=\"Armor & Defense\"\r\n        icon=\"ðŸ›¡ï¸\"\r\n        persistKey=\"armor-defense\"\r\n        defaultExpanded={true}\r\n        badge={\r\n          <div className=\"flex items-center gap-2\">\r\n            {character.armorItems.length > 0 && (\r\n              <Badge variant=\"info\" size=\"sm\">\r\n                {character.armorItems.length} pieces\r\n              </Badge>\r\n            )}\r\n            {equippedArmor.length > 0 && (\r\n              <Badge variant=\"success\" size=\"sm\">\r\n                {equippedArmor.length} equipped\r\n              </Badge>\r\n            )}\r\n          </div>\r\n        }\r\n      >\r\n        <ErrorBoundary\r\n          fallback={\r\n            <div className=\"rounded-lg border border-red-200 bg-red-50 p-4\">\r\n              <p className=\"text-red-600\">Unable to load armor management</p>\r\n            </div>\r\n          }\r\n        >\r\n          <ArmorDefenseManager />\r\n        </ErrorBoundary>\r\n      </CollapsibleSubsection>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}